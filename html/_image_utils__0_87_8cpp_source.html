<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CortexRobot: /temp/des/CameraTest_nofreev_branch/BusinessLogic/ImageUtils_0.7.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CortexRobot
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_28e1bb8382970ac72e8ae3b23df4a891.html">temp</a></li><li class="navelem"><a class="el" href="dir_7ee3436e08fefa5a3e5de148816e60bf.html">des</a></li><li class="navelem"><a class="el" href="dir_9f521f3c0054d89524661d351ceeeed2.html">CameraTest_nofreev_branch</a></li><li class="navelem"><a class="el" href="dir_9b856990660bbcb64da04740743983d7.html">BusinessLogic</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">ImageUtils_0.7.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_image_utils__0_87_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*****************************************************************************</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">*   Face Recognition using Eigenfaces or Fisherfaces</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">******************************************************************************</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">*   by Shervin Emami, 5th Dec 2012</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">*   http://www.shervinemami.info/openCV.html</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">******************************************************************************</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">*   Ch8 of the book &quot;Mastering OpenCV with Practical Computer Vision Projects&quot;</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">*   Copyright Packt Publishing 2012.</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">*   http://www.packtpub.com/cool-projects-with-opencv/book</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">*****************************************************************************/</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> * ImageUtils</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> *      Handy utility functions for dealing with images in OpenCV (desktop or Android).</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> *      by Shervin Emami (shervin.emami@gmail.com), 27th May 2012.</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> *      The most recent version of this will always be available from &quot;http://shervinemami.info/openCV.html&quot;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#define USE_HIGHGUI        // Enable this to display graph windows using OpenCV&#39;s HighGUI. (Supports Windows, Linux &amp; Mac, but not iPhone).</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_image_utils_8h.html">ImageUtils.h</a>&quot;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacestd.html">std</a>;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">// Print the label and then some text info about the IplImage properties, to LOG() for easy debugging.</span></div><div class="line"><a name="l00029"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#a71e1a1379805788f090639ddc8bc046c">   29</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="_image_utils__0_87_8cpp.html#a71e1a1379805788f090639ddc8bc046c">printImageInfo</a>(<span class="keyword">const</span> IplImage *image, <span class="keyword">const</span> <span class="keywordtype">char</span> *label)</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;{</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keywordtype">string</span> s = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="keywordtype">char</span> buff[1024];</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="keywordflow">if</span> (label)</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        s = label + string(<span class="stringliteral">&quot;: &quot;</span>);</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keywordflow">if</span> (image) {</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        snprintf(buff, <span class="keyword">sizeof</span>(buff), <span class="stringliteral">&quot;[Image] = %dw%dh, %d channels of %dbit depth, widthStep=%d, origin=%d&quot;</span>, image-&gt;width, image-&gt;height, image-&gt;nChannels, image-&gt;depth, image-&gt;widthStep, image-&gt;origin);</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        s += buff;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        <span class="keywordflow">if</span> (image-&gt;roi)</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;            snprintf(buff, <span class="keyword">sizeof</span>(buff), <span class="stringliteral">&quot; ROI=[at %d,%d of size %dx%d, COI=%d].\n&quot;</span>, image-&gt;roi-&gt;xOffset, image-&gt;roi-&gt;yOffset, image-&gt;roi-&gt;width, image-&gt;roi-&gt;height, image-&gt;roi-&gt;coi);</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;            snprintf(buff, <span class="keyword">sizeof</span>(buff), <span class="stringliteral">&quot; ROI=&lt;null&gt;.\n&quot;</span>);</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        s += buff;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    }</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        s = <span class="stringliteral">&quot;[Image] = &lt;null&gt;\n&quot;</span>;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    }</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="comment">// LOG can be printf or similar.</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    LOG(s.c_str());</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;}</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">// Print the pixel values of the IplImage, to LOG() for easy debugging.</span></div><div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#a3c4f5e6e80ebcace08d9f2236d8f4104">   52</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="_image_utils__0_87_8cpp.html#a3c4f5e6e80ebcace08d9f2236d8f4104">printImagePixels</a>(<span class="keyword">const</span> IplImage *image, <span class="keyword">const</span> <span class="keywordtype">char</span> *label, <span class="keywordtype">int</span> maxElements )</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;{</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keywordtype">string</span> s;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keywordtype">char</span> buff[32];</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordflow">if</span> (label)</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        s = label + string(<span class="stringliteral">&quot;: &quot;</span>);</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        s = <span class="stringliteral">&quot;Image: &quot;</span>;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordflow">if</span> (image) {</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <span class="keywordflow">if</span> (maxElements == 0)</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;            maxElements = image-&gt;width * image-&gt;height;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        sprintf(buff, <span class="stringliteral">&quot;(%dw%dh):\n&quot;</span>, image-&gt;width, image-&gt;height);</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        s += string(buff);</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        LOG(s.c_str());</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <span class="keywordtype">int</span> totalElements = 0;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <span class="keywordtype">int</span> depth = image-&gt;depth &amp; 255;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> row=0; row &lt; image-&gt;height; row++) {</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;            <span class="keywordtype">string</span> s = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            <span class="keywordtype">int</span> element = 0;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            <span class="keywordflow">if</span> (image-&gt;nChannels &gt; 1 &amp;&amp; image-&gt;height &gt; 1) {</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                snprintf(buff, <span class="keyword">sizeof</span>(buff), <span class="stringliteral">&quot;row%d: &quot;</span>, row);</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            }</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> col=0; col &lt; image-&gt;width; col++) {</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                <span class="keywordflow">if</span> (image-&gt;nChannels &gt; 1)</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                    s += <span class="stringliteral">&quot;[&quot;</span>;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ch=0; ch &lt;= image-&gt;nChannels-1; ch++) {</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                    <span class="keywordflow">if</span> (ch &gt; 0 || (image-&gt;nChannels == 1 &amp;&amp; col != 0))    <span class="comment">// Add a separator, except for the first element of this pixel or row.</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                        s += <span class="stringliteral">&quot;,&quot;</span>;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                    <span class="comment">// Allow to print just part of the image.</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                    totalElements++;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                    <span class="keywordflow">if</span> (totalElements &gt; maxElements) {</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                        <span class="comment">// LOG can be printf or similar.</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                        LOG(<span class="stringliteral">&quot;%s ... &lt;just displaying the 1st %d entries from %d!&gt;&quot;</span>, s.c_str(), maxElements, image-&gt;width * image-&gt;height * image-&gt;nChannels);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                    }</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                    <span class="keywordflow">if</span> (depth == 8)         <span class="comment">// 8-bit UCHAR image.</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                        snprintf(buff, <span class="keyword">sizeof</span>(buff), <span class="stringliteral">&quot;%d&quot;</span>, image-&gt;imageData[(row * (image-&gt;widthStep)) + (col*image-&gt;nChannels) + ch]);</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (depth == 16)   <span class="comment">// 16-bit short image.</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                        snprintf(buff, <span class="keyword">sizeof</span>(buff), <span class="stringliteral">&quot;%d&quot;</span>, *(<span class="keywordtype">short</span>*)(uchar*)&amp;image-&gt;imageData[(row * image-&gt;widthStep) + ((col*image-&gt;nChannels) + ch) * <span class="keyword">sizeof</span>(<span class="keywordtype">short</span>)]);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (depth == 32)   <span class="comment">// 32-bit float image.</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                        snprintf(buff, <span class="keyword">sizeof</span>(buff), <span class="stringliteral">&quot;%.3f&quot;</span>, *(<span class="keywordtype">float</span>*)(uchar*)&amp;image-&gt;imageData[(row * image-&gt;widthStep) + ((col*image-&gt;nChannels) + ch) * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>)]);</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (depth == 64)   <span class="comment">// 64-bit double image.</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                        snprintf(buff, <span class="keyword">sizeof</span>(buff), <span class="stringliteral">&quot;%.4lf&quot;</span>, *(<span class="keywordtype">double</span>*)(uchar*)&amp;image-&gt;imageData[(row * image-&gt;widthStep) + ((col*image-&gt;nChannels) + ch) * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)]);</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                    s += buff;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">int</span> MAX_ELEMENTS_PER_LINE = 60;   <span class="comment">// Only print upto 30 numbers per LOG() statement, since Android can only handle about 250 characters per log line!</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                    <span class="keywordflow">if</span> (element &gt; MAX_ELEMENTS_PER_LINE) {</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                        <span class="comment">// LOG can be printf or similar.</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                        LOG(s.c_str());</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                        s = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                        element = 0;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                    }</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                    element++;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                }</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                <span class="keywordflow">if</span> (image-&gt;nChannels &gt; 1)</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                    s += <span class="stringliteral">&quot;] &quot;</span>;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            }</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            <span class="comment">// LOG can be printf or similar.</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            LOG(s.c_str());</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        }</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    }</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        LOG(<span class="stringliteral">&quot;[%s] = &lt;null&gt;!&quot;</span>, s.c_str());</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    }</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;}</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">// Return the number of bits in each channel of the given Mat. ie: 8, 16, 32 or 64.</span></div><div class="line"><a name="l00122"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#aa6617d2acf4c31e5049756f4465f2720">  122</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="_image_utils__0_87_8cpp.html#aa6617d2acf4c31e5049756f4465f2720">getBitDepth</a>(<span class="keyword">const</span> cv::Mat M)</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;{</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordflow">switch</span> (CV_MAT_DEPTH(M.type())) {</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <span class="keywordflow">case</span> CV_8U:</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <span class="keywordflow">case</span> CV_8S:</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            <span class="keywordflow">return</span> 8;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="keywordflow">case</span> CV_16U:</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <span class="keywordflow">case</span> CV_16S:</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            <span class="keywordflow">return</span> 16;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        <span class="keywordflow">case</span> CV_32S:</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="keywordflow">case</span> CV_32F:</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            <span class="keywordflow">return</span> 32;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="keywordflow">case</span> CV_64F:</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            <span class="keywordflow">return</span> 64;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    }</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;}</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">// Print the contents of a multi-channel array (using &quot;LOG()&quot;) for easy debugging.</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">// If &#39;maxElements&#39; is 0, it will print the whole array. If it is -1, it will not print the array at all.</span></div><div class="line"><a name="l00142"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#aa22edb30325622da19c52e7d2993cc8b">  142</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="_image_utils__0_87_8cpp.html#aa22edb30325622da19c52e7d2993cc8b">printArray2D</a>(<span class="keyword">const</span> uchar *data, <span class="keywordtype">int</span> cols, <span class="keywordtype">int</span> rows, <span class="keywordtype">int</span> channels, <span class="keywordtype">int</span> depth_type, <span class="keywordtype">int</span> step, <span class="keywordtype">int</span> maxElements)</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;{</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keywordtype">char</span> buff[32];</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordflow">if</span> (data != 0 &amp;&amp; cols &gt; 0 &amp;&amp; rows &gt; 0 &amp;&amp; channels &gt; 0 &amp;&amp; step &gt; 0) {</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="comment">// Show the actual data values</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keywordflow">if</span> (maxElements &gt;= 0) {</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            <span class="keywordflow">if</span> (maxElements == 0)</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                maxElements = rows * cols;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            <span class="keywordtype">int</span> totalElements = 0;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            <span class="comment">//int step = step;</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> row=0; row &lt; rows; row++) {</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                <span class="keywordtype">string</span> s = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                <span class="keywordtype">int</span> element = 0;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                <span class="keywordflow">if</span> (channels &gt; 1 &amp;&amp; rows &gt; 1) {</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                    snprintf(buff, <span class="keyword">sizeof</span>(buff), <span class="stringliteral">&quot;row%d: &quot;</span>, row);</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                }</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> col=0; col &lt; cols; col++) {</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                    <span class="keywordflow">if</span> (channels &gt; 1)</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                        s += <span class="stringliteral">&quot;[&quot;</span>;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ch=0; ch &lt;= channels-1; ch++) {</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                        <span class="keywordflow">if</span> (ch &gt; 0 || (channels == 1 &amp;&amp; col != 0))    <span class="comment">// Add a separator, except for the first element of this pixel or row.</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                            s += <span class="stringliteral">&quot;,&quot;</span>;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                        buff[0] = <span class="charliteral">&#39;?&#39;</span>;  <span class="comment">// Initialize the string to &quot;?&quot; if something goes wrong.</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                        buff[1] = 0;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                        <span class="comment">// Allow to print just part of the image.</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                        totalElements++;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                        <span class="keywordflow">if</span> (totalElements &gt; maxElements) {</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                            <span class="comment">// LOG can be printf or similar.</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                            LOG(<span class="stringliteral">&quot;%s ... &lt;just displaying the 1st %d entries from %d!&gt;&quot;</span>, s.c_str(), maxElements, rows * cols * channels);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                        }</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                        <span class="keywordflow">switch</span> (depth_type) {</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                        <span class="keywordflow">case</span> CV_8U:</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                        <span class="keywordflow">case</span> CV_8S:         <span class="comment">// 8-bit UCHAR Mat.</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                            snprintf(buff, <span class="keyword">sizeof</span>(buff), <span class="stringliteral">&quot;%d&quot;</span>, data[(row * step) + (col*channels) + ch]);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                        <span class="keywordflow">case</span> CV_16U:</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                        <span class="keywordflow">case</span> CV_16S:   <span class="comment">// 16-bit short Mat.</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                            snprintf(buff, <span class="keyword">sizeof</span>(buff), <span class="stringliteral">&quot;%d&quot;</span>, *(<span class="keywordtype">short</span>*)(uchar*)&amp;data[(row * step) + ((col*channels) + ch) * <span class="keyword">sizeof</span>(<span class="keywordtype">short</span>)]);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                        <span class="keywordflow">case</span> CV_32S:   <span class="comment">// 32-bit int Mat.</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                            snprintf(buff, <span class="keyword">sizeof</span>(buff), <span class="stringliteral">&quot;%d&quot;</span>, *(<span class="keywordtype">int</span>*)(uchar*)&amp;data[(row * step) + ((col*channels) + ch) * <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>)]);</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                        <span class="keywordflow">case</span> CV_32F:   <span class="comment">// 32-bit float Mat.</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                            snprintf(buff, <span class="keyword">sizeof</span>(buff), <span class="stringliteral">&quot;%.3f&quot;</span>, *(<span class="keywordtype">float</span>*)(uchar*)&amp;data[(row * step) + ((col*channels) + ch) * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>)]);</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                        <span class="keywordflow">case</span> CV_64F:   <span class="comment">// 64-bit double Mat.</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                            snprintf(buff, <span class="keyword">sizeof</span>(buff), <span class="stringliteral">&quot;%.3lg&quot;</span>, *(<span class="keywordtype">double</span>*)(uchar*)&amp;data[(row * step) + ((col*channels) + ch) * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>)]);</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                        <span class="keywordflow">default</span>:</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                            snprintf(buff, <span class="keyword">sizeof</span>(buff), <span class="stringliteral">&quot;UNKNOWN DEPTH OF %d!&quot;</span>, depth_type);</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                        }</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                        s += buff;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                        <span class="keyword">const</span> <span class="keywordtype">int</span> MAX_ELEMENTS_PER_LINE = 30;   <span class="comment">// Only print upto 30 numbers per LOG() statement, since Android can only handle about 250 characters per log line!</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                        <span class="keywordflow">if</span> (element &gt; MAX_ELEMENTS_PER_LINE) {</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                            <span class="comment">// LOG can be printf or similar.</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                            LOG(s.c_str());</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                            s = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                            element = 0;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                        }</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                        element++;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                    }</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                    <span class="keywordflow">if</span> (channels &gt; 1)</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                        s += <span class="stringliteral">&quot;] &quot;</span>;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                }</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                <span class="comment">// LOG can be printf or similar.</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                LOG(s.c_str());</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            }</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        }<span class="comment">//end if (maxElements&gt;=0)</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    }</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;}</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">// Print the label and then contents of a cv::Mat from the C++ interface (using &quot;LOG()&quot;) for easy debugging.</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">// If &#39;maxElements&#39; is 0, it will print the whole array. If it is -1, it will not print the array at all.</span></div><div class="line"><a name="l00222"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#a34c452c1bc1c48870e47bfac38b9dc71">  222</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="_image_utils__0_87_8cpp.html#a34c452c1bc1c48870e47bfac38b9dc71">printMat</a>(<span class="keyword">const</span> cv::Mat M, <span class="keyword">const</span> <span class="keywordtype">char</span> *label, <span class="keywordtype">int</span> maxElements)</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;{</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordtype">string</span> s;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keywordtype">char</span> buff[32];</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordflow">if</span> (label)</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        s = label + string(<span class="stringliteral">&quot;: &quot;</span>);</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        s = <span class="stringliteral">&quot;Mat: &quot;</span>;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="keywordflow">if</span> (!M.empty()) {</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <span class="keywordtype">int</span> channels = CV_MAT_CN(M.type());</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <span class="keywordtype">int</span> depth_bpp = <a class="code" href="_image_utils__0_87_8cpp.html#aa6617d2acf4c31e5049756f4465f2720">getBitDepth</a>(M);     <span class="comment">// eg: 8, 16, 32.</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <span class="keywordtype">int</span> depth_type = CV_MAT_DEPTH(M.type());    <span class="comment">// eg: CV_32S, CV_32F</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <span class="comment">// Show the dimensions &amp; data type</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        sprintf(buff, <span class="stringliteral">&quot;%dw%dh %dch %dbpp&quot;</span>, M.cols, M.rows, channels, depth_bpp);</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        s += string(buff);</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <span class="comment">// Show the data range for each channel</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        s += <span class="stringliteral">&quot;, range&quot;</span>;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ch=0; ch&lt;channels; ch++) {</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            cv::Mat arr = cv::Mat(M.rows, M.cols, depth_type);</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            <span class="comment">// Extract one channel at a time, to show it&#39;s range.</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            <span class="keywordtype">int</span> from_to[2];</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            from_to[0] = ch;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            from_to[1] = 0;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            cv::mixChannels( &amp;M, 1, &amp;arr, 1, from_to, 1 );</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            <span class="comment">// Show it&#39;s range.</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            <span class="keywordtype">double</span> minVal, maxVal;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            cv::minMaxLoc(arr, &amp;minVal, &amp;maxVal);</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            snprintf(buff, <span class="keyword">sizeof</span>(buff), <span class="stringliteral">&quot;[%lg,%lg]&quot;</span>, minVal, maxVal);</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            s += buff;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        }</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        LOG(s.c_str());</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="comment">// Show the actual data values</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <a class="code" href="_image_utils__0_87_8cpp.html#aa22edb30325622da19c52e7d2993cc8b">printArray2D</a>(M.data, M.cols, M.rows, channels, depth_type, M.step, maxElements);</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    }</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        LOG(<span class="stringliteral">&quot;%s empty Mat&quot;</span>, s.c_str());</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    }</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;}</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">// Print the label and info of a cv::Mat from the C++ interface (using &quot;LOG()&quot;) for easy debugging.</span></div><div class="line"><a name="l00265"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#ad114009fb82a047849db183b3dd18657">  265</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="_image_utils__0_87_8cpp.html#ad114009fb82a047849db183b3dd18657">printMatInfo</a>(<span class="keyword">const</span> cv::Mat M, <span class="keyword">const</span> <span class="keywordtype">char</span> *label)</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;{</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <a class="code" href="_image_utils__0_87_8cpp.html#a34c452c1bc1c48870e47bfac38b9dc71">printMat</a>(M, label, -1);</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;}</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">// Print the label and then contents of a cvMat from the C interface (using &quot;LOG()&quot;) for easy debugging.</span></div><div class="line"><a name="l00272"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#a59a2e877cb44c178fea345bb1f918e42">  272</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="_image_utils__0_87_8cpp.html#a59a2e877cb44c178fea345bb1f918e42">printMatrix</a>(<span class="keyword">const</span> CvMat *M, <span class="keyword">const</span> <span class="keywordtype">char</span> *label, <span class="keywordtype">int</span> maxElements)</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;{</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keywordtype">string</span> s;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keywordtype">char</span> buff[32];</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keywordflow">if</span> (label)</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        s = label + string(<span class="stringliteral">&quot;: &quot;</span>);</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        s = <span class="stringliteral">&quot;Matrix: &quot;</span>;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="keywordflow">if</span> (M) {</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <span class="keywordflow">if</span> (maxElements == 0)</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            maxElements = M-&gt;rows * M-&gt;cols;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        sprintf(buff, <span class="stringliteral">&quot;[%drows x %dcols]:\n&quot;</span>, M-&gt;rows, M-&gt;cols);</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        s += string(buff);</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        LOG(s.c_str());</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <span class="keywordtype">int</span> channels = CV_MAT_CN(M-&gt;type);</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <span class="keywordtype">int</span> depth = CV_MAT_DEPTH(M-&gt;type);</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <span class="keywordtype">int</span> totalElements = 0;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        uchar *data = (uchar*)M-&gt;data.ptr;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <span class="keywordtype">int</span> step = M-&gt;step;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        for (<span class="keywordtype">int</span> row=0; row &lt; M-&gt;rows; row++) {</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            <span class="keywordtype">string</span> s = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            <span class="keywordtype">int</span> element = 0;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;            <span class="keywordflow">if</span> (channels &gt; 1 &amp;&amp; M-&gt;rows &gt; 1) {</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                snprintf(buff, <span class="keyword">sizeof</span>(buff), <span class="stringliteral">&quot;row%d: &quot;</span>, row);</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            }</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> col=0; col &lt; M-&gt;cols; col++) {</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                <span class="keywordflow">if</span> (channels &gt; 1)</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                    s += <span class="stringliteral">&quot;[&quot;</span>;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ch=0; ch &lt;= channels-1; ch++) {</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                    <span class="keywordflow">if</span> (ch &gt; 0 || (channels == 1 &amp;&amp; col != 0))    <span class="comment">// Add a separator, except for the first element of this pixel or row.</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                        s += <span class="stringliteral">&quot;,&quot;</span>;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                    buff[0] = <span class="charliteral">&#39;?&#39;</span>;  <span class="comment">// Initialize the string to &quot;?&quot; if something goes wrong.</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                    buff[1] = 0;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                    <span class="comment">// Allow to print just part of the image.</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                    totalElements++;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                    <span class="keywordflow">if</span> (totalElements &gt; maxElements) {</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                        <span class="comment">// LOG can be printf or similar.</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                        LOG(<span class="stringliteral">&quot;%s ... &lt;just displaying the 1st %d entries from %d!&gt;&quot;</span>, s.c_str(), maxElements, M-&gt;rows * M-&gt;cols * channels);</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                    }</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                    <span class="keywordflow">switch</span> (depth) {</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                    <span class="keywordflow">case</span> CV_8U:</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                    <span class="keywordflow">case</span> CV_8S:         <span class="comment">// 8-bit UCHAR Mat.</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                        buff[0] = <span class="charliteral">&#39;C&#39;</span>;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                        <span class="comment">//snprintf(buff, sizeof(buff), &quot;%d&quot;, data[(row * step) + (col*channels) + ch]);</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                        ; <span class="comment">// UNTESTED!</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                    <span class="keywordflow">case</span> CV_16U:</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                    <span class="keywordflow">case</span> CV_16S:   <span class="comment">// 16-bit short Mat.</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                        buff[0] = <span class="charliteral">&#39;S&#39;</span>;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                        <span class="comment">//snprintf(buff, sizeof(buff), &quot;%d&quot;, *(short*)(uchar*)&amp;data[(row * step) + ((col*channels) + ch) * sizeof(short)]);</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                        ; <span class="comment">// UNTESTED!</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                    <span class="keywordflow">case</span> CV_32S:   <span class="comment">// 32-bit int Mat.</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                        buff[0] = <span class="charliteral">&#39;I&#39;</span>;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                        snprintf(buff, <span class="keyword">sizeof</span>(buff), <span class="stringliteral">&quot;%d&quot;</span>, *(<span class="keywordtype">int</span>*)(uchar*)&amp;data[(row * step) + ((col*channels) + ch) * <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>)]);</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                        ; <span class="comment">// UNTESTED!</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                    <span class="keywordflow">case</span> CV_32F:   <span class="comment">// 32-bit float Mat.</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                        snprintf(buff, <span class="keyword">sizeof</span>(buff), <span class="stringliteral">&quot;%.3f&quot;</span>, *(<span class="keywordtype">float</span>*)(uchar*)&amp;data[(row * step) + ((col*channels) + ch) * <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>)]);</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                    <span class="keywordflow">case</span> CV_64F:   <span class="comment">// 64-bit double Mat.</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                        buff[0] = <span class="charliteral">&#39;D&#39;</span>;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                        <span class="comment">//snprintf(buff, sizeof(buff), &quot;%.4lf&quot;, *(double*)(uchar*)&amp;data[(row * step) + ((col*channels) + ch) * sizeof(double)]);</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                        ; <span class="comment">// UNTESTED!</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                        snprintf(buff, <span class="keyword">sizeof</span>(buff), <span class="stringliteral">&quot;UNKNOWN DEPTH OF %d!&quot;</span>, depth);</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                    }</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                    s += buff;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">int</span> MAX_ELEMENTS_PER_LINE = 60;   <span class="comment">// Only print upto 30 numbers per LOG() statement, since Android can only handle about 250 characters per log line!</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                    <span class="keywordflow">if</span> (element &gt; MAX_ELEMENTS_PER_LINE) {</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                        <span class="comment">// LOG can be printf or similar.</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                        LOG(s.c_str());</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                        s = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                        element = 0;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                    }</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                    element++;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                }</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                <span class="keywordflow">if</span> (channels &gt; 1)</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                    s += <span class="stringliteral">&quot;] &quot;</span>;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            }</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            <span class="comment">// LOG can be printf or similar.</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;            LOG(s.c_str());</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        }</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    }</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        LOG(<span class="stringliteral">&quot;[%s] = &lt;null&gt;!&quot;</span>, s.c_str());</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    }</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;}</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">// Print the x &amp; y coords of the given point. If &#39;label&#39; is supplied, prints that first, and also prints a newline character on the end.</span></div><div class="line"><a name="l00369"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#a493f114bc3e141c7d2fe2bb0164b354c">  369</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="_image_utils__0_87_8cpp.html#a493f114bc3e141c7d2fe2bb0164b354c">printPoint32f</a>(<span class="keyword">const</span> CvPoint2D32f pt, <span class="keyword">const</span> <span class="keywordtype">char</span> *label)</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;{</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="keywordflow">if</span> (label)</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        cout &lt;&lt; label &lt;&lt; <span class="stringliteral">&quot;: &quot;</span>;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;(&quot;</span> &lt;&lt; pt.x &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; pt.y &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keywordflow">if</span> (label)</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        cout &lt;&lt; endl;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;}</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">// Print the start &amp; end coords of the given line. If &#39;label&#39; is supplied, prints that first, and also prints a newline character on the end.</span></div><div class="line"><a name="l00379"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#a63255cd7415678275c971abc40a7caea">  379</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="_image_utils__0_87_8cpp.html#a63255cd7415678275c971abc40a7caea">printLine</a>(<span class="keyword">const</span> CvPoint ptA, <span class="keyword">const</span> CvPoint ptB, <span class="keyword">const</span> <span class="keywordtype">char</span> *label)</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;{</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keywordflow">if</span> (label)</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        cout &lt;&lt; label &lt;&lt; <span class="stringliteral">&quot;: &quot;</span>;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;(&quot;</span> &lt;&lt; ptA.x &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; ptA.y &lt;&lt; <span class="stringliteral">&quot;)-(&quot;</span> &lt;&lt; ptB.x &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; ptB.y &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keywordflow">if</span> (label)</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        cout &lt;&lt; endl;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;}</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">// Just for debugging float images &amp; matrices.</span></div><div class="line"><a name="l00389"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#aa61845612ab6c1b95f56d909b02c2b49">  389</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="_image_utils__0_87_8cpp.html#aa61845612ab6c1b95f56d909b02c2b49">printDataRange</a>(<span class="keyword">const</span> CvArr *src, <span class="keyword">const</span> <span class="keywordtype">char</span> *msg)</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;{</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="keywordflow">if</span> (((IplImage*)src)-&gt;nChannels == 2) {  <span class="comment">// 2-ch (Complex) input</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <span class="keywordtype">double</span> min_val[2] = {0};</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        <span class="keywordtype">double</span> max_val[2] = {0};</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        IplImage * imgComplexSrcRe = cvCreateImage( cvGetSize(((IplImage*)src)), IPL_DEPTH_32F, 1 );</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        IplImage * imgComplexSrcIm = cvCreateImage( cvGetSize(((IplImage*)src)), IPL_DEPTH_32F, 1 );</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        cvSplit(src, imgComplexSrcRe, imgComplexSrcIm, NULL, NULL);</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        cvMinMaxLoc(imgComplexSrcRe, &amp;min_val[0], &amp;max_val[0], NULL, NULL, NULL);</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        cvMinMaxLoc(imgComplexSrcIm, &amp;min_val[1], &amp;max_val[1], NULL, NULL, NULL);</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        LOG(<span class="stringliteral">&quot;\t`` %s Range: Complex MIN = %lf %lfj, MAX = %lf %lfj&quot;</span>, msg, min_val[0], min_val[1], max_val[0], max_val[1]);</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        cvReleaseImage(&amp;imgComplexSrcRe);</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        cvReleaseImage(&amp;imgComplexSrcIm);</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    }</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (((IplImage*)src)-&gt;nChannels == 1) {  <span class="comment">// 1-ch (Real) input</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        <span class="keywordtype">double</span> min_val[1] = {0};</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        <span class="keywordtype">double</span> max_val[1] = {0};</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        cvMinMaxLoc(src, &amp;min_val[0], &amp;max_val[0], NULL, NULL, NULL);</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        LOG(<span class="stringliteral">&quot;\t`` %s Range: Real MIN = %lf, MAX = %lf&quot;</span>, msg, min_val[0], max_val[0]);</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    }</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        LOG(<span class="stringliteral">&quot;\t`` %s Range: UNKNOWN because nChannels == %d != 1 or 2&quot;</span>, msg, ((IplImage*)src)-&gt;nChannels);</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    }</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;}</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">// Graphing functions</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div><div class="line"><a name="l00417"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#abcc8c08c2c7c71b2269501cdef97bf1f">  417</a></span>&#160;<span class="keyword">const</span> CvScalar <a class="code" href="_image_utils__0_87_8cpp.html#abcc8c08c2c7c71b2269501cdef97bf1f">BLACK</a> = cvScalar(0,0,0,0);</div><div class="line"><a name="l00418"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#ac6421fa2581ccc249774c179d87dbda2">  418</a></span>&#160;<span class="keyword">const</span> CvScalar <a class="code" href="_image_utils__0_87_8cpp.html#ac6421fa2581ccc249774c179d87dbda2">WHITE</a> = cvScalar(255,255,255,0);</div><div class="line"><a name="l00419"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#aade8e3bc2d7d0b6356681953aa18da93">  419</a></span>&#160;<span class="keyword">const</span> CvScalar <a class="code" href="_image_utils__0_87_8cpp.html#aade8e3bc2d7d0b6356681953aa18da93">GREY</a> = cvScalar(150,150,150,0);</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;</div><div class="line"><a name="l00421"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#a01f97ecb4f7ab8bc04fb014ad8a28e1d">  421</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="_image_utils__0_87_8cpp.html#a01f97ecb4f7ab8bc04fb014ad8a28e1d">countGraph</a> = 0;    <span class="comment">// Used by &#39;getGraphColor()&#39;</span></div><div class="line"><a name="l00422"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#a56baadc60b4d228703cc4bf6fcb49bbc">  422</a></span>&#160;CvScalar <a class="code" href="_image_utils__0_87_8cpp.html#a56baadc60b4d228703cc4bf6fcb49bbc">customGraphColor</a>;</div><div class="line"><a name="l00423"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#a313404a90ed0a156db06389aab49094e">  423</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="_image_utils__0_87_8cpp.html#a313404a90ed0a156db06389aab49094e">usingCustomGraphColor</a> = 0;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">// Get a new color to draw graphs. Will use the latest custom color, or change between blue, green, red, dark-blue, dark-green and dark-red until a new image is created.</span></div><div class="line"><a name="l00426"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#a9e2b2766488b6a38d506d6c60abd71dd">  426</a></span>&#160;CvScalar <a class="code" href="_image_utils__0_87_8cpp.html#a9e2b2766488b6a38d506d6c60abd71dd">getGraphColor</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;{</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="_image_utils__0_87_8cpp.html#a313404a90ed0a156db06389aab49094e">usingCustomGraphColor</a>) {</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <a class="code" href="_image_utils__0_87_8cpp.html#a313404a90ed0a156db06389aab49094e">usingCustomGraphColor</a> = 0;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="_image_utils__0_87_8cpp.html#a56baadc60b4d228703cc4bf6fcb49bbc">customGraphColor</a>;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    }</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <a class="code" href="_image_utils__0_87_8cpp.html#a01f97ecb4f7ab8bc04fb014ad8a28e1d">countGraph</a>++;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="_image_utils__0_87_8cpp.html#a01f97ecb4f7ab8bc04fb014ad8a28e1d">countGraph</a>) {</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="keywordflow">case</span> 1:    <span class="keywordflow">return</span> cvScalar(255,60,60,0);    <span class="comment">// light-blue</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="keywordflow">case</span> 2:    <span class="keywordflow">return</span> cvScalar(60,255,60,0);    <span class="comment">// light-green</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="keywordflow">case</span> 3:    <span class="keywordflow">return</span> cvScalar(40,60,255,0);    <span class="comment">// light-red</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="keywordflow">case</span> 4:    <span class="keywordflow">return</span> cvScalar(210,210,0,0);    <span class="comment">// blue-green</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="keywordflow">case</span> 5:    <span class="keywordflow">return</span> cvScalar(0,210,180,0);    <span class="comment">// red-green</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="keywordflow">case</span> 6:    <span class="keywordflow">return</span> cvScalar(180,0,210,0);    <span class="comment">// red-blue</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="keywordflow">case</span> 7:    <span class="keywordflow">return</span> cvScalar(185,0,0,0);        <span class="comment">// dark-blue</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="keywordflow">case</span> 8:    <span class="keywordflow">return</span> cvScalar(0,185,0,0);        <span class="comment">// dark-green</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keywordflow">case</span> 9:    <span class="keywordflow">return</span> cvScalar(0,0,185,0);        <span class="comment">// dark-red</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        <a class="code" href="_image_utils__0_87_8cpp.html#a01f97ecb4f7ab8bc04fb014ad8a28e1d">countGraph</a> = 0;    <span class="comment">// start rotating through colors again.</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        <span class="keywordflow">return</span> cvScalar(200,200,200,0);    <span class="comment">// grey</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    }</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;}</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">// Call &#39;setGraphColor()&#39; to reset the colors that will be used for graphs.</span></div><div class="line"><a name="l00450"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#add3fc44702865288f65ad955b950989e">  450</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="_image_utils__0_87_8cpp.html#add3fc44702865288f65ad955b950989e">setGraphColor</a>(<span class="keywordtype">int</span> index)</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;{</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <a class="code" href="_image_utils__0_87_8cpp.html#a01f97ecb4f7ab8bc04fb014ad8a28e1d">countGraph</a> = index;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <a class="code" href="_image_utils__0_87_8cpp.html#a313404a90ed0a156db06389aab49094e">usingCustomGraphColor</a> = 0;    <span class="comment">// dont use a custom color.</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;}</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">// Specify the exact color that the next graph should be drawn as.</span></div><div class="line"><a name="l00456"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#a9d48f4622feacb441c11524bec0bf94f">  456</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="_image_utils__0_87_8cpp.html#a9d48f4622feacb441c11524bec0bf94f">setCustomGraphColor</a>(<span class="keywordtype">int</span> R, <span class="keywordtype">int</span> B, <span class="keywordtype">int</span> G)</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;{</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <a class="code" href="_image_utils__0_87_8cpp.html#a56baadc60b4d228703cc4bf6fcb49bbc">customGraphColor</a> = cvScalar(B, G, R, 0);</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <a class="code" href="_image_utils__0_87_8cpp.html#a313404a90ed0a156db06389aab49094e">usingCustomGraphColor</a> = 1;    <span class="comment">// show that it will be used.</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;}</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment">// Draw the graph of an array of floats into imageDst or a new image, between minV &amp; maxV if given.</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment">// Remember to free the newly created image if imageDst is not given.</span></div><div class="line"><a name="l00464"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#a379a9b2857f990b6781b5891bce4921e">  464</a></span>&#160;IplImage* <a class="code" href="_image_utils__0_87_8cpp.html#a379a9b2857f990b6781b5891bce4921e">drawFloatGraph</a>(<span class="keyword">const</span> <span class="keywordtype">float</span> *arraySrc, <span class="keywordtype">int</span> nArrayLength, IplImage *imageDst, <span class="keywordtype">float</span> minV, <span class="keywordtype">float</span> maxV, <span class="keywordtype">int</span> width, <span class="keywordtype">int</span> height, <span class="keywordtype">char</span> *graphLabel, <span class="keywordtype">bool</span> showScale)</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;{</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="keywordtype">int</span> w = width;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keywordtype">int</span> h = height;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="keywordtype">int</span> b = 10;        <span class="comment">// border around graph within the image</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="keywordflow">if</span> (w &lt;= 20)</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        w = nArrayLength + b*2;    <span class="comment">// width of the image</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="keywordflow">if</span> (h &lt;= 20)</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        h = 220;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="keywordtype">int</span> s = h - b*2;<span class="comment">// size of graph height</span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="keywordtype">float</span> xscale = 1.0;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keywordflow">if</span> (nArrayLength &gt; 1)</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        xscale = (w - b*2) / (<span class="keywordtype">float</span>)(nArrayLength-1);    <span class="comment">// horizontal scale</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    IplImage *imageGraph;    <span class="comment">// output image</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="comment">// Get the desired image to draw into.</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="keywordflow">if</span> (!imageDst) {</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        <span class="comment">// Create an RGB image for graphing the data</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        imageGraph = cvCreateImage(cvSize(w,h), 8, 3);</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        <span class="comment">// Clear the image</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        cvSet(imageGraph, <a class="code" href="_image_utils__0_87_8cpp.html#ac6421fa2581ccc249774c179d87dbda2">WHITE</a>);</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    }</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        <span class="comment">// Draw onto the given image.</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        imageGraph = imageDst;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    }</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keywordflow">if</span> (!imageGraph) {</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        cerr &lt;&lt; <span class="stringliteral">&quot;ERROR in drawFloatGraph(): Couldn&#39;t create image of &quot;</span> &lt;&lt; w &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; h &lt;&lt; endl;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        exit(1);</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    }</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    CvScalar colorGraph = <a class="code" href="_image_utils__0_87_8cpp.html#a9e2b2766488b6a38d506d6c60abd71dd">getGraphColor</a>();    <span class="comment">// use a different color each time.</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="comment">// If the user didnt supply min &amp; mav values, find them from the data, so we can draw it at full scale.</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="keywordflow">if</span> (fabs(minV) &lt; 0.0000001f &amp;&amp; fabs(maxV) &lt; 0.0000001f) {</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>=0; <a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>&lt;nArrayLength; <a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>++) {</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;            <span class="keywordtype">float</span> v = (float)arraySrc[<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>];</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;            <span class="keywordflow">if</span> (v &lt; minV)</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                minV = v;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;            <span class="keywordflow">if</span> (v &gt; maxV)</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                maxV = v;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        }</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    }</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="keywordtype">float</span> diffV = maxV - minV;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="keywordflow">if</span> (diffV == 0)</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        diffV = 0.00000001f;    <span class="comment">// Stop a divide-by-zero error</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="keywordtype">float</span> fscale = (float)s / diffV;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="comment">// Draw the horizontal &amp; vertical axis</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="keywordtype">int</span> y0 = cvRound(minV*fscale);</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    cvLine(imageGraph, cvPoint(b,h-(b-y0)), cvPoint(w-b, h-(b-y0)), <a class="code" href="_image_utils__0_87_8cpp.html#abcc8c08c2c7c71b2269501cdef97bf1f">BLACK</a>);</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    cvLine(imageGraph, cvPoint(b,h-(b)), cvPoint(b, h-(b+s)), <a class="code" href="_image_utils__0_87_8cpp.html#abcc8c08c2c7c71b2269501cdef97bf1f">BLACK</a>);</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="comment">// Write the scale of the y axis</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    CvFont font;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    cvInitFont(&amp;font,CV_FONT_HERSHEY_PLAIN,0.55,0.7, 0,1,CV_AA);    <span class="comment">// For OpenCV 1.1</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <span class="keywordflow">if</span> (showScale) {</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        <span class="comment">//cvInitFont(&amp;font,CV_FONT_HERSHEY_PLAIN,0.5,0.6, 0,1, CV_AA);    // For OpenCV 2.0</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        CvScalar clr = <a class="code" href="_image_utils__0_87_8cpp.html#aade8e3bc2d7d0b6356681953aa18da93">GREY</a>;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        <span class="keywordtype">char</span> text[16];</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        snprintf(text, <span class="keyword">sizeof</span>(text)-1, <span class="stringliteral">&quot;%.1f&quot;</span>, maxV);</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        cvPutText(imageGraph, text, cvPoint(1, b+4), &amp;font, clr);</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        <span class="comment">// Write the scale of the x axis</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        snprintf(text, <span class="keyword">sizeof</span>(text)-1, <span class="stringliteral">&quot;%d&quot;</span>, (nArrayLength-1) );</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        cvPutText(imageGraph, text, cvPoint(w-b+4-5*strlen(text), (h/2)+10), &amp;font, clr);</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    }</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="comment">// Draw the values</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    CvPoint ptPrev = cvPoint(b,h-(b-y0));    <span class="comment">// Start the lines at the 1st point.</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>=0; <a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>&lt;nArrayLength; <a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>++) {</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        <span class="keywordtype">int</span> y = cvRound((arraySrc[<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>] - minV) * fscale);    <span class="comment">// Get the values at a bigger scale</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="_p_d_8m.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a> = cvRound(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a> * xscale);</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        CvPoint ptNew = cvPoint(b+x, h-(b+y));</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        cvLine(imageGraph, ptPrev, ptNew, colorGraph, 1, CV_AA);    <span class="comment">// Draw a line from the previous point to the new point</span></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        ptPrev = ptNew;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    }</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="comment">// Write the graph label, if desired</span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="keywordflow">if</span> (graphLabel != NULL &amp;&amp; strlen(graphLabel) &gt; 0) {</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        <span class="comment">//cvInitFont(&amp;font,CV_FONT_HERSHEY_PLAIN, 0.5,0.7, 0,1,CV_AA);</span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        cvPutText(imageGraph, graphLabel, cvPoint(30, 10), &amp;font, cvScalar(0,0,0,0));    <span class="comment">// black text</span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    }</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="keywordflow">return</span> imageGraph;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;}</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment">// Draw the graph of an array of ints into imageDst or a new image, between minV &amp; maxV if given.</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">// Remember to free the newly created image if imageDst is not given.</span></div><div class="line"><a name="l00553"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#a72d9e00b861e3b95304d921d5b3cad23">  553</a></span>&#160;IplImage* <a class="code" href="_image_utils__0_87_8cpp.html#a72d9e00b861e3b95304d921d5b3cad23">drawIntGraph</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> *arraySrc, <span class="keywordtype">int</span> nArrayLength, IplImage *imageDst, <span class="keywordtype">int</span> minV, <span class="keywordtype">int</span> maxV, <span class="keywordtype">int</span> width, <span class="keywordtype">int</span> height, <span class="keywordtype">char</span> *graphLabel, <span class="keywordtype">bool</span> showScale)</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;{</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="keywordtype">int</span> w = width;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="keywordtype">int</span> h = height;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="keywordtype">int</span> b = 10;        <span class="comment">// border around graph within the image</span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="keywordflow">if</span> (w &lt;= 20)</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        w = nArrayLength + b*2;    <span class="comment">// width of the image</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="keywordflow">if</span> (h &lt;= 20)</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        h = 220;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <span class="keywordtype">int</span> s = h - b*2;<span class="comment">// size of graph height</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="keywordtype">float</span> xscale = 1.0;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="keywordflow">if</span> (nArrayLength &gt; 1)</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        xscale = (w - b*2) / (<span class="keywordtype">float</span>)(nArrayLength-1);    <span class="comment">// horizontal scale</span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    IplImage *imageGraph;    <span class="comment">// output image</span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <span class="comment">// Get the desired image to draw into.</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="keywordflow">if</span> (!imageDst) {</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        <span class="comment">// Create an RGB image for graphing the data</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        imageGraph = cvCreateImage(cvSize(w,h), 8, 3);</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        <span class="comment">// Clear the image</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        cvSet(imageGraph, <a class="code" href="_image_utils__0_87_8cpp.html#ac6421fa2581ccc249774c179d87dbda2">WHITE</a>);</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    }</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        <span class="comment">// Draw onto the given image.</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        imageGraph = imageDst;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    }</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="keywordflow">if</span> (!imageGraph) {</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        cerr &lt;&lt; <span class="stringliteral">&quot;ERROR in drawIntGraph(): Couldn&#39;t create image of &quot;</span> &lt;&lt; w &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; h &lt;&lt; endl;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        exit(1);</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    }</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    CvScalar colorGraph = <a class="code" href="_image_utils__0_87_8cpp.html#a9e2b2766488b6a38d506d6c60abd71dd">getGraphColor</a>();    <span class="comment">// use a different color each time.</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="comment">// If the user didnt supply min &amp; mav values, find them from the data, so we can draw it at full scale.</span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="keywordflow">if</span> (minV == 0 &amp;&amp; maxV == 0) {</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>=0; <a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>&lt;nArrayLength; <a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>++) {</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;            <span class="keywordtype">int</span> v = arraySrc[<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>];</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            <span class="keywordflow">if</span> (v &lt; minV)</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                minV = v;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;            <span class="keywordflow">if</span> (v &gt; maxV)</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                maxV = v;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        }</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    }</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="keywordtype">int</span> diffV = maxV - minV;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <span class="keywordflow">if</span> (diffV == 0)</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        diffV = 1;    <span class="comment">// Stop a divide-by-zero error</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="keywordtype">float</span> fscale = (float)s / (<span class="keywordtype">float</span>)diffV;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="comment">// Draw the horizontal &amp; vertical axis</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="keywordtype">int</span> y0 = cvRound(minV*fscale);</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    cvLine(imageGraph, cvPoint(b,h-(b-y0)), cvPoint(w-b, h-(b-y0)), <a class="code" href="_image_utils__0_87_8cpp.html#abcc8c08c2c7c71b2269501cdef97bf1f">BLACK</a>);</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    cvLine(imageGraph, cvPoint(b,h-(b)), cvPoint(b, h-(b+s)), <a class="code" href="_image_utils__0_87_8cpp.html#abcc8c08c2c7c71b2269501cdef97bf1f">BLACK</a>);</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="comment">// Write the scale of the y axis</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    CvFont font;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    cvInitFont(&amp;font,CV_FONT_HERSHEY_PLAIN,0.55,0.7, 0,1,CV_AA);    <span class="comment">// For OpenCV 1.1</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="keywordflow">if</span> (showScale) {</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        <span class="comment">//cvInitFont(&amp;font,CV_FONT_HERSHEY_PLAIN,0.5,0.6, 0,1, CV_AA);    // For OpenCV 2.0</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        CvScalar clr = <a class="code" href="_image_utils__0_87_8cpp.html#aade8e3bc2d7d0b6356681953aa18da93">GREY</a>;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        <span class="keywordtype">char</span> text[16];</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        snprintf(text, <span class="keyword">sizeof</span>(text)-1, <span class="stringliteral">&quot;%.1f&quot;</span>, maxV);</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        cvPutText(imageGraph, text, cvPoint(1, b+4), &amp;font, clr);</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        <span class="comment">// Write the scale of the x axis</span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        snprintf(text, <span class="keyword">sizeof</span>(text)-1, <span class="stringliteral">&quot;%d&quot;</span>, (nArrayLength-1) );</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        cvPutText(imageGraph, text, cvPoint(w-b+4-5*strlen(text), (h/2)+10), &amp;font, clr);</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    }</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="comment">// Draw the values</span></div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    CvPoint ptPrev = cvPoint(b,h-(b-y0));    <span class="comment">// Start the lines at the 1st point.</span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>=0; <a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>&lt;nArrayLength; <a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>++) {</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        <span class="keywordtype">int</span> y = cvRound((arraySrc[<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>] - minV) * fscale);    <span class="comment">// Get the values at a bigger scale</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="_p_d_8m.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a> = cvRound(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a> * xscale);</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        CvPoint ptNew = cvPoint(b+x, h-(b+y));</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        cvLine(imageGraph, ptPrev, ptNew, colorGraph, 1, CV_AA);    <span class="comment">// Draw a line from the previous point to the new point</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        ptPrev = ptNew;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    }</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <span class="comment">// Write the graph label, if desired</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <span class="keywordflow">if</span> (graphLabel != NULL &amp;&amp; strlen(graphLabel) &gt; 0) {</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        <span class="comment">//cvInitFont(&amp;font,CV_FONT_HERSHEY_PLAIN, 0.5,0.7, 0,1,CV_AA);</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        cvPutText(imageGraph, graphLabel, cvPoint(30, 10), &amp;font, cvScalar(0,0,0,0));    <span class="comment">// black text</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    }</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    <span class="keywordflow">return</span> imageGraph;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;}</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="comment">// Draw the graph of an array of uchars into imageDst or a new image, between minV &amp; maxV if given..</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="comment">// Remember to free the newly created image if imageDst is not given.</span></div><div class="line"><a name="l00642"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#adee4557fedaf6dc9fda8b12d422f37a9">  642</a></span>&#160;IplImage* <a class="code" href="_image_utils__0_87_8cpp.html#adee4557fedaf6dc9fda8b12d422f37a9">drawUCharGraph</a>(<span class="keyword">const</span> uchar *arraySrc, <span class="keywordtype">int</span> nArrayLength, IplImage *imageDst, <span class="keywordtype">int</span> minV, <span class="keywordtype">int</span> maxV, <span class="keywordtype">int</span> width, <span class="keywordtype">int</span> height, <span class="keywordtype">char</span> *graphLabel, <span class="keywordtype">bool</span> showScale)</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;{</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <span class="keywordtype">int</span> w = width;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <span class="keywordtype">int</span> h = height;</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <span class="keywordtype">int</span> b = 10;        <span class="comment">// border around graph within the image</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <span class="keywordflow">if</span> (w &lt;= 20)</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        w = nArrayLength + b*2;    <span class="comment">// width of the image</span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <span class="keywordflow">if</span> (h &lt;= 20)</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        h = 220;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <span class="keywordtype">int</span> s = h - b*2;<span class="comment">// size of graph height</span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <span class="keywordtype">float</span> xscale = 1.0;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="keywordflow">if</span> (nArrayLength &gt; 1)</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        xscale = (w - b*2) / (<span class="keywordtype">float</span>)(nArrayLength-1);    <span class="comment">// horizontal scale</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    IplImage *imageGraph;    <span class="comment">// output image</span></div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <span class="comment">// Get the desired image to draw into.</span></div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    <span class="keywordflow">if</span> (!imageDst) {</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        <span class="comment">// Create an RGB image for graphing the data</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        imageGraph = cvCreateImage(cvSize(w,h), 8, 3);</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        <span class="comment">// Clear the image</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        cvSet(imageGraph, <a class="code" href="_image_utils__0_87_8cpp.html#ac6421fa2581ccc249774c179d87dbda2">WHITE</a>);</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    }</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        <span class="comment">// Draw onto the given image.</span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        imageGraph = imageDst;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    }</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <span class="keywordflow">if</span> (!imageGraph) {</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        cerr &lt;&lt; <span class="stringliteral">&quot;ERROR in drawUCharGraph(): Couldn&#39;t create image of &quot;</span> &lt;&lt; w &lt;&lt; <span class="stringliteral">&quot; x &quot;</span> &lt;&lt; h &lt;&lt; endl;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        exit(1);</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    }</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    CvScalar colorGraph = <a class="code" href="_image_utils__0_87_8cpp.html#a9e2b2766488b6a38d506d6c60abd71dd">getGraphColor</a>();    <span class="comment">// use a different color each time.</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <span class="comment">// If the user didnt supply min &amp; mav values, find them from the data, so we can draw it at full scale.</span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="keywordflow">if</span> (minV == 0 &amp;&amp; maxV == 0) {</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>=0; <a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>&lt;nArrayLength; <a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>++) {</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;            <span class="keywordtype">int</span> v = arraySrc[<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>];</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;            <span class="keywordflow">if</span> (v &lt; minV)</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                minV = v;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;            <span class="keywordflow">if</span> (v &gt; maxV)</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                maxV = v;</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        }</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    }</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="keywordtype">int</span> diffV = maxV - minV;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="keywordflow">if</span> (diffV == 0)</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;        diffV = 1;    <span class="comment">// Stop a divide-by-zero error</span></div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <span class="keywordtype">float</span> fscale = (float)s / (<span class="keywordtype">float</span>)diffV;</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <span class="comment">// Draw the horizontal &amp; vertical axis</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <span class="keywordtype">int</span> y0 = cvRound(minV*fscale);</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    cvLine(imageGraph, cvPoint(b,h-(b-y0)), cvPoint(w-b, h-(b-y0)), <a class="code" href="_image_utils__0_87_8cpp.html#abcc8c08c2c7c71b2269501cdef97bf1f">BLACK</a>);</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    cvLine(imageGraph, cvPoint(b,h-(b)), cvPoint(b, h-(b+s)), <a class="code" href="_image_utils__0_87_8cpp.html#abcc8c08c2c7c71b2269501cdef97bf1f">BLACK</a>);</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="comment">// Write the scale of the y axis</span></div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    CvFont font;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    cvInitFont(&amp;font,CV_FONT_HERSHEY_PLAIN,0.55,0.7, 0,1,CV_AA);    <span class="comment">// For OpenCV 1.1</span></div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <span class="keywordflow">if</span> (showScale) {</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        <span class="comment">//cvInitFont(&amp;font,CV_FONT_HERSHEY_PLAIN,0.5,0.6, 0,1, CV_AA);    // For OpenCV 2.0</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        CvScalar clr = <a class="code" href="_image_utils__0_87_8cpp.html#aade8e3bc2d7d0b6356681953aa18da93">GREY</a>;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        <span class="keywordtype">char</span> text[16];</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        snprintf(text, <span class="keyword">sizeof</span>(text)-1, <span class="stringliteral">&quot;%.1f&quot;</span>, maxV);</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        cvPutText(imageGraph, text, cvPoint(1, b+4), &amp;font, clr);</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        <span class="comment">// Write the scale of the x axis</span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        snprintf(text, <span class="keyword">sizeof</span>(text)-1, <span class="stringliteral">&quot;%d&quot;</span>, (nArrayLength-1) );</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        cvPutText(imageGraph, text, cvPoint(w-b+4-5*strlen(text), (h/2)+10), &amp;font, clr);</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    }</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <span class="comment">// Draw the values</span></div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    CvPoint ptPrev = cvPoint(b,h-(b-y0));    <span class="comment">// Start the lines at the 1st point.</span></div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>=0; <a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>&lt;nArrayLength; <a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>++) {</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        <span class="keywordtype">int</span> y = cvRound((arraySrc[<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>] - minV) * fscale);    <span class="comment">// Get the values at a bigger scale</span></div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="_p_d_8m.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a> = cvRound(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a> * xscale);</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        CvPoint ptNew = cvPoint(b+x, h-(b+y));</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        cvLine(imageGraph, ptPrev, ptNew, colorGraph, 1, CV_AA);    <span class="comment">// Draw a line from the previous point to the new point</span></div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        ptPrev = ptNew;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    }</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <span class="comment">// Write the graph label, if desired</span></div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <span class="keywordflow">if</span> (graphLabel != NULL &amp;&amp; strlen(graphLabel) &gt; 0) {</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        <span class="comment">//cvInitFont(&amp;font,CV_FONT_HERSHEY_PLAIN, 0.5,0.7, 0,1,CV_AA);</span></div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        cvPutText(imageGraph, graphLabel, cvPoint(30, 10), &amp;font, cvScalar(0,0,0,0));    <span class="comment">// black text</span></div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    }</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <span class="keywordflow">return</span> imageGraph;</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;}</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="comment">// Display a graph of the given float array.</span></div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="comment">// If background is provided, it will be drawn into, for combining multiple graphs using drawFloatGraph().</span></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="comment">// Set delay_ms to 0 if you want to wait forever until a keypress, or set it to 1 if you want it to delay just 1 millisecond.</span></div><div class="line"><a name="l00732"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#a9afbb467be07a4c77ae5a0836d15bc12">  732</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="_image_utils__0_87_8cpp.html#a9afbb467be07a4c77ae5a0836d15bc12">showFloatGraph</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keyword">const</span> <span class="keywordtype">float</span> *arraySrc, <span class="keywordtype">int</span> nArrayLength, <span class="keywordtype">int</span> delay_ms, IplImage *background)</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;{</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="preprocessor">#ifdef USE_HIGHGUI</span></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    <span class="comment">// Draw the graph</span></div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    IplImage *imageGraph = <a class="code" href="_image_utils__0_87_8cpp.html#a379a9b2857f990b6781b5891bce4921e">drawFloatGraph</a>(arraySrc, nArrayLength, background);</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    <span class="comment">// Display the graph into a window</span></div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    cvNamedWindow( name );</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    cvShowImage( name, imageGraph );</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    cvWaitKey( 10 );        <span class="comment">// Note that cvWaitKey() is required for the OpenCV window to show!</span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    cvWaitKey( delay_ms );    <span class="comment">// Wait longer to make sure the user has seen the graph</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    cvReleaseImage(&amp;imageGraph);</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;}</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="comment">// Display a graph of the given int array.</span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="comment">// If background is provided, it will be drawn into, for combining multiple graphs using drawIntGraph().</span></div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="comment">// Set delay_ms to 0 if you want to wait forever until a keypress, or set it to 1 if you want it to delay just 1 millisecond.</span></div><div class="line"><a name="l00752"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#a58c3dba9a83d379d00c08c8f5fb1751b">  752</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="_image_utils__0_87_8cpp.html#a58c3dba9a83d379d00c08c8f5fb1751b">showIntGraph</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keyword">const</span> <span class="keywordtype">int</span> *arraySrc, <span class="keywordtype">int</span> nArrayLength, <span class="keywordtype">int</span> delay_ms, IplImage *background)</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;{</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="preprocessor">#ifdef USE_HIGHGUI</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <span class="comment">// Draw the graph</span></div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    IplImage *imageGraph = <a class="code" href="_image_utils__0_87_8cpp.html#a72d9e00b861e3b95304d921d5b3cad23">drawIntGraph</a>(arraySrc, nArrayLength, background);</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <span class="comment">// Display the graph into a window</span></div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    cvNamedWindow( name );</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    cvShowImage( name, imageGraph );</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    cvWaitKey( 10 );        <span class="comment">// Note that cvWaitKey() is required for the OpenCV window to show!</span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    cvWaitKey( delay_ms );    <span class="comment">// Wait longer to make sure the user has seen the graph</span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    cvReleaseImage(&amp;imageGraph);</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;}</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="comment">// Display a graph of the given unsigned char array.</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="comment">// If background is provided, it will be drawn into, for combining multiple graphs using drawUCharGraph().</span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="comment">// Set delay_ms to 0 if you want to wait forever until a keypress, or set it to 1 if you want it to delay just 1 millisecond.</span></div><div class="line"><a name="l00772"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#aa8db8389a3a506d6713c637dd3f908c0">  772</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="_image_utils__0_87_8cpp.html#aa8db8389a3a506d6713c637dd3f908c0">showUCharGraph</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keyword">const</span> uchar *arraySrc, <span class="keywordtype">int</span> nArrayLength, <span class="keywordtype">int</span> delay_ms, IplImage *background)</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;{</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="preprocessor">#ifdef USE_HIGHGUI</span></div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    <span class="comment">// Draw the graph</span></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    IplImage *imageGraph = <a class="code" href="_image_utils__0_87_8cpp.html#adee4557fedaf6dc9fda8b12d422f37a9">drawUCharGraph</a>(arraySrc, nArrayLength, background);</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    <span class="comment">// Display the graph into a window</span></div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    cvNamedWindow( name );</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    cvShowImage( name, imageGraph );</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    cvWaitKey( 10 );        <span class="comment">// Note that cvWaitKey() is required for the OpenCV window to show!</span></div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    cvWaitKey( delay_ms );    <span class="comment">// Wait longer to make sure the user has seen the graph</span></div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    cvReleaseImage(&amp;imageGraph);</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;}</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;<span class="comment">// Simple helper function to easily view an image, with an optional pause.</span></div><div class="line"><a name="l00790"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#a0b7dcfc7e09a1bf62c43ba33d8ca8f92">  790</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="_image_utils__0_87_8cpp.html#a0b7dcfc7e09a1bf62c43ba33d8ca8f92">showImage</a>(<span class="keyword">const</span> IplImage *img, <span class="keywordtype">int</span> delay_ms, <span class="keywordtype">char</span> *name)</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;{</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<span class="comment">#ifdef USE_HIGHGUI</span></div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;<span class="comment">    if (!name)</span></div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<span class="comment">        name = &quot;Image&quot;;</span></div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="comment">    cvNamedWindow(name, CV_WINDOW_AUTOSIZE);</span></div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="comment">    cvShowImage(name, img);</span></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="comment">    cvWaitKey(delay_ms);</span></div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="comment">#endif</span></div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;}</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="comment">// Color conversion functions</span></div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="comment">// Return a new image that is always greyscale, whether the input image was RGB or Greyscale.</span></div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;<span class="comment">// Remember to free the returned image using cvReleaseImage() when finished.</span></div><div class="line"><a name="l00809"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#a6c0597165f5d03dfc54600e90f1799d1">  809</a></span>&#160;IplImage* <a class="code" href="_image_utils__0_87_8cpp.html#a6c0597165f5d03dfc54600e90f1799d1">convertImageToGreyscale</a>(<span class="keyword">const</span> IplImage *imageSrc)</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;{</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    IplImage *imageGrey;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    <span class="comment">// Either convert the image to greyscale, or make a copy of the existing greyscale image.</span></div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    <span class="comment">// This is to make sure that the user can always call cvReleaseImage() on the output, whether it was greyscale or not.</span></div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <span class="keywordflow">if</span> (imageSrc-&gt;nChannels == 3) {</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        imageGrey = cvCreateImage( cvGetSize(imageSrc), IPL_DEPTH_8U, 1 );</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;        cvCvtColor( imageSrc, imageGrey, CV_BGR2GRAY );</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    }</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        imageGrey = cvCloneImage(imageSrc);</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    }</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    <span class="keywordflow">return</span> imageGrey;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;}</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="comment">// Do the color conversion of a single pixel, from RGB to HSV using Hue values between 0 to 255, whereas OpenCV only allows Hues up to 180 instead of 255.</span></div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="comment">// ref: &quot;http://cs.haifa.ac.il/hagit/courses/ist/Lectures/Demos/ColorApplet2/t_convert.html&quot;</span></div><div class="line"><a name="l00826"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#af2f2f4eb041fb13a75ff2ad567f9e70a">  826</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="_image_utils__0_87_8cpp.html#af2f2f4eb041fb13a75ff2ad567f9e70a">convertPixelRGBtoHSV_256</a>(<span class="keywordtype">int</span> bR, <span class="keywordtype">int</span> bG, <span class="keywordtype">int</span> bB, <span class="keywordtype">int</span> &amp;bH, <span class="keywordtype">int</span> &amp;bS, <span class="keywordtype">int</span> &amp;bV)</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;{</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    <span class="keywordtype">float</span> fR, fG, fB;</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    <span class="keywordtype">float</span> fH, fS, fV;</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span> FLOAT_TO_BYTE = 255.0f;</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span> BYTE_TO_FLOAT = 1.0f / FLOAT_TO_BYTE;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    <span class="comment">// Convert from 8-bit integers to floats</span></div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    fR = bR * BYTE_TO_FLOAT;</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    fG = bG * BYTE_TO_FLOAT;</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    fB = bB * BYTE_TO_FLOAT;</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    <span class="comment">// Convert from RGB to HSV, using float ranges 0.0 to 1.0</span></div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <span class="keywordtype">float</span> fDelta;</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    <span class="keywordtype">float</span> fMin, fMax;</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    <span class="keywordtype">int</span> iMax;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    <span class="comment">// Get the min &amp; max, but use integer comparisons for slight speedup</span></div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <span class="keywordflow">if</span> (bB &lt; bG) {</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        <span class="keywordflow">if</span> (bB &lt; bR) {</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;            fMin = fB;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;            <span class="keywordflow">if</span> (bR &gt; bG) {</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                iMax = bR;</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                fMax = fR;</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;            }</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;            <span class="keywordflow">else</span> {</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                iMax = bG;</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                fMax = fG;</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;            }</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;        }</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;        <span class="keywordflow">else</span> {</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;            fMin = fR;</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;            fMax = fG;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;            iMax = bG;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;        }</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    }</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;        <span class="keywordflow">if</span> (bG &lt; bR) {</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;            fMin = fG;</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;            <span class="keywordflow">if</span> (bB &gt; bR) {</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                fMax = fB;</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                iMax = bB;</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;            }</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;            <span class="keywordflow">else</span> {</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                fMax = fR;</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                iMax = bR;</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;            }</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        }</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;        <span class="keywordflow">else</span> {</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;            fMin = fR;</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;            fMax = fB;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;            iMax = bB;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;        }</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    }</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    fDelta = fMax - fMin;</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    fV = fMax;                    <span class="comment">// Value (Brightness).</span></div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    <span class="keywordflow">if</span> (iMax != 0) {            <span class="comment">// Make sure its not pure black.</span></div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        fS = fDelta / fMax;        <span class="comment">// Saturation.</span></div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        <span class="keywordtype">float</span> ANGLE_TO_UNIT = 1.0f / (6.0f * fDelta);    <span class="comment">// Make the Hues between 0.0 to 1.0 instead of 6.0</span></div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;        <span class="keywordflow">if</span> (iMax == bR) {        <span class="comment">// between yellow &amp; magenta.</span></div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;            fH = (fG - fB) * ANGLE_TO_UNIT;</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        }</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iMax == bG) {    <span class="comment">// between cyan &amp; yellow.</span></div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;            fH = (2.0f/6.0f) + ( fB - fR ) * ANGLE_TO_UNIT;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;        }</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        <span class="keywordflow">else</span> {                    <span class="comment">// between magenta &amp; cyan.</span></div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;            fH = (4.0f/6.0f) + ( fR - fG ) * ANGLE_TO_UNIT;</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;        }</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        <span class="comment">// Wrap outlier Hues around the circle.</span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        <span class="keywordflow">if</span> (fH &lt; 0.0f)</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;            fH += 1.0f;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        <span class="keywordflow">if</span> (fH &gt;= 1.0f)</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;            fH -= 1.0f;</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    }</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        <span class="comment">// color is pure Black.</span></div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;        fS = 0;</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        fH = 0;    <span class="comment">// undefined hue</span></div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    }</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    <span class="comment">// Convert from floats to 8-bit integers</span></div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    bH = (int)(0.5f + fH * 255.0f);</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    bS = (int)(0.5f + fS * 255.0f);</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    bV = (int)(0.5f + fV * 255.0f);</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    <span class="comment">// Clip the values to make sure it fits within the 8bits</span></div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    <span class="comment">//if (bH &gt; 255 || bH &lt; 0 || bS &gt; 255 || bS &lt; 0 || bV &gt; 255 || bV &lt; 0) {</span></div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <span class="comment">//    cout &lt;&lt; &quot;Warning: HSV pixel(&quot; &lt;&lt; x &lt;&lt; &quot;,&quot; &lt;&lt; y &lt;&lt; &quot;) is being clipped. &quot; &lt;&lt; bH &lt;&lt; &quot;,&quot; &lt;&lt; bS &lt;&lt; &quot;,&quot; &lt;&lt; bV &lt;&lt; endl;</span></div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <span class="comment">//}</span></div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    <span class="keywordflow">if</span> (bH &gt; 255)</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        bH = 255;</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    <span class="keywordflow">if</span> (bH &lt; 0)</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;        bH = 0;</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    <span class="keywordflow">if</span> (bS &gt; 255)</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;        bS = 255;</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    <span class="keywordflow">if</span> (bS &lt; 0)</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        bS = 0;</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    <span class="keywordflow">if</span> (bV &gt; 255)</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        bV = 255;</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    <span class="keywordflow">if</span> (bV &lt; 0)</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        bV = 0;</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;}</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="comment">// Create a HSV image from the RGB image using the full 8-bits, since OpenCV only allows Hues up to 180 instead of 255.</span></div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="comment">// ref: &quot;http://cs.haifa.ac.il/hagit/courses/ist/Lectures/Demos/ColorApplet2/t_convert.html&quot;</span></div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<span class="comment">// Remember to free the generated HSV image.</span></div><div class="line"><a name="l00931"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#a9dcb12c5075cf304d27571baa97c11aa">  931</a></span>&#160;IplImage* <a class="code" href="_image_utils__0_87_8cpp.html#a9dcb12c5075cf304d27571baa97c11aa">convertImageRGBtoHSV</a>(<span class="keyword">const</span> IplImage *imageRGB)</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;{</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    <span class="comment">// Create a blank HSV image</span></div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    IplImage *imageHSV = cvCreateImage(cvGetSize(imageRGB), 8, 3);</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <span class="keywordflow">if</span> (!imageHSV || imageRGB-&gt;depth != 8 || imageRGB-&gt;nChannels != 3) {</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;        LOG(<span class="stringliteral">&quot;ERROR in convertImageRGBtoHSV()! Bad input image.\n&quot;</span>);</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;        exit(1);</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    }</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    <span class="keywordtype">int</span> h = imageRGB-&gt;height;                <span class="comment">// Pixel height</span></div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    <span class="keywordtype">int</span> w = imageRGB-&gt;width;                <span class="comment">// Pixel width</span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    <span class="keywordtype">int</span> rowSizeRGB = imageRGB-&gt;widthStep;    <span class="comment">// Size of row in bytes, including extra padding</span></div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    <span class="keywordtype">char</span> *imRGB = imageRGB-&gt;imageData;        <span class="comment">// Pointer to the start of the image pixels.</span></div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    <span class="keywordtype">int</span> rowSizeHSV = imageHSV-&gt;widthStep;    <span class="comment">// Size of row in bytes, including extra padding</span></div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    <span class="keywordtype">char</span> *imHSV = imageHSV-&gt;imageData;        <span class="comment">// Pointer to the start of the image pixels.</span></div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> y=0; y&lt;h; y++) {</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="_p_d_8m.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a>=0; <a class="code" href="_p_d_8m.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a>&lt;w; <a class="code" href="_p_d_8m.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a>++) {</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;            <span class="comment">// Get the RGB pixel components. NOTE that OpenCV stores RGB pixels in B,G,R order.</span></div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;            uchar *pRGB = (uchar*)(imRGB + y*rowSizeRGB + <a class="code" href="_p_d_8m.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a>*3);</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;            <span class="keywordtype">int</span> bB = *(uchar*)(pRGB+0);    <span class="comment">// Blue component</span></div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;            <span class="keywordtype">int</span> bG = *(uchar*)(pRGB+1);    <span class="comment">// Green component</span></div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;            <span class="keywordtype">int</span> bR = *(uchar*)(pRGB+2);    <span class="comment">// Red component</span></div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;            <span class="comment">// Do the conversion.</span></div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;            <span class="keywordtype">int</span> bH, bS, bV;</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;            <a class="code" href="_image_utils__0_87_8cpp.html#af2f2f4eb041fb13a75ff2ad567f9e70a">convertPixelRGBtoHSV_256</a>(bR,bG,bB, bH,bS,bV);</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;            <span class="comment">// Set the HSV pixel components</span></div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;            uchar *pHSV = (uchar*)(imHSV + y*rowSizeHSV + <a class="code" href="_p_d_8m.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a>*3);</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;            *(pHSV+0) = bH;        <span class="comment">// H component</span></div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;            *(pHSV+1) = bS;        <span class="comment">// S component</span></div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;            *(pHSV+2) = bV;        <span class="comment">// V component</span></div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;        }</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    }</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    <span class="keywordflow">return</span> imageHSV;</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;}</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;<span class="comment">// Do the color conversion of a single pixel, from HSV to RGB using Hue values between 0 to 255, whereas OpenCV only allows Hues up to 180 instead of 255.</span></div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;<span class="comment">// ref: &quot;http://cs.haifa.ac.il/hagit/courses/ist/Lectures/Demos/ColorApplet2/t_convert.html&quot;</span></div><div class="line"><a name="l00970"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#a077994dd1627ad13e634f5a9e7740b32">  970</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="_image_utils__0_87_8cpp.html#a077994dd1627ad13e634f5a9e7740b32">convertPixelHSVtoRGB_256</a>(<span class="keywordtype">int</span> bH, <span class="keywordtype">int</span> bS, <span class="keywordtype">int</span> bV, <span class="keywordtype">int</span> &amp;bR, <span class="keywordtype">int</span> &amp;bG, <span class="keywordtype">int</span> &amp;bB)</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;{</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    <span class="keywordtype">float</span> fH, fS, fV;</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    <span class="keywordtype">float</span> fR, fG, fB;</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span> FLOAT_TO_BYTE = 255.0f;</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span> BYTE_TO_FLOAT = 1.0f / FLOAT_TO_BYTE;</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    <span class="comment">// Convert from 8-bit integers to floats</span></div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    fH = (float)bH * BYTE_TO_FLOAT;</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    fS = (float)bS * BYTE_TO_FLOAT;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    fV = (float)bV * BYTE_TO_FLOAT;</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    <span class="comment">// Convert from HSV to RGB, using float ranges 0.0 to 1.0</span></div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    <span class="keywordtype">int</span> iI;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    <span class="keywordtype">float</span> fI, fF, p, q, t;</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <span class="keywordflow">if</span>( bS == 0 ) {</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;        <span class="comment">// achromatic (grey)</span></div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;        fR = fG = fB = fV;</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    }</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        <span class="comment">//if (bH &lt; 0 || bH &gt;= 255 || bS &lt; 0 || bS &gt; 255 || bV &lt; 0 || bV &gt; 255) {</span></div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;        <span class="comment">//    cout &lt;&lt; &quot;ERROR: HSVi pixel(&quot; &lt;&lt; x &lt;&lt; &quot;,&quot; &lt;&lt; y &lt;&lt; &quot;) is being clipped. &quot; &lt;&lt; bH &lt;&lt; &quot;,&quot; &lt;&lt; bS &lt;&lt; &quot;,&quot; &lt;&lt; bV &lt;&lt; endl;</span></div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;        <span class="comment">//    cout &lt;&lt; &quot;ERROR: HSVf pixel(&quot; &lt;&lt; x &lt;&lt; &quot;,&quot; &lt;&lt; y &lt;&lt; &quot;) is being clipped. &quot; &lt;&lt; fH &lt;&lt; &quot;,&quot; &lt;&lt; fS &lt;&lt; &quot;,&quot; &lt;&lt; fV &lt;&lt; endl;</span></div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;        <span class="comment">//}</span></div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;        <span class="comment">// If Hue == 1.0, then wrap it around the circle to 0.0</span></div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;        <span class="keywordflow">if</span> (fH &gt;= 1.0f)</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;            fH = 0.0f;</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;        fH *= 6.0;            <span class="comment">// sector 0 to 5</span></div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;        fI = floor( fH );        <span class="comment">// integer part of h (0,1,2,3,4,5 or 6)</span></div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        iI = (int) fH;            <span class="comment">//        &quot;        &quot;        &quot;        &quot;</span></div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        fF = fH - fI;            <span class="comment">// factorial part of h (0 to 1)</span></div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        p = fV * ( 1.0f - fS );</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;        q = fV * ( 1.0f - fS * fF );</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;        t = fV * ( 1.0f - fS * ( 1.0f - fF ) );</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;        <span class="keywordflow">switch</span>( iI ) {</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;            <span class="keywordflow">case</span> 0:</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                fR = fV;</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;                fG = t;</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;                fB = p;</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;            <span class="keywordflow">case</span> 1:</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;                fR = q;</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;                fG = fV;</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;                fB = p;</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;            <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;                fR = p;</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;                fG = fV;</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;                fB = t;</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;            <span class="keywordflow">case</span> 3:</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;                fR = p;</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;                fG = q;</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                fB = fV;</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;            <span class="keywordflow">case</span> 4:</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;                fR = t;</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;                fG = p;</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;                fB = fV;</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;            <span class="keywordflow">default</span>:        <span class="comment">// case 5 (or 6):</span></div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                fR = fV;</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                fG = p;</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                fB = q;</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;        }</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    }</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    <span class="comment">// Convert from floats to 8-bit integers</span></div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    bR = (int)(fR * FLOAT_TO_BYTE);</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    bG = (int)(fG * FLOAT_TO_BYTE);</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    bB = (int)(fB * FLOAT_TO_BYTE);</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    <span class="comment">// Clip the values to make sure it fits within the 8bits</span></div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    <span class="comment">//if (bR &gt; 255 || bR &lt; 0 || bG &gt; 255 || bG &lt; 0 || bB &gt; 255 || bB &lt; 0) {</span></div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    <span class="comment">//    cout &lt;&lt; &quot;Warning: RGB pixel(&quot; &lt;&lt; x &lt;&lt; &quot;,&quot; &lt;&lt; y &lt;&lt; &quot;) is being clipped. &quot; &lt;&lt; bR &lt;&lt; &quot;,&quot; &lt;&lt; bG &lt;&lt; &quot;,&quot; &lt;&lt; bB &lt;&lt; endl;</span></div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    <span class="comment">//}</span></div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    <span class="keywordflow">if</span> (bR &gt; 255)</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        bR = 255;</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    <span class="keywordflow">if</span> (bR &lt; 0)</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;        bR = 0;</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    <span class="keywordflow">if</span> (bG &gt; 255)</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;        bG = 255;</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    <span class="keywordflow">if</span> (bG &lt; 0)</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;        bG = 0;</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    <span class="keywordflow">if</span> (bB &gt; 255)</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;        bB = 255;</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    <span class="keywordflow">if</span> (bB &lt; 0)</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;        bB = 0;</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;}</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;<span class="comment">// Create an RGB image from the HSV image using the full 8-bits, since OpenCV only allows Hues up to 180 instead of 255.</span></div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;<span class="comment">// ref: &quot;http://cs.haifa.ac.il/hagit/courses/ist/Lectures/Demos/ColorApplet2/t_convert.html&quot;</span></div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;<span class="comment">// Remember to free the generated RGB image.</span></div><div class="line"><a name="l01069"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#a1d4a420196d8b8b9ac303d22e4a10480"> 1069</a></span>&#160;IplImage* <a class="code" href="_image_utils__0_87_8cpp.html#a1d4a420196d8b8b9ac303d22e4a10480">convertImageHSVtoRGB</a>(<span class="keyword">const</span> IplImage *imageHSV)</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;{</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    <span class="comment">// Create a blank RGB image</span></div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    IplImage *imageRGB = cvCreateImage(cvGetSize(imageHSV), 8, 3);</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    <span class="keywordflow">if</span> (!imageRGB || imageHSV-&gt;depth != 8 || imageHSV-&gt;nChannels != 3) {</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;        LOG(<span class="stringliteral">&quot;ERROR in convertImageHSVtoRGB()! Bad input image.\n&quot;</span>);</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;        exit(1);</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    }</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    <span class="keywordtype">int</span> h = imageHSV-&gt;height;                <span class="comment">// Pixel height</span></div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    <span class="keywordtype">int</span> w = imageHSV-&gt;width;                <span class="comment">// Pixel width</span></div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    <span class="keywordtype">int</span> rowSizeHSV = imageHSV-&gt;widthStep;    <span class="comment">// Size of row in bytes, including extra padding</span></div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    <span class="keywordtype">char</span> *imHSV = imageHSV-&gt;imageData;        <span class="comment">// Pointer to the start of the image pixels.</span></div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    <span class="keywordtype">int</span> rowSizeRGB = imageRGB-&gt;widthStep;    <span class="comment">// Size of row in bytes, including extra padding</span></div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    <span class="keywordtype">char</span> *imRGB = imageRGB-&gt;imageData;        <span class="comment">// Pointer to the start of the image pixels.</span></div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> y=0; y&lt;h; y++) {</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="_p_d_8m.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a>=0; <a class="code" href="_p_d_8m.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a>&lt;w; <a class="code" href="_p_d_8m.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a>++) {</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;            <span class="comment">// Get the HSV pixel components</span></div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;            uchar *pHSV = (uchar*)(imHSV + y*rowSizeHSV + <a class="code" href="_p_d_8m.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a>*3);</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;            <span class="keywordtype">int</span> bH = *(uchar*)(pHSV+0);    <span class="comment">// H component</span></div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;            <span class="keywordtype">int</span> bS = *(uchar*)(pHSV+1);    <span class="comment">// S component</span></div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;            <span class="keywordtype">int</span> bV = *(uchar*)(pHSV+2);    <span class="comment">// V component</span></div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;            <span class="comment">// Do the conversion.</span></div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;            <span class="keywordtype">int</span> bB, bG, bR;</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;            <a class="code" href="_image_utils__0_87_8cpp.html#a077994dd1627ad13e634f5a9e7740b32">convertPixelHSVtoRGB_256</a>(bH,bS,bV,  bR,bG,bB);</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;            <span class="comment">// Set the RGB pixel components. NOTE that OpenCV stores RGB pixels in B,G,R order.</span></div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;            uchar *pRGB = (uchar*)(imRGB + y*rowSizeRGB + <a class="code" href="_p_d_8m.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a>*3);</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;            *(pRGB+0) = bB;        <span class="comment">// B component</span></div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;            *(pRGB+1) = bG;        <span class="comment">// G component</span></div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;            *(pRGB+2) = bR;        <span class="comment">// R component</span></div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;        }</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    }</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    <span class="keywordflow">return</span> imageRGB;</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;}</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;<span class="comment">// Do the color conversion of a single pixel, from RGB to HSV using Hue values between 0 to 179 just like OpenCV does, instead of Hues upto 255.</span></div><div class="line"><a name="l01107"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#aa1895a075a89e930fd81265778cfc76a"> 1107</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="_image_utils__0_87_8cpp.html#aa1895a075a89e930fd81265778cfc76a">convertPixelRGBtoHSV_180</a>(<span class="keywordtype">int</span> bR, <span class="keywordtype">int</span> bG, <span class="keywordtype">int</span> bB, <span class="keywordtype">int</span> &amp;bH, <span class="keywordtype">int</span> &amp;bS, <span class="keywordtype">int</span> &amp;bV)</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;{</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    <span class="comment">// Do the conversion with Hues between 0 to 255.</span></div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    <a class="code" href="_image_utils__0_87_8cpp.html#af2f2f4eb041fb13a75ff2ad567f9e70a">convertPixelRGBtoHSV_256</a>(bR,bG,bB, bH,bS,bV);</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    <span class="comment">// Convert to a Hue of 180 range from 256 range.</span></div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    bH = 179 * bH / 255;</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;}</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;<span class="comment">// Do the color conversion of a single pixel, from HSV to RGB using Hue values between 0 to 179 just like OpenCV does, instead of Hues upto 255.</span></div><div class="line"><a name="l01117"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#afb0d1a94a04194ea11c1eaaca11a0feb"> 1117</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="_image_utils__0_87_8cpp.html#afb0d1a94a04194ea11c1eaaca11a0feb">convertPixelHSVtoRGB_180</a>(<span class="keywordtype">int</span> bH, <span class="keywordtype">int</span> bS, <span class="keywordtype">int</span> bV, <span class="keywordtype">int</span> &amp;bR, <span class="keywordtype">int</span> &amp;bG, <span class="keywordtype">int</span> &amp;bB)</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;{</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    <span class="comment">// Convert from a Hue of 180 range to 256 range.</span></div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    bH = 255 * bH / 179;</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    <span class="comment">// Do the conversion with Hues between 0 to 255.</span></div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    <a class="code" href="_image_utils__0_87_8cpp.html#a077994dd1627ad13e634f5a9e7740b32">convertPixelHSVtoRGB_256</a>(bH,bS,bV,  bR,bG,bB);</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;}</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;<span class="comment">// Create an RGB image from the YIQ image using an approximation of NTSC conversion(ref: &quot;YIQ&quot; Wikipedia page).</span></div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;<span class="comment">// Remember to free the generated RGB image.</span></div><div class="line"><a name="l01128"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#adf7d71d81f75c4d1798fc88237879a7d"> 1128</a></span>&#160;IplImage* <a class="code" href="_image_utils__0_87_8cpp.html#adf7d71d81f75c4d1798fc88237879a7d">convertImageYIQtoRGB</a>(<span class="keyword">const</span> IplImage *imageYIQ)</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;{</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;    <span class="keywordtype">float</span> fY, fI, fQ;</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;    <span class="keywordtype">float</span> fR, fG, fB;</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span> FLOAT_TO_BYTE = 255.0f;</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    <span class="comment">//const float BYTE_TO_FLOAT = 1.0f / FLOAT_TO_BYTE;</span></div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span> MIN_I = -0.5957f;</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span> MIN_Q = -0.5226f;</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span> Y_TO_FLOAT = 1.0f / 255.0f;</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span> I_TO_FLOAT = -2.0f * MIN_I / 255.0f;</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span> Q_TO_FLOAT = -2.0f * MIN_Q / 255.0f;</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    <span class="comment">// Create a blank RGB image</span></div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    IplImage *imageRGB = cvCreateImage(cvGetSize(imageYIQ), 8, 3);</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;    <span class="keywordflow">if</span> (!imageRGB || imageYIQ-&gt;depth != 8 || imageYIQ-&gt;nChannels != 3) {</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;        LOG(<span class="stringliteral">&quot;ERROR in convertImageYIQtoRGB()! Bad input image.\n&quot;</span>);</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;        exit(1);</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    }</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;    <span class="keywordtype">int</span> h = imageYIQ-&gt;height;                <span class="comment">// Pixel height</span></div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    <span class="keywordtype">int</span> w = imageYIQ-&gt;width;                <span class="comment">// Pixel width</span></div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    <span class="keywordtype">int</span> rowSizeYIQ = imageYIQ-&gt;widthStep;    <span class="comment">// Size of row in bytes, including extra padding</span></div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    <span class="keywordtype">char</span> *imYIQ = imageYIQ-&gt;imageData;        <span class="comment">// Pointer to the start of the image pixels.</span></div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    <span class="keywordtype">int</span> rowSizeRGB = imageRGB-&gt;widthStep;    <span class="comment">// Size of row in bytes, including extra padding</span></div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    <span class="keywordtype">char</span> *imRGB = imageRGB-&gt;imageData;        <span class="comment">// Pointer to the start of the image pixels.</span></div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> y=0; y&lt;h; y++) {</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="_p_d_8m.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a>=0; <a class="code" href="_p_d_8m.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a>&lt;w; <a class="code" href="_p_d_8m.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a>++) {</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;            <span class="comment">// Get the YIQ pixel components</span></div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;            uchar *pYIQ = (uchar*)(imYIQ + y*rowSizeYIQ + <a class="code" href="_p_d_8m.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a>*3);</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;            <span class="keywordtype">int</span> bY = *(uchar*)(pYIQ+0);    <span class="comment">// Y component</span></div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;            <span class="keywordtype">int</span> bI = *(uchar*)(pYIQ+1);    <span class="comment">// I component</span></div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;            <span class="keywordtype">int</span> bQ = *(uchar*)(pYIQ+2);    <span class="comment">// Q component</span></div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;            <span class="comment">// Convert from 8-bit integers to floats</span></div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;            fY = (float)bY * Y_TO_FLOAT;</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;            fI = (float)bI * I_TO_FLOAT + MIN_I;</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;            fQ = (float)bQ * Q_TO_FLOAT + MIN_Q;</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;            <span class="comment">// Convert from YIQ to RGB</span></div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;            <span class="comment">// where R,G,B are 0-1, Y is 0-1, I is -0.5957 to +0.5957, Q is -0.5226 to +0.5226.</span></div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;            fR =  fY  + 0.9563f * fI + 0.6210f * fQ;</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;            fG =  fY  - 0.2721f * fI - 0.6474f * fQ;</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;            fB =  fY  - 1.1070f * fI + 1.7046f * fQ;</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;            <span class="comment">// Convert from floats to 8-bit integers</span></div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;            <span class="keywordtype">int</span> bR = (int)(fR * FLOAT_TO_BYTE);</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;            <span class="keywordtype">int</span> bG = (int)(fG * FLOAT_TO_BYTE);</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;            <span class="keywordtype">int</span> bB = (int)(fB * FLOAT_TO_BYTE);</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;            <span class="comment">// Clip the values to make sure it fits within the 8bits</span></div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;            <span class="comment">//if (bR &gt; 255 || bR &lt; 0 || bG &gt; 255 || bG &lt; 0 || bB &gt; 255 || bB &lt; 0) {</span></div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;            <span class="comment">//    cout &lt;&lt; &quot;Warning: RGB pixel(&quot; &lt;&lt; x &lt;&lt; &quot;,&quot; &lt;&lt; y &lt;&lt; &quot;) is being clipped. &quot; &lt;&lt; bR &lt;&lt; &quot;,&quot; &lt;&lt; bG &lt;&lt; &quot;,&quot; &lt;&lt; bB &lt;&lt; endl;</span></div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;            <span class="comment">//}</span></div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;            <span class="keywordflow">if</span> (bR &gt; 255)</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;                bR = 255;</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;            <span class="keywordflow">if</span> (bR &lt; 0)</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;                bR = 0;</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;            <span class="keywordflow">if</span> (bG &gt; 255)</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;                bG = 255;</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;            <span class="keywordflow">if</span> (bG &lt; 0)</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;                bG = 0;</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;            <span class="keywordflow">if</span> (bB &gt; 255)</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;                bB = 255;</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;            <span class="keywordflow">if</span> (bB &lt; 0)</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;                bB = 0;</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;            <span class="comment">// Set the RGB pixel components. NOTE that OpenCV stores RGB pixels in B,G,R order.</span></div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;            uchar *pRGB = (uchar*)(imRGB + y*rowSizeRGB + <a class="code" href="_p_d_8m.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a>*3);</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;            *(pRGB+0) = bB;        <span class="comment">// B component</span></div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;            *(pRGB+1) = bG;        <span class="comment">// G component</span></div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;            *(pRGB+2) = bR;        <span class="comment">// R component</span></div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;        }</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    }</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    <span class="keywordflow">return</span> imageRGB;</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;}</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;<span class="comment">// 2D Point functions</span></div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div><div class="line"><a name="l01205"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#a9271a93dd613180f6fd8ce77bb639494"> 1205</a></span>&#160;CvPoint2D32f <a class="code" href="_image_utils__0_87_8cpp.html#a9271a93dd613180f6fd8ce77bb639494">addPointF</a>(<span class="keyword">const</span> CvPoint2D32f pointA, <span class="keyword">const</span> CvPoint2D32f pointB)</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;{</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    CvPoint2D32f ret;</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    ret.x = pointA.x + pointB.x;</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    ret.y = pointA.y + pointB.y;</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;}</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;</div><div class="line"><a name="l01213"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#aa556e96a0166fda3abbfb7a3abff48f6"> 1213</a></span>&#160;CvPoint2D32f <a class="code" href="_image_utils__0_87_8cpp.html#aa556e96a0166fda3abbfb7a3abff48f6">subtractPointF</a>(<span class="keyword">const</span> CvPoint2D32f pointA, <span class="keyword">const</span> CvPoint2D32f pointB)</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;{</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    CvPoint2D32f ret;</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    ret.x = pointA.x - pointB.x;</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    ret.y = pointA.y - pointB.y;</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;}</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;</div><div class="line"><a name="l01221"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#a8b339c1ee055e4bb597facdca87fa2dd"> 1221</a></span>&#160;CvPoint2D32f <a class="code" href="_image_utils__0_87_8cpp.html#a8b339c1ee055e4bb597facdca87fa2dd">scalePointF</a>(<span class="keyword">const</span> CvPoint2D32f point, <span class="keywordtype">float</span> scale)</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;{</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    CvPoint2D32f ret;</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    ret.x = point.x * scale;</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    ret.y = point.y * scale;</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;}</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;</div><div class="line"><a name="l01229"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#a6ffabb9779799c3b41af29bb58ac8e9a"> 1229</a></span>&#160;CvPoint2D32f <a class="code" href="_image_utils__0_87_8cpp.html#a6ffabb9779799c3b41af29bb58ac8e9a">rotatePointF</a>(<span class="keyword">const</span> CvPoint2D32f point, <span class="keywordtype">float</span> angleDegrees)</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;{</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    CvPoint2D32f ret;</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    <span class="keywordtype">float</span> dx = point.x;</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    <span class="keywordtype">float</span> dy = point.y;</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    <span class="keywordtype">float</span> angleRadians = angleDegrees * ((float)CV_PI / 180.0f);</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    <span class="keywordtype">float</span> cosA = cos(angleRadians);</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;    <span class="keywordtype">float</span> sinA = sin(angleRadians);</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    ret.x = (dx * cosA - dy * sinA);</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    ret.y = (dx * sinA + dy * cosA);</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;}</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;</div><div class="line"><a name="l01242"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#a06d8cb50bae2f8acac7ace9fa805ac28"> 1242</a></span>&#160;CvPoint2D32f <a class="code" href="_image_utils__0_87_8cpp.html#a06d8cb50bae2f8acac7ace9fa805ac28">rotatePointAroundPointF</a>(<span class="keyword">const</span> CvPoint2D32f point, <span class="keyword">const</span> CvPoint2D32f origin, <span class="keywordtype">float</span> angleDegrees)</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;{</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    CvPoint2D32f ret;</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    <span class="keywordtype">float</span> dx = point.x - origin.x;</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    <span class="keywordtype">float</span> dy = point.y - origin.y;</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    <span class="keywordtype">float</span> angleRadians = angleDegrees * ((float)CV_PI / 180.0f);</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    <span class="keywordtype">float</span> cosA = cos(angleRadians);</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;    <span class="keywordtype">float</span> sinA = sin(angleRadians);</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;    ret.x = (dx * cosA - dy * sinA) + origin.x;</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    ret.y = (dx * sinA + dy * cosA) + origin.y;</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;}</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;</div><div class="line"><a name="l01255"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#aab612cb70e652fea8bf399d4cd49fb4f"> 1255</a></span>&#160;CvPoint2D32f <a class="code" href="_image_utils__0_87_8cpp.html#aab612cb70e652fea8bf399d4cd49fb4f">scalePointAroundPointF</a>(<span class="keyword">const</span> CvPoint2D32f point, <span class="keyword">const</span> CvPoint2D32f origin, <span class="keywordtype">float</span> scale)</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;{</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;    CvPoint2D32f ret;</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;    <span class="keywordtype">float</span> dx = point.x - origin.x;</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    <span class="keywordtype">float</span> dy = point.y - origin.y;</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;    ret.x = (dx * scale) + origin.x;</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;    ret.y = (dy * scale) + origin.y;</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;    <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;}</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;<span class="comment">// Return (p * s), to a maximum value of maxVal</span></div><div class="line"><a name="l01266"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#ab2c6aa5ac6cbe4bb9c3dd12451323746"> 1266</a></span>&#160;<span class="keywordtype">float</span> <a class="code" href="_image_utils__0_87_8cpp.html#ab2c6aa5ac6cbe4bb9c3dd12451323746">scaleValueF</a>(<span class="keywordtype">float</span> p, <span class="keywordtype">float</span> s, <span class="keywordtype">float</span> maxVal)</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;{</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;    <span class="keywordtype">float</span> <a class="code" href="process__1_8m.html#afa522382c3fac96d0f07658ea5d69adc">r</a> = p * s;</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;    <span class="keywordflow">if</span> (r &gt; maxVal)</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;    {</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;        r = maxVal;</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;    }</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="process__1_8m.html#afa522382c3fac96d0f07658ea5d69adc">r</a>;</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;}</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;<span class="comment">// Return (p * s), to a maximum value of maxVal</span></div><div class="line"><a name="l01277"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#a838a6a38fc180f0dfb070d22b516cf92"> 1277</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="_image_utils__0_87_8cpp.html#a838a6a38fc180f0dfb070d22b516cf92">scaleValueI</a>(<span class="keywordtype">int</span> p, <span class="keywordtype">float</span> s, <span class="keywordtype">int</span> maxVal)</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;{</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="process__1_8m.html#afa522382c3fac96d0f07658ea5d69adc">r</a> = cvRound( ((<span class="keywordtype">float</span>)p) * s );</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;    <span class="keywordflow">if</span> (r &gt; maxVal)</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;    {</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;        r = maxVal;</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    }</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="process__1_8m.html#afa522382c3fac96d0f07658ea5d69adc">r</a>;</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;}</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;<span class="comment">// Calculate the distance between the 2 given points.</span></div><div class="line"><a name="l01289"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#a0a7ca8e17d04231c422569e1c1c25d61"> 1289</a></span>&#160;<span class="keywordtype">float</span> <a class="code" href="_image_utils__0_87_8cpp.html#a0a7ca8e17d04231c422569e1c1c25d61">findDistanceBetweenPointsF</a>(<span class="keyword">const</span> CvPoint2D32f p1, <span class="keyword">const</span> CvPoint2D32f p2)</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;{</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    <span class="comment">// Calc the pythagoras distance.</span></div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;    <span class="keywordtype">float</span> dx = (p1.x - p2.x);</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    <span class="keywordtype">float</span> dy = (p1.y - p2.y);</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    <span class="keywordflow">return</span> sqrt((<span class="keywordtype">float</span>) (dx * dx + dy * dy));</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;}</div><div class="line"><a name="l01296"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#ab5a8f37501ae03e68eeab5f56bdd15c0"> 1296</a></span>&#160;<span class="keywordtype">float</span> <a class="code" href="_image_utils__0_87_8cpp.html#ab5a8f37501ae03e68eeab5f56bdd15c0">findDistanceBetweenPointsI</a>(<span class="keyword">const</span> CvPoint p1, <span class="keyword">const</span> CvPoint p2)</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;{</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    <span class="comment">// Calc the pythagoras distance.</span></div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    <span class="keywordtype">int</span> dx = (p1.x - p2.x);</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    <span class="keywordtype">int</span> dy = (p1.y - p2.y);</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    <span class="keywordflow">return</span> sqrt((<span class="keywordtype">float</span>) (dx * dx + dy * dy));</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;}</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;<span class="comment">// Calculate the angle between the 2 given floating-point points (in degrees).</span></div><div class="line"><a name="l01305"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#a8355fae3cd30c8e2134125e715465e1d"> 1305</a></span>&#160;<span class="keywordtype">float</span> <a class="code" href="_image_utils__0_87_8cpp.html#a8355fae3cd30c8e2134125e715465e1d">findAngleBetweenPointsF</a>(<span class="keyword">const</span> CvPoint2D32f p1, <span class="keyword">const</span> CvPoint2D32f p2)</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;{</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    <span class="comment">// Calculate the angle of in-plane-rotation of the face based on the angle of the 2 eye positions.</span></div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    <span class="keywordtype">float</span> dx = (float)(p2.x - p1.x);</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    <span class="keywordflow">if</span> (dx == 0.0f)</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;        dx = 0.00000001f;    <span class="comment">// Stop a divide-by-zero error.</span></div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    <span class="keywordtype">float</span> radians = atan2((<span class="keywordtype">float</span>) (p2.y - p1.y), dx);    <span class="comment">// angle = inv_tan(dy / dx).</span></div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    <span class="keywordflow">return</span> (radians * 180.0f / (<span class="keywordtype">float</span>)CV_PI);    <span class="comment">// convert to degrees from radians.</span></div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;}</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;<span class="comment">// Calculate the angle between the 2 given integer points (in degrees).</span></div><div class="line"><a name="l01315"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#aa4511098296beb72b5466963498d0ad7"> 1315</a></span>&#160;<span class="keywordtype">float</span> <a class="code" href="_image_utils__0_87_8cpp.html#aa4511098296beb72b5466963498d0ad7">findAngleBetweenPointsI</a>(<span class="keyword">const</span> CvPoint p1, <span class="keyword">const</span> CvPoint p2)</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;{</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    <span class="comment">// Calculate the angle of in-plane-rotation of the face based on the angle of the 2 eye positions.</span></div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    <span class="keywordtype">float</span> dx = (float)(p2.x - p1.x);</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    <span class="keywordflow">if</span> (dx == 0.0f)</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;        dx = 0.00000001f;    <span class="comment">// Stop a divide-by-zero error.</span></div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    <span class="keywordtype">float</span> radians = atan2((<span class="keywordtype">float</span>) (p2.y - p1.y), dx);    <span class="comment">// angle = inv_tan(dy / dx).</span></div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    <span class="keywordflow">return</span> (radians * 180.0f / (<span class="keywordtype">float</span>)CV_PI);    <span class="comment">// convert to degrees from radians.</span></div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;}</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;<span class="comment">// Print the label and then the rect to the console for easy debugging</span></div><div class="line"><a name="l01326"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#a8901832277b3f8073d4e10d107d95876"> 1326</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="_image_utils__0_87_8cpp.html#a8901832277b3f8073d4e10d107d95876">printPoint</a>(<span class="keyword">const</span> CvPoint pt, <span class="keyword">const</span> <span class="keywordtype">char</span> *label)</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;{</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;    <span class="keywordflow">if</span> (label)</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;        std::cout &lt;&lt; label &lt;&lt; <span class="stringliteral">&quot;: &quot;</span>;</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;[Point] at (&quot;</span> &lt;&lt; pt.x &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; pt.y &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;}</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;<span class="comment">// Print the label and then the rect to the console for easy debugging</span></div><div class="line"><a name="l01334"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#a8b8c337e358870196d79e8edf5888730"> 1334</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="_image_utils__0_87_8cpp.html#a8b8c337e358870196d79e8edf5888730">printPointF</a>(<span class="keyword">const</span> CvPoint2D32f pt, <span class="keyword">const</span> <span class="keywordtype">char</span> *label)</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;{</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;    <span class="keywordflow">if</span> (label)</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;        std::cout &lt;&lt; label &lt;&lt; <span class="stringliteral">&quot;: &quot;</span>;</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;[Point32f] at (&quot;</span> &lt;&lt; pt.x &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; pt.y &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;}</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;<span class="comment">// Rectangle region functions</span></div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;<span class="comment">// Enlarge or shrink the rectangle size &amp; center by a given scale.</span></div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;<span class="comment">// If w &amp; h are given, will make sure the rectangle stays within the bounds if it is enlarged too much.</span></div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;<span class="comment">// Note that for images, w should be (width-1) and h should be (height-1).</span></div><div class="line"><a name="l01349"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#ae6e3a6315d54d43364c6c91dd9a67b5f"> 1349</a></span>&#160;CvRect <a class="code" href="_image_utils__0_87_8cpp.html#ae6e3a6315d54d43364c6c91dd9a67b5f">scaleRect</a>(<span class="keyword">const</span> CvRect rectIn, <span class="keywordtype">float</span> scaleX, <span class="keywordtype">float</span> scaleY, <span class="keywordtype">int</span> w, <span class="keywordtype">int</span> h)</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;{</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    CvRect rect;</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;    <span class="comment">// Scale the image region position &amp; size</span></div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;    rect.x = cvRound(scaleX * (<span class="keywordtype">float</span>)rectIn.x);</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;    rect.y = cvRound(scaleY * (<span class="keywordtype">float</span>)rectIn.y);</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    rect.width = cvRound(scaleX * (<span class="keywordtype">float</span>)rectIn.width);</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    rect.height = cvRound(scaleY * (<span class="keywordtype">float</span>)rectIn.height);</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;    <span class="comment">// Make sure it doesn&#39;t go outside the image</span></div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;    <span class="keywordflow">if</span> (w &gt; 0 &amp;&amp; h &gt; 0) {</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;        <span class="keywordflow">if</span> (rect.x + rect.width &gt; w)</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;            rect.width = w - rect.x;</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;        <span class="keywordflow">if</span> (rect.y + rect.height &gt; h)</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;            rect.height = h - rect.y;</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;    }</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;    <span class="keywordflow">return</span> rect;</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;}</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;<span class="comment">// Enlarge or shrink the rectangle region by a given scale without moving its center, and possibly add a border around it.</span></div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;<span class="comment">// If w &amp; h are given, will make sure the rectangle stays within the bounds if it is enlarged too much.</span></div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;<span class="comment">// Note that for images, w should be (width-1) and h should be (height-1).</span></div><div class="line"><a name="l01370"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#a674ab35bd234d16291add6869bac2fd1"> 1370</a></span>&#160;CvRect <a class="code" href="_image_utils__0_87_8cpp.html#a674ab35bd234d16291add6869bac2fd1">scaleRectInPlace</a>(<span class="keyword">const</span> CvRect rectIn, <span class="keywordtype">float</span> scaleX, <span class="keywordtype">float</span> scaleY, <span class="keywordtype">float</span> borderX, <span class="keywordtype">float</span> borderY, <span class="keywordtype">int</span> w, <span class="keywordtype">int</span> h)</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;{</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    CvRect rect = rectIn;    <span class="comment">// Make a local copy</span></div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;    <span class="comment">// Scale the image region size and add an extra border to the region size</span></div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;    rect.x -= cvRound((scaleX - 1.0f) * (<span class="keywordtype">float</span>)rect.width * 0.5f + borderX);</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;    rect.y -= cvRound((scaleY - 1.0f) * (<span class="keywordtype">float</span>)rect.height * 0.5f + borderY);</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;    rect.width = cvRound(scaleX * (<span class="keywordtype">float</span>)rect.width + 2.0f * borderX);</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;    rect.height = cvRound(scaleY * (<span class="keywordtype">float</span>)rect.height + 2.0f * borderY);</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;    <span class="comment">// Make sure it doesn&#39;t go outside the image</span></div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;    <span class="keywordflow">if</span> (w &gt; 0 &amp;&amp; h &gt; 0) {</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;        <span class="keywordflow">if</span> (rect.x &lt; 0) {</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;            rect.width += rect.x;    <span class="comment">// shrink the width, since &#39;x&#39; is negative</span></div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;            rect.x = 0;</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;        }</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;        <span class="keywordflow">if</span> (rect.x + rect.width &gt; w)</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;            rect.width = w - rect.x;</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;        <span class="keywordflow">if</span> (rect.y &lt; 0) {</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;            rect.height += rect.y;    <span class="comment">// shrink the height, since &#39;y&#39; is negative</span></div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;            rect.y = 0;</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;        }</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;        <span class="keywordflow">if</span> (rect.y + rect.height &gt; h)</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;            rect.height = h - rect.y;</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    }</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    <span class="keywordflow">return</span> rect;</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;}</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;<span class="comment">// Return a new rect that the same as rectA when shifted by (rectB.x, rectB.y).</span></div><div class="line"><a name="l01397"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#a02e7e13743d3aa4eaf0776c10f629f34"> 1397</a></span>&#160;CvRect <a class="code" href="_image_utils__0_87_8cpp.html#a02e7e13743d3aa4eaf0776c10f629f34">offsetRect</a>(<span class="keyword">const</span> CvRect rectA, <span class="keyword">const</span> CvRect rectB)</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;{</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    CvRect rectC;</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;    rectC.x = rectA.x + rectB.x;</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    rectC.y = rectA.y + rectB.y;</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;    rectC.width = rectA.width;</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    rectC.height = rectA.height;</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;    <span class="keywordflow">return</span> rectC;</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;}</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;<span class="comment">// Return a new rect that the same as rectA when shifted by (pt.x, pt.y).</span></div><div class="line"><a name="l01408"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#a185e4810200f8820f7265cd96ff3b38d"> 1408</a></span>&#160;CvRect <a class="code" href="_image_utils__0_87_8cpp.html#a185e4810200f8820f7265cd96ff3b38d">offsetRectPt</a>(<span class="keyword">const</span> CvRect rectA, <span class="keyword">const</span> CvPoint pt)</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;{</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    CvRect rectC;</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    rectC.x = rectA.x + pt.x;</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    rectC.y = rectA.y + pt.y;</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;    rectC.width = rectA.width;</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    rectC.height = rectA.height;</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    <span class="keywordflow">return</span> rectC;</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;}</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;<span class="comment">// Draw a rectangle around the given object.</span></div><div class="line"><a name="l01419"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#a44a8b76aadafa4df7e7e4d8f04be4c6c"> 1419</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="_image_utils__0_87_8cpp.html#a44a8b76aadafa4df7e7e4d8f04be4c6c">drawRect</a>(IplImage *img, <span class="keyword">const</span> CvRect rect, <span class="keyword">const</span> CvScalar color)</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;{</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    CvPoint p1, p2;</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;    p1.x = rect.x;</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    p1.y = rect.y;</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;    p2.x = min(rect.x + rect.width-1, img-&gt;width-1);    <span class="comment">// Make sure the end-point is within the image</span></div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    p2.y = min(rect.y + rect.height-1, img-&gt;height-1);    <span class="comment">//        &quot;        &quot;        &quot;</span></div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;    cvRectangle(img, p1, p2, color, 1);</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;}</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;<span class="comment">// Draw a filled rectangle around the given object.</span></div><div class="line"><a name="l01429"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#acd59a9dd93ae769d623f63969c65b472"> 1429</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="_image_utils__0_87_8cpp.html#acd59a9dd93ae769d623f63969c65b472">drawRectFilled</a>(IplImage *img, <span class="keyword">const</span> CvRect rect, <span class="keyword">const</span> CvScalar color)</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;{</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    CvPoint p1, p2;</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;    p1.x = rect.x;</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;    p1.y = rect.y;</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;    p2.x = min(rect.x + rect.width-1, img-&gt;width-1);    <span class="comment">// Make sure the end-point is within the image</span></div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;    p2.y = min(rect.y + rect.height-1, img-&gt;height-1);    <span class="comment">//        &quot;        &quot;        &quot;</span></div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    cvRectangle(img, p1, p2, color, CV_FILLED);</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;}</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;<span class="comment">// Draw a crossbar at the given position.</span></div><div class="line"><a name="l01440"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#a359bfe66d2413f7e0f061e6930a529e6"> 1440</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="_image_utils__0_87_8cpp.html#a359bfe66d2413f7e0f061e6930a529e6">drawCross</a>(IplImage *img, <span class="keyword">const</span> CvPoint pt, <span class="keywordtype">int</span> radius, <span class="keyword">const</span> CvScalar color)</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;{</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    CvPoint p1, p2, p3, p4;</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;    <span class="comment">// Make sure the points are within the image</span></div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    p1 = cvPoint( max(pt.x-radius,0),             pt.y );</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;    p2 = cvPoint( min(pt.x+radius,img-&gt;width-1),  pt.y );</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    p3 = cvPoint( pt.x,                           max(pt.y-radius,0) );</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    p4 = cvPoint( pt.x,                           min(pt.y+radius,img-&gt;height-1) );</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;    <span class="comment">// Draw a horizontal line through the given point</span></div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    cvLine(img, p1, p2, color);</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    <span class="comment">// Draw a vertical line through the given point</span></div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;    cvLine(img, p3, p4, color);</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;}</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;<span class="comment">// Print the label and then the rect to the console for easy debugging</span></div><div class="line"><a name="l01455"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#a8db18c00cae6a0edc0eee50e614634ee"> 1455</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="_image_utils__0_87_8cpp.html#a8db18c00cae6a0edc0eee50e614634ee">printRect</a>(<span class="keyword">const</span> CvRect rect, <span class="keyword">const</span> <span class="keywordtype">char</span> *label)</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;{</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    <span class="keywordflow">if</span> (label)</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;        std::cout &lt;&lt; label &lt;&lt; <span class="stringliteral">&quot;: &quot;</span>;</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;[Rect] at (&quot;</span> &lt;&lt; rect.x &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; rect.y &lt;&lt; <span class="stringliteral">&quot;) of size &quot;</span> &lt;&lt; rect.width &lt;&lt; <span class="stringliteral">&quot;x&quot;</span> &lt;&lt; rect.height &lt;&lt;</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;        <span class="stringliteral">&quot;, where bottom-right corner is at (&quot;</span> &lt;&lt; (rect.x + rect.width-1) &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; (rect.y + rect.height-1) &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;}</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;<span class="comment">// Make sure the given rectangle is completely within the given image dimensions.</span></div><div class="line"><a name="l01464"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#a40990a9cb5e6b4e8dee6e58ac3895057"> 1464</a></span>&#160;CvRect <a class="code" href="_image_utils__0_87_8cpp.html#a40990a9cb5e6b4e8dee6e58ac3895057">cropRect</a>(<span class="keyword">const</span> CvRect rectIn, <span class="keywordtype">int</span> w, <span class="keywordtype">int</span> h)</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;{</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    CvRect roi = CvRect(rectIn);</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    <span class="comment">// Make sure the displayed image is within the viewing dimensions</span></div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;    <span class="keywordflow">if</span> (roi.x + roi.width &gt; w)    <span class="comment">// Limit the bottom-right from past the image</span></div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;        roi.width = w - roi.x;</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    <span class="keywordflow">if</span> (roi.y + roi.height &gt; h)</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;        roi.height = h - roi.y;</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;    <span class="keywordflow">if</span> (roi.x &lt; 0)                <span class="comment">// Limit the top-left from before the image</span></div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;        roi.x = 0;</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    <span class="keywordflow">if</span> (roi.y &lt; 0)</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;        roi.y = 0;</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;    <span class="keywordflow">if</span> (roi.x &gt; w-1)            <span class="comment">// Limit the top-left from after the image</span></div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;        roi.x = w-1;</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;    <span class="keywordflow">if</span> (roi.y &gt; h-1)</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;        roi.y = h-1;</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;    <span class="keywordflow">if</span> (roi.width &lt; 0)            <span class="comment">// Limit the negative sizes</span></div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;        roi.width = 0;</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    <span class="keywordflow">if</span> (roi.height &lt; 0)</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;        roi.height = 0;</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    <span class="keywordflow">if</span> (roi.width &gt; w)            <span class="comment">// Limit the large sizes</span></div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;        roi.width = w - roi.x;</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;    <span class="keywordflow">if</span> (roi.height &gt; h)</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;        roi.height = h - roi.y;</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    <span class="keywordflow">return</span> roi;</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;}</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;<span class="comment">// Image transforming functions</span></div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;<span class="comment">// Returns a new image that is a cropped version of the original image.</span></div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;<span class="comment">IplImage* slow_cropImage(const IplImage *img, const CvRect region)</span></div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;<span class="comment">{</span></div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;<span class="comment">    IplImage *imageTmp,*imageRGB;</span></div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;<span class="comment">    CvSize size;</span></div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;<span class="comment">    size.height = img-&gt;height;</span></div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;<span class="comment">    size.width = img-&gt; width;</span></div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;<span class="comment">    if (img-&gt;width &lt;= 0 || img-&gt;height &lt;= 0 || region.width &lt;= 0 || region.height &lt;= 0) {</span></div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;<span class="comment">        std::cerr &lt;&lt; &quot;ERROR in cropImage(): dimensions of image or region are invalid.&quot; &lt;&lt; endl;</span></div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;<span class="comment">        printRect(region, &quot;crop region&quot;);</span></div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;<span class="comment">        printImageInfo(img, &quot;crop image&quot;);</span></div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;<span class="comment">        exit(1);</span></div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;<span class="comment">    }</span></div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;<span class="comment">    if (img-&gt;depth != IPL_DEPTH_8U) {</span></div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;<span class="comment">        std::cerr &lt;&lt; &quot;ERROR in cropImage(): Unknown image depth of &quot; &lt;&lt; img-&gt;depth &lt;&lt; &quot; given instead of 8.&quot; &lt;&lt; std::endl;</span></div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;<span class="comment">        exit(1);</span></div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;<span class="comment">    }</span></div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;<span class="comment">    // First create a new (color or greyscale) IPL Image and copy contents of img into it.</span></div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;<span class="comment">    imageTmp = cvCreateImage(size, IPL_DEPTH_8U, img-&gt;nChannels);</span></div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;<span class="comment">    cvCopy(img, imageTmp);</span></div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;<span class="comment">    // Create a new image of the detected region</span></div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;<span class="comment">    //printf(&quot;Cropping image at x = %d, y = %d...&quot;, faces[i].x, faces[i].y);</span></div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;<span class="comment">    //printf(&quot;Setting region of interest...&quot;);</span></div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;<span class="comment">    // Make sure the crop region is completely within the image region.</span></div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;<span class="comment">    //cropRegion = cropRect(cropRegion, size.width-1, size.height-1);    // Make sure it fits within (0,0) and (w,h)</span></div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;<span class="comment">    // Set the region of interest to that surrounding the face.</span></div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;<span class="comment">    cvSetImageROI(imageTmp, region);</span></div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;<span class="comment">    // Copy region of interest (i.e. face) into a new iplImage (imageRGB) and return it</span></div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;<span class="comment">    size.width = region.width;</span></div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;<span class="comment">    size.height = region.height;</span></div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;<span class="comment">    imageRGB = cvCreateImage(size, IPL_DEPTH_8U, img-&gt;nChannels);</span></div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;<span class="comment">    cvCopy(imageTmp, imageRGB);    // Copy just the region.</span></div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;<span class="comment">    cvReleaseImage( &amp;imageTmp );</span></div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;<span class="comment">    return imageRGB;</span></div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;<span class="comment">}</span></div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;<span class="comment">// Returns a new image that is a cropped version (rectangular cut-out) of the original image.</span></div><div class="line"><a name="l01541"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#a0bb8ac7243cbe0dbed1514f24e009adf"> 1541</a></span>&#160;IplImage* <a class="code" href="_image_utils__0_87_8cpp.html#a0bb8ac7243cbe0dbed1514f24e009adf">cropImage</a>(<span class="keyword">const</span> IplImage *img, <span class="keyword">const</span> CvRect region)</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;{</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;    IplImage *imageCropped;</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    CvSize size;</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;    <span class="keywordflow">if</span> (img-&gt;width &lt;= 0 || img-&gt;height &lt;= 0 || region.width &lt;= 0 || region.height &lt;= 0) {</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;        LOG(<span class="stringliteral">&quot;ERROR in cropImage(): dimensions of image or region are invalid.&quot;</span>);</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;        <a class="code" href="_image_utils__0_87_8cpp.html#a8db18c00cae6a0edc0eee50e614634ee">printRect</a>(region, <span class="stringliteral">&quot;crop region&quot;</span>);</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;        <a class="code" href="_image_utils__0_87_8cpp.html#a71e1a1379805788f090639ddc8bc046c">printImageInfo</a>(img, <span class="stringliteral">&quot;crop image&quot;</span>);</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;        exit(1);</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;    }</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;    <span class="comment">// Set the desired region of interest.</span></div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;    cvSetImageROI((IplImage*)img, region);</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;    <span class="comment">// Copy region of interest into a new iplImage and return it</span></div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;    size.width = region.width;</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;    size.height = region.height;</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;    imageCropped = cvCreateImage(size, img-&gt;depth, img-&gt;nChannels);</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;    cvCopy(img, imageCropped);    <span class="comment">// Copy just the region.</span></div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;    cvResetImageROI((IplImage*)img);</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;    <span class="keywordflow">return</span> imageCropped;</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;}</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;<span class="comment">// Creates a new image copy that is of a desired size. The aspect ratio will be kept constant if &#39;keepAspectRatio&#39; is true,</span></div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;<span class="comment">// by cropping undesired parts so that only pixels of the original image are shown, instead of adding extra blank space.</span></div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;<span class="comment">// Remember to free the new image later.</span></div><div class="line"><a name="l01568"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#ada6eb2b9ef6c2ce92a5119ad1568ca26"> 1568</a></span>&#160;IplImage* <a class="code" href="_image_utils__0_87_8cpp.html#ada6eb2b9ef6c2ce92a5119ad1568ca26">resizeImage</a>(<span class="keyword">const</span> IplImage *origImg, <span class="keywordtype">int</span> newWidth, <span class="keywordtype">int</span> newHeight, <span class="keywordtype">bool</span> keepAspectRatio)</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;{</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;    IplImage *outImg = 0;</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;    <span class="keywordtype">int</span> origWidth = 1;</div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;    <span class="keywordtype">int</span> origHeight = 1;</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;    <span class="keywordflow">if</span> (origImg) {</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;        origWidth = origImg-&gt;width;</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;        origHeight = origImg-&gt;height;</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;    }</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;    <span class="keywordflow">if</span> (newWidth &lt;= 0 || newHeight &lt;= 0 || origImg == 0 || origWidth &lt;= 0 || origHeight &lt;= 0) {</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;        std::cerr &lt;&lt; <span class="stringliteral">&quot;ERROR: Bad desired image size of &quot;</span> &lt;&lt; newWidth &lt;&lt; <span class="stringliteral">&quot;x&quot;</span> &lt;&lt; newHeight &lt;&lt; <span class="stringliteral">&quot; in resizeImage().\n&quot;</span>;</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;        <span class="keywordflow">if</span> (origImg)</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;            std::cerr &lt;&lt; <span class="stringliteral">&quot;Image was &quot;</span> &lt;&lt; origImg-&gt;width &lt;&lt; <span class="stringliteral">&quot;x&quot;</span> &lt;&lt; origImg-&gt;height &lt;&lt; endl;</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;        exit(1);</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;    }</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;    <span class="keywordflow">if</span> (keepAspectRatio) {</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;        <span class="comment">//cerr &lt;&lt; &quot;ResizeImage :&quot; &lt;&lt; origWidth &lt;&lt; &quot;x&quot; &lt;&lt; origHeight &lt;&lt; &quot; -&gt; &quot; &lt;&lt; newWidth &lt;&lt; &quot;x&quot; &lt;&lt; newHeight &lt;&lt; &quot; (rOld&quot; &lt;&lt; (origWidth / (float)origHeight) &lt;&lt; &quot;, rNew&quot; &lt;&lt; (newWidth / (float)newHeight) &lt;&lt; endl;</span></div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;        <span class="comment">// Resize the image without changing its aspect ratio, by cropping off the edges and enlarging the middle section.</span></div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;        CvRect <a class="code" href="process__1_8m.html#afa522382c3fac96d0f07658ea5d69adc">r</a>;</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;        <span class="keywordtype">float</span> origAspect = (origWidth / (float)origHeight);    <span class="comment">// input aspect ratio</span></div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;        <span class="keywordtype">float</span> newAspect = (newWidth / (float)newHeight);    <span class="comment">// output aspect ratio</span></div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;        <span class="keywordflow">if</span> (origAspect &gt; newAspect) {    <span class="comment">// crop width to be origHeight * newAspect</span></div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;            <span class="keywordtype">int</span> tw = (origHeight * newWidth) / newHeight;</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;            r = cvRect((origWidth - tw)/2, 0, tw, origHeight);</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;        }</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;        <span class="keywordflow">else</span> {    <span class="comment">// crop height to be origWidth / newAspect</span></div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;            <span class="keywordtype">int</span> th = (origWidth * newHeight) / newWidth;</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;            r = cvRect(0, (origHeight - th)/2, origWidth, th);</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;        }</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;        <span class="comment">//cerr &lt;&lt; &quot;cropping image to (&quot; &lt;&lt; r.width &lt;&lt; &quot;x&quot; &lt;&lt; r.height &lt;&lt; &quot; at (&quot; &lt;&lt; r.x &lt;&lt; &quot;,&quot; &lt;&lt; r.y &lt;&lt; &quot;).&quot; &lt;&lt; endl;</span></div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;        IplImage *croppedImg = <a class="code" href="_image_utils__0_87_8cpp.html#a0bb8ac7243cbe0dbed1514f24e009adf">cropImage</a>(origImg, r);</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;        <span class="comment">// Call this function again, but with the new aspect ratio image.</span></div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;        <span class="comment">//cerr &lt;&lt; &quot;calling resizeImage(&quot; &lt;&lt; newWidth &lt;&lt; &quot;,&quot; &lt;&lt; newHeight &lt;&lt; &quot;false)&quot; &lt;&lt; endl;</span></div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;        outImg = <a class="code" href="_image_utils__0_87_8cpp.html#ada6eb2b9ef6c2ce92a5119ad1568ca26">resizeImage</a>(croppedImg, newWidth, newHeight, <span class="keyword">false</span>);    <span class="comment">// do a scaled image resize, since the aspect ratio is correct now.</span></div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;        cvReleaseImage( &amp;croppedImg );</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;    }</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;        <span class="comment">// Scale the image to the new dimensions, even if the aspect ratio will be changed.</span></div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;        outImg = cvCreateImage(cvSize(newWidth, newHeight), origImg-&gt;depth, origImg-&gt;nChannels);</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;        <span class="keywordflow">if</span> (newWidth &gt; origImg-&gt;width &amp;&amp; newHeight &gt; origImg-&gt;height) {</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;            <span class="comment">// Make the image larger</span></div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;            <span class="comment">//printf(&quot;Making the image larger\n&quot;); fflush(stdout);</span></div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;            cvResetImageROI((IplImage*)origImg);</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;            cvResize(origImg, outImg, CV_INTER_LINEAR);    <span class="comment">// CV_INTER_CUBIC or CV_INTER_LINEAR is good for enlarging</span></div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;        }</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;        <span class="keywordflow">else</span> {</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;            <span class="comment">// Make the image smaller</span></div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;            <span class="comment">//printf(&quot;Making the image smaller\n&quot;); fflush(stdout);</span></div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;            cvResetImageROI((IplImage*)origImg);</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;            cvResize(origImg, outImg, CV_INTER_AREA);    <span class="comment">// CV_INTER_AREA is good for shrinking / decimation, but bad at enlarging.</span></div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;        }</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;    }</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;    <span class="keywordflow">return</span> outImg;</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;}</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;<span class="comment">// Rotate the image clockwise and possibly scale the image. Use &#39;mapRotatedImagePoint()&#39; to map pixels from the src to dst image.</span></div><div class="line"><a name="l01628"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#ab20516caeb7081b61ca8f92f61731aff"> 1628</a></span>&#160;IplImage *<a class="code" href="_image_utils__0_87_8cpp.html#ab20516caeb7081b61ca8f92f61731aff">rotateImage</a>(<span class="keyword">const</span> IplImage *src, <span class="keywordtype">float</span> angleDegrees, <span class="keywordtype">float</span> scale)</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;{</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;    <span class="comment">// Create a map_matrix, where the left 2x2 matrix is the transform and the right 2x1 is the dimensions.</span></div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;    <span class="keywordtype">float</span> m[6];</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;    CvMat M = cvMat(2, 3, CV_32F, m);</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    <span class="keywordtype">int</span> w = src-&gt;width;</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    <span class="keywordtype">int</span> h = src-&gt;height;</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;</div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;    <span class="keywordtype">float</span> divscale = 1.0f;</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;    <span class="keywordflow">if</span> (scale != 1.0f &amp;&amp; scale &gt; 1e-20)</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;        divscale = 1.0f / scale;</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;    <span class="keywordtype">float</span> angleRadians = angleDegrees * ((float)CV_PI / 180.0f);</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;    m[0] = (float)(cos(angleRadians) * divscale);</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;    m[1] = (float)(sin(angleRadians) * divscale);</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;    m[3] = -m[1];</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;    m[4] = m[0];</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;    m[2] = w*0.5f;</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;    m[5] = h*0.5f;</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;    <span class="comment">// Make a spare image for the result</span></div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;    CvSize sizeRotated;</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;    sizeRotated.width = cvRound(scale * w);</div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;    sizeRotated.height = cvRound(scale * h);</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;    <span class="comment">// Rotate and scale</span></div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;    IplImage *imageRotated = cvCreateImage( sizeRotated, src-&gt;depth, src-&gt;nChannels );</div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;    <span class="comment">// Transform the image</span></div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;    cvGetQuadrangleSubPix( src, imageRotated, &amp;M);</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    <span class="keywordflow">return</span> imageRotated;</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;}</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;<span class="comment">// Get the position of a pixel in the image after the rotateImage() operation.</span></div><div class="line"><a name="l01662"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#a4d4054bce7b2974bf7523a3d0b3e956f"> 1662</a></span>&#160;CvPoint2D32f <a class="code" href="_image_utils__0_87_8cpp.html#a4d4054bce7b2974bf7523a3d0b3e956f">mapRotatedImagePoint</a>(<span class="keyword">const</span> CvPoint2D32f pointOrig, <span class="keyword">const</span> IplImage *image, <span class="keywordtype">float</span> angleDegrees, <span class="keywordtype">float</span> scale)</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;{</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;    <span class="comment">// Get the old image center.</span></div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;    CvPoint2D32f ptImageCenterOrig = cvPoint2D32f(image-&gt;width / 2.0f, image-&gt;height / 2.0f);</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;    <span class="comment">// Get the new image center (after the rotation &amp; scale that was performed to the image by &#39;rotateImage()&#39;).</span></div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;    CvPoint2D32f ptImageCenterNew = <a class="code" href="_image_utils__0_87_8cpp.html#a8b339c1ee055e4bb597facdca87fa2dd">scalePointF</a>(ptImageCenterOrig, scale);</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;    <span class="comment">// Get the relative coords of the point</span></div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;    CvPoint2D32f relPOrig = <a class="code" href="_image_utils__0_87_8cpp.html#aa556e96a0166fda3abbfb7a3abff48f6">subtractPointF</a>(pointOrig, ptImageCenterOrig);    <span class="comment">// relative coords</span></div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;    <span class="comment">// Rotate &amp; scale the relative coords of the point</span></div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;    CvPoint2D32f relPNew = <a class="code" href="_image_utils__0_87_8cpp.html#a6ffabb9779799c3b41af29bb58ac8e9a">rotatePointF</a>(relPOrig, angleDegrees);</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;    relPNew = <a class="code" href="_image_utils__0_87_8cpp.html#a8b339c1ee055e4bb597facdca87fa2dd">scalePointF</a>(relPNew, scale);</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;    <span class="comment">// Get the absolute coords of the new point</span></div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    CvPoint2D32f ptPNew = <a class="code" href="_image_utils__0_87_8cpp.html#a9271a93dd613180f6fd8ce77bb639494">addPointF</a>(relPNew, ptImageCenterNew);</div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;    <span class="keywordflow">return</span> ptPNew;</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;}</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;<span class="comment">// Image utility functions</span></div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;<span class="comment">//------------------------------------------------------------------------------</span></div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;<span class="comment">// Do Bilateral Filtering to smooth the image noise but preserve the edges.</span></div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;<span class="comment">// A smoothness of 5 is very little filtering, and 100 is very high filtering.</span></div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;<span class="comment">// Remember to free the returned image.</span></div><div class="line"><a name="l01685"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#a90c1506df91b35572789b2ef19049ed1"> 1685</a></span>&#160;IplImage* <a class="code" href="_image_utils__0_87_8cpp.html#a90c1506df91b35572789b2ef19049ed1">smoothImageBilateral</a>(<span class="keyword">const</span> IplImage *src, <span class="keywordtype">float</span> smoothness)</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;{</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    IplImage *imageSmooth = cvCreateImage(cvGetSize(src), src-&gt;depth, src-&gt;nChannels);</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    IplImage *imageOut = cvCreateImage(cvGetSize(src), src-&gt;depth, src-&gt;nChannels);</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    <span class="comment">// Do bilateral fitering on the input image</span></div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;    cvSmooth( src, imageSmooth, CV_BILATERAL, 5, 5, smoothness, smoothness );</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;    <span class="comment">// Mix the smoothed image with the original image</span></div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;    cvAddWeighted( src, 0.70, imageSmooth, 0.70, 0.0, imageOut );</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;    <span class="comment">//saveImage(&quot;bilatA.png&quot;, src);</span></div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;    <span class="comment">//saveImage(&quot;bilatB.png&quot;, imageSmooth);</span></div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;    <span class="comment">//saveImage(&quot;bilatC.png&quot;, imageOut);</span></div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;    cvReleaseImage(&amp;imageSmooth);</div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;    <span class="keywordflow">return</span> imageOut;</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;}</div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;</div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;<span class="comment">// Paste multiple images next to each other as a single image, for saving or displaying.</span></div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;<span class="comment">// Remember to free the returned image.</span></div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;<span class="comment">// Sample usage: cvSaveImage(&quot;out.png&quot;, combineImages(2, img1, img2) );</span></div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;<span class="comment">// Modified by Shervin from the cvShowManyImages() function on the OpenCVWiki by Parameswaran.</span></div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;<span class="comment">// &#39;combineImagesResized()&#39; will resize all images to 300x300, whereas &#39;combineImages()&#39; doesn&#39;t resize the images at all.</span></div><div class="line"><a name="l01708"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#a6d5d1fabb4bbdde9c279c4f0280ddf62"> 1708</a></span>&#160;IplImage* <a class="code" href="_image_utils__0_87_8cpp.html#a6d5d1fabb4bbdde9c279c4f0280ddf62">combineImagesResized</a>(<span class="keywordtype">int</span> nArgs, ...)</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;{</div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;    <span class="comment">// img - Used for getting the arguments</span></div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;    IplImage *img;</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;    <span class="comment">// DispImage - the image in which input images are to be copied</span></div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;    IplImage *DispImage;</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;    <span class="keywordtype">int</span> size;</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>;</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;    <span class="keywordtype">int</span> m, n;</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="_p_d_8m.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a>, y;</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;    <span class="comment">// w - Maximum number of images in a row</span></div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;    <span class="comment">// h - Maximum number of images in a column</span></div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;    <span class="keywordtype">int</span> w, h;</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;    <span class="comment">// scale - How much we have to resize the image</span></div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;    <span class="keywordtype">float</span> scale;</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;    <span class="keywordtype">int</span> max;</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;    <span class="comment">// If the number of arguments is lesser than 0 or greater than 12</span></div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;    <span class="comment">// return without displaying</span></div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;    <span class="keywordflow">if</span>(nArgs &lt;= 0) {</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;        printf(<span class="stringliteral">&quot;Number of arguments too small....\n&quot;</span>);</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;        <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;    }</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(nArgs &gt; 12) {</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;        printf(<span class="stringliteral">&quot;Number of arguments too large....\n&quot;</span>);</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;        <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;    }</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    <span class="comment">// Determine the size of the image,</span></div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;    <span class="comment">// and the number of rows/cols</span></div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;    <span class="comment">// from number of arguments</span></div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nArgs == 1) {</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;        w = h = 1;</div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;        size = 300;</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;    }</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nArgs == 2) {</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;        w = 2; h = 1;</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;        size = 300;</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;    }</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nArgs == 3 || nArgs == 4) {</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;        w = 2; h = 2;</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;        size = 300;</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;    }</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nArgs == 5 || nArgs == 6) {</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;        w = 3; h = 2;</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;        size = 200;</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;    }</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nArgs == 7 || nArgs == 8) {</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;        w = 4; h = 2;</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;        size = 200;</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;    }</div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;        w = 4; h = 3;</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;        size = 150;</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;    }</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;    <span class="comment">// Create a new 3 channel image</span></div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;    DispImage = cvCreateImage( cvSize(100 + size*w, 60 + size*h), 8, 3 );</div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;</div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;    <span class="comment">// Used to get the arguments passed</span></div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;    va_list args;</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;    va_start(args, nArgs);</div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;    <span class="comment">// Loop for nArgs number of arguments</span></div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;    <span class="keywordflow">for</span> (i = 0, m = 20, n = 20; i &lt; nArgs; i++, m += (20 + size)) {</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;        <span class="comment">// Get the Pointer to the IplImage</span></div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;        img = va_arg(args, IplImage*);</div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;</div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;        <span class="comment">// Make sure a proper image has been obtained</span></div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;        <span class="keywordflow">if</span>(img) {</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;            <span class="comment">// Find the width and height of the image</span></div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;            x = img-&gt;width;</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;            y = img-&gt;height;</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;</div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;            <span class="comment">// Find whether height or width is greater in order to resize the image</span></div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;            max = (x &gt; y)? x: y;</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;</div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;            <span class="comment">// Find the scaling factor to resize the image</span></div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;            scale = (float) ( (<span class="keywordtype">float</span>) max / size );</div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;            <span class="comment">// Used to Align the images</span></div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;            <span class="keywordflow">if</span>( i % w == 0 &amp;&amp; m!= 20) {</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;                m = 20;</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;                n+= 20 + size;</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;            }</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;            <span class="comment">// Make sure we have a color image. If its greyscale, then convert it to color.</span></div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;            IplImage *colorImg = 0;</div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;            IplImage *currImg = img;</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;            <span class="keywordflow">if</span> (img-&gt;nChannels == 1) {</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;                colorImg = cvCreateImage(cvSize(img-&gt;width, img-&gt;height), 8, 3 );</div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;                <span class="comment">//std::cout &lt;&lt; &quot;[Converting greyscale image &quot; &lt;&lt; greyImg-&gt;width &lt;&lt; &quot;x&quot; &lt;&lt; greyImg-&gt;height &lt;&lt; &quot;px to color for combineImages()]&quot; &lt;&lt; std::endl;</span></div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;                cvCvtColor( img, colorImg, CV_GRAY2BGR );</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;                currImg = colorImg;    <span class="comment">// Use the greyscale version as the input.</span></div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;            }</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;</div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;            <span class="comment">// Set the image ROI to display the current image</span></div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;            cvSetImageROI(DispImage, cvRect(m, n, (<span class="keywordtype">int</span>)( x/scale ), (<span class="keywordtype">int</span>)( y/scale )));</div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;            <span class="comment">// Resize the input image and copy it to the Single Big Image</span></div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;            cvResize(currImg, DispImage, CV_INTER_CUBIC);</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;</div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;            <span class="comment">// Reset the ROI in order to display the next image</span></div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;            cvResetImageROI(DispImage);</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;</div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;            <span class="keywordflow">if</span> (colorImg)</div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;                cvReleaseImage(&amp;colorImg);</div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;        }</div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;        <span class="keywordflow">else</span> {    <span class="comment">// This input image is NULL</span></div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;            <span class="comment">//printf(&quot;Error in combineImages(): Bad image%d given as argument\n&quot;, i);</span></div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;            <span class="comment">//cvReleaseImage(&amp;DispImage);    // Release the image and return</span></div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;            <span class="comment">//return NULL;</span></div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;        }</div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;    }</div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;</div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;    <span class="comment">// End the number of arguments</span></div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;    va_end(args);</div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;</div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;    <span class="keywordflow">return</span> DispImage;</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;}</div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;</div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;</div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;</div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;<span class="comment">// Paste multiple images next to each other as a single image, for saving or displaying.</span></div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;<span class="comment">// Remember to free the returned image.</span></div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;<span class="comment">// Sample usage: cvSaveImage(&quot;out.png&quot;, combineImages(2, img1, img2) );</span></div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;<span class="comment">// Modified by Shervin from the cvShowManyImages() function on the OpenCVWiki by Parameswaran.</span></div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;<span class="comment">// &#39;combineImagesResized()&#39; will resize all images to 300x300, whereas &#39;combineImages()&#39; doesn&#39;t resize the images at all.</span></div><div class="line"><a name="l01841"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#ae69519b4e45351bf4eb791a53d4a6690"> 1841</a></span>&#160;IplImage* <a class="code" href="_image_utils__0_87_8cpp.html#ae69519b4e45351bf4eb791a53d4a6690">combineImages</a>(<span class="keywordtype">int</span> nArgs, ...)</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;{</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> MAX_COMBINED_IMAGES = 6;</div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;    <span class="keywordtype">int</span> col1Width, col2Width;</div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;    <span class="keywordtype">int</span> row1Height, row2Height, row3Height;</div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;    IplImage *imageArray[MAX_COMBINED_IMAGES];</div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;    <span class="keywordtype">int</span> xPos[MAX_COMBINED_IMAGES];</div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;    <span class="keywordtype">int</span> yPos[MAX_COMBINED_IMAGES];</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;    <span class="keywordtype">int</span> wImg[MAX_COMBINED_IMAGES] = {0};    <span class="comment">// image dimensions are assumed to be 0, if they dont exist.</span></div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;    <span class="keywordtype">int</span> hImg[MAX_COMBINED_IMAGES] = {0};</div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;    <span class="comment">//int rows, columns;        // number of rows &amp; cols of images.</span></div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;    <span class="keywordtype">int</span> wP, hP;                <span class="comment">// dimensions of the combined image.</span></div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>;</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;    <span class="keywordtype">int</span> nGoodImages = 0;</div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;    IplImage *combinedImage;</div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;    <span class="keywordtype">int</span> B = 5;        <span class="comment">// Border size, in pixels</span></div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;</div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;    <span class="comment">// Load all the images that were passed as arguments</span></div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;    va_list args;    <span class="comment">// Used to get the arguments passed</span></div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;    va_start(args, nArgs);</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; nArgs; i++)    {</div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;        <span class="comment">// Get the Pointer to the IplImage</span></div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;        IplImage *img = va_arg(args, IplImage*);</div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;        <span class="comment">// Make sure a proper image has been obtained, and that there aren&#39;t too many images already.</span></div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;        <span class="keywordflow">if</span> ((img != 0 &amp;&amp; img-&gt;width &gt; 0 &amp;&amp; img-&gt;height &gt; 0) &amp;&amp; (nGoodImages &lt; MAX_COMBINED_IMAGES) ) {</div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;            <span class="comment">// Add the new image to the array of images</span></div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;            imageArray[nGoodImages] = img;</div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;            wImg[nGoodImages] = img-&gt;width;</div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;            hImg[nGoodImages] = img-&gt;height;</div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;            nGoodImages++;</div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;        }</div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;    }</div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;</div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;    <span class="comment">// If the number of arguments is lesser than 0 or greater than 12,</span></div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;    <span class="comment">// return without displaying</span></div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;    <span class="keywordflow">if</span>( nGoodImages &lt;= 0 || nGoodImages &gt; MAX_COMBINED_IMAGES ) {</div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;        printf(<span class="stringliteral">&quot;Error in combineImages(): Cant display %d of %d images\n&quot;</span>, nGoodImages, nArgs);</div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;        <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;    }</div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;</div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;    <span class="comment">// Determine the size of the combined image &amp; number of rows/cols.</span></div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;    <span class="comment">//columns = MIN(nGoodImages, 2);    // 1 or 2 columns</span></div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;    <span class="comment">//rows = (nGoodImages-1) / 2;        // 1 or 2 or 3 or ... rows</span></div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;    col1Width = MAX(wImg[0], MAX(wImg[2], wImg[4]));</div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;    col2Width = MAX(wImg[1], MAX(wImg[3], wImg[5]));</div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;    row1Height = MAX(hImg[0], hImg[1]);</div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;    row2Height = MAX(hImg[2], hImg[3]);</div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;    row3Height = MAX(hImg[4], hImg[5]);</div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;    wP = B + col1Width + B + (col2Width ? col2Width + B : 0);</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;    hP = B + row1Height + B + (row2Height ? row2Height + B : 0) + (row3Height ? row3Height + B : 0);</div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;    xPos[0] = B;</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;    yPos[0] = B;</div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;    xPos[1] = B + col1Width + B;</div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;    yPos[1] = B;</div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;    xPos[2] = B;</div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;    yPos[2] = B + row1Height + B;</div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;    xPos[3] = B + col1Width + B;</div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;    yPos[3] = B + row1Height + B;</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;    xPos[4] = B;</div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;    yPos[4] = B + row1Height + B + row2Height + B;</div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;    xPos[5] = B + col1Width + B;</div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;    yPos[5] = B + row1Height + B + row2Height + B;</div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;</div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;    <span class="comment">// Create a new RGB image</span></div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;    combinedImage = cvCreateImage( cvSize(wP, hP), 8, 3 );</div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;    <span class="keywordflow">if</span> (!combinedImage)</div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;        <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;    <span class="comment">// Clear the background</span></div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;    cvSet(combinedImage, cvScalar(50,50,50,0));</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;    <span class="keywordflow">for</span> (i=0; i &lt; nGoodImages; i++) {</div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;        IplImage *img = imageArray[<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>];</div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;</div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;        <span class="comment">// Make sure we have a color image. If its greyscale, then convert it to color.</span></div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;        IplImage *colorImg = 0;</div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;        <span class="keywordflow">if</span> (img-&gt;nChannels == 1) {</div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;            colorImg = cvCreateImage(cvSize(img-&gt;width, img-&gt;height), 8, 3 );</div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;            cvCvtColor( img, colorImg, CV_GRAY2BGR );</div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;            img = colorImg;    <span class="comment">// Use the greyscale version as the input.</span></div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;        }</div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;</div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;        <span class="comment">// Set the image ROI to display the current image</span></div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;        cvSetImageROI(combinedImage, cvRect(xPos[i], yPos[i], img-&gt;width, img-&gt;height));</div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;        <span class="comment">// Draw this image into its position</span></div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;        cvCopy(img, combinedImage);</div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;        <span class="comment">// Reset the ROI in order to display the next image</span></div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;        cvResetImageROI(combinedImage);</div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;</div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;        <span class="keywordflow">if</span> (colorImg)</div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;            cvReleaseImage(&amp;colorImg);</div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;    }</div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;</div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;    <span class="comment">// End the number of arguments</span></div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;    va_end(args);</div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;</div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;    <span class="keywordflow">return</span> combinedImage;</div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;}</div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;</div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;</div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;<span class="comment">// Blend color images &#39;image1&#39; and &#39;image2&#39; using an 8-bit alpha-blending mask channel.</span></div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;<span class="comment">// Equivalent to this operation on each pixel: imageOut = image1 * (1-(imageAlphaMask/255)) + image2 * (imageAlphaMask/255)</span></div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;<span class="comment">// So if a pixel in imageAlphMask is 0, then that pixel in imageOut will be image1, or if imageAlphaMask is 255 then imageOut is image2,</span></div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;<span class="comment">// or if imageAlphaMask was 200 then imageOut would be: image1 * 0.78 + image2 * 0.22</span></div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;<span class="comment">// Returns a new image, so remember to call &#39;cvReleaseImage()&#39; on the result.</span></div><div class="line"><a name="l01946"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#a3ce62ba8ec55fc1637f53a05ed1b0cd3"> 1946</a></span>&#160;IplImage* <a class="code" href="_image_utils__0_87_8cpp.html#a3ce62ba8ec55fc1637f53a05ed1b0cd3">blendImage</a>(<span class="keyword">const</span> IplImage* image1, <span class="keyword">const</span> IplImage* image2, <span class="keyword">const</span> IplImage* imageAlphaMask)</div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;{</div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;    <span class="comment">// Make sure that image1 &amp; image2 are RGB UCHAR images, and imageAlphaMask is an 8-bit UCHAR image.</span></div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;    <span class="keywordflow">if</span> (!image1 || image1-&gt;width &lt;= 0 || image1-&gt;height &lt;= 0 || image1-&gt;depth != 8 || image1-&gt;nChannels != 3) {</div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Error in blendImage(): Bad parameter &#39;image1&#39;.&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;        <a class="code" href="_image_utils__0_87_8cpp.html#a71e1a1379805788f090639ddc8bc046c">printImageInfo</a>(image1, <span class="stringliteral">&quot;image1&quot;</span>);</div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;        <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;    }</div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;    <span class="keywordflow">if</span> (!image2 || image2-&gt;width &lt;= 0 || image2-&gt;height &lt;= 0 || image2-&gt;depth != 8 || image2-&gt;nChannels != 3) {</div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Error in blendImage(): Bad parameter &#39;image2&#39;.&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;        <a class="code" href="_image_utils__0_87_8cpp.html#a71e1a1379805788f090639ddc8bc046c">printImageInfo</a>(image2, <span class="stringliteral">&quot;image2&quot;</span>);</div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;        <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;    }</div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;    <span class="keywordflow">if</span> (!imageAlphaMask || imageAlphaMask-&gt;width &lt;= 0 || imageAlphaMask-&gt;height &lt;= 0 || imageAlphaMask-&gt;depth != 8 || imageAlphaMask-&gt;nChannels != 1) {</div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Error in blendImage(): Bad parameter &#39;imageAlphaMask&#39;.&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;        <a class="code" href="_image_utils__0_87_8cpp.html#a71e1a1379805788f090639ddc8bc046c">printImageInfo</a>(imageAlphaMask, <span class="stringliteral">&quot;imageAlphaMask&quot;</span>);</div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;        <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;    }</div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;    <span class="comment">// Make sure that image1 &amp; image2 &amp; imageAlphaMask are all the same dimensions</span></div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;    <span class="keywordflow">if</span> ( (image1-&gt;width != image2-&gt;width || image1-&gt;width != imageAlphaMask-&gt;width) ||</div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;         (image1-&gt;height != image2-&gt;height || image1-&gt;height != imageAlphaMask-&gt;height) ) {</div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;        std::cout &lt;&lt; <span class="stringliteral">&quot;Error in blendImage(): Input images aren&#39;t the same dimensions.&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;        <a class="code" href="_image_utils__0_87_8cpp.html#a71e1a1379805788f090639ddc8bc046c">printImageInfo</a>(image1, <span class="stringliteral">&quot;image1&quot;</span>);</div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;        <a class="code" href="_image_utils__0_87_8cpp.html#a71e1a1379805788f090639ddc8bc046c">printImageInfo</a>(image2, <span class="stringliteral">&quot;image2&quot;</span>);</div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;        <a class="code" href="_image_utils__0_87_8cpp.html#a71e1a1379805788f090639ddc8bc046c">printImageInfo</a>(imageAlphaMask, <span class="stringliteral">&quot;imageAlphaMask&quot;</span>);</div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;        <span class="keywordflow">return</span> NULL;</div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;    }</div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;</div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;    <span class="comment">// Combine the 2 images using the alpha channel mask</span></div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;    <span class="keywordtype">int</span> width = image1-&gt;width;</div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;    <span class="keywordtype">int</span> height = image1-&gt;height;</div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;    IplImage *imageBlended = cvCreateImage(cvSize(width, height), image1-&gt;depth, image1-&gt;nChannels);</div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;    <span class="keywordtype">int</span> widthStep1 = image1-&gt;widthStep;</div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;    <span class="keywordtype">int</span> widthStep2 = image2-&gt;widthStep;</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;    <span class="keywordtype">int</span> widthStepM = imageAlphaMask-&gt;widthStep;</div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;    <span class="keywordtype">int</span> widthStepBlended = imageBlended-&gt;widthStep;</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;    <span class="comment">// Start from the beginning of the image and move through the image, row by row.</span></div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;    <a class="code" href="_image_utils_8h.html#a4f4bb67531a9bf6f0b9c6ad76aeba587">UCHAR</a> *p1 = (<a class="code" href="_image_utils_8h.html#a4f4bb67531a9bf6f0b9c6ad76aeba587">UCHAR</a>*)image1-&gt;imageData;</div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;    <a class="code" href="_image_utils_8h.html#a4f4bb67531a9bf6f0b9c6ad76aeba587">UCHAR</a> *p2 = (<a class="code" href="_image_utils_8h.html#a4f4bb67531a9bf6f0b9c6ad76aeba587">UCHAR</a>*)image2-&gt;imageData;</div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;    <a class="code" href="_image_utils_8h.html#a4f4bb67531a9bf6f0b9c6ad76aeba587">UCHAR</a> *pM = (<a class="code" href="_image_utils_8h.html#a4f4bb67531a9bf6f0b9c6ad76aeba587">UCHAR</a>*)imageAlphaMask-&gt;imageData;</div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;    <a class="code" href="_image_utils_8h.html#a4f4bb67531a9bf6f0b9c6ad76aeba587">UCHAR</a> *pBlended = (<a class="code" href="_image_utils_8h.html#a4f4bb67531a9bf6f0b9c6ad76aeba587">UCHAR</a>*)imageBlended-&gt;imageData;</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> y=0; y &lt; height; y++) {</div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="_p_d_8m.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a>=0; <a class="code" href="_p_d_8m.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a> &lt; width; <a class="code" href="_p_d_8m.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a>++) {</div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;            <span class="keywordtype">int</span> m = *pM++;    <span class="comment">// Get the alpha mask value (0 to 255) and move to its next pixel.</span></div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;            <span class="keywordtype">int</span> part1R, part1G, part1B;</div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;            <span class="keywordtype">int</span> part2R, part2G, part2B;</div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;            <span class="keywordtype">int</span> pixel1B = *p1++;    <span class="comment">// Get the B value and move to its next pixel.</span></div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;            <span class="keywordtype">int</span> pixel1G = *p1++;    <span class="comment">// Get the G value and move to its next pixel.</span></div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;            <span class="keywordtype">int</span> pixel1R = *p1++;    <span class="comment">// Get the R value and move to its next pixel.</span></div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;            <span class="comment">// Instead of dividing slowly by 255: multiply image2 with (alpha mask + 1), then divide it by 256.</span></div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;            <span class="comment">// It is similar to dividing by 255, but much faster.</span></div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;            <span class="comment">// But note that if m was 0, it would be slightly off, so m == 0 is treated separately.</span></div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;            <span class="keywordflow">if</span> (m) {</div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;                <span class="keywordtype">int</span> f1 = m + 1;</div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;                <span class="keywordtype">int</span> pixel2B = *p2++;    <span class="comment">// Get the B value and move to its next pixel.</span></div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;                <span class="keywordtype">int</span> pixel2G = *p2++;    <span class="comment">// Get the G value and move to its next pixel.</span></div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;                <span class="keywordtype">int</span> pixel2R = *p2++;    <span class="comment">// Get the R value and move to its next pixel.</span></div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;                part2B = ( pixel2B * f1 ) &gt;&gt; 8;</div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;                part2G = ( pixel2G * f1 ) &gt;&gt; 8;</div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;                part2R = ( pixel2R * f1 ) &gt;&gt; 8;</div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;                <span class="comment">// Multiply image1 with (255 - alpha mask), then divide it by 256. Similar to dividing by 255.0, but much faster.</span></div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;                <span class="keywordtype">int</span> f2 = 255 - m;</div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;                part1B = ( pixel1B * f2 ) &gt;&gt; 8;</div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;                part1G = ( pixel1G * f2 ) &gt;&gt; 8;</div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;                part1R = ( pixel1R * f2 ) &gt;&gt; 8;</div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;            }</div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;            <span class="keywordflow">else</span> {</div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;                <span class="comment">// If the alpha mask was 0, then just use image1 and not image2.</span></div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;                part1B = pixel1B;</div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;                part1G = pixel1G;</div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;                part1R = pixel1R;</div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;                part2B = 0;</div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;                part2G = 0;</div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;                part2R = 0;</div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;                p2 += 3;    <span class="comment">// move the pointer to the next pixel.</span></div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;            }</div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;            <span class="comment">// Combine the part of image1 with the part of image2, and then move to the next pixel.</span></div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;            *pBlended++ = part1B + part2B;</div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;            *pBlended++ = part1G + part2G;</div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;            *pBlended++ = part1R + part2R;</div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;        }</div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;        <span class="comment">// Move everything to the next row by adding widthStep and subtracting how much of the row was already processed.</span></div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;        p1 += widthStep1 - width * 3;    <span class="comment">// Move to the next RGB row, ignoring any row padding.</span></div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;        p2 += widthStep2 - width * 3;    <span class="comment">// Move to the next RGB row, ignoring any row padding.</span></div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;        pM += widthStepM - width;        <span class="comment">// Move to the next Greyscale row, ignoring any row padding.</span></div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;        pBlended += widthStepBlended - width * 3;    <span class="comment">// Move to the next RGB row, ignoring any row padding.</span></div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;    }</div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;</div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;    <span class="keywordflow">return</span> imageBlended;</div><div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;}</div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;</div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;</div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;<span class="comment">// Save the given image to a JPG or BMP file, even if its format isn&#39;t an 8-bit image, such as a 32bit float image.</span></div><div class="line"><a name="l02039"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#a872f395f8a1d5613534a80eea20bef16"> 2039</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="_image_utils__0_87_8cpp.html#a872f395f8a1d5613534a80eea20bef16">saveImage</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *filename, <span class="keyword">const</span> IplImage *image)</div><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;{</div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;    <span class="keywordtype">int</span> ret = -1;</div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;<span class="preprocessor">#ifdef USE_HIGHGUI</span></div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;    IplImage *image8Bit = cvCreateImage(cvSize(image-&gt;width,image-&gt;height), IPL_DEPTH_8U, image-&gt;nChannels);    <span class="comment">// 8-bit greyscale image.</span></div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;    <span class="keywordflow">if</span> (image8Bit)</div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;        cvConvert(image, image8Bit);    <span class="comment">// Convert to an 8-bit image instead of potentially 16,24,32 or 64bit image.</span></div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;    <span class="keywordflow">if</span> (image8Bit)</div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;        ret = cvSaveImage(filename, image8Bit);</div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;    <span class="keywordflow">if</span> (image8Bit)</div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;        cvReleaseImage(&amp;image8Bit);</div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;    <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;}</div><div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;</div><div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;<span class="comment">// Store a greyscale floating-point CvMat image into a BMP/JPG/GIF/PNG image,</span></div><div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;<span class="comment">// since cvSaveImage() can only handle 8bit images (not 32bit float images).</span></div><div class="line"><a name="l02056"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#ae3a9ff71129be1f858c07ca765379fcc"> 2056</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="_image_utils__0_87_8cpp.html#ae3a9ff71129be1f858c07ca765379fcc">saveFloatMat</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *filename, <span class="keyword">const</span> CvMat *srcMat)</div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;{</div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;    <span class="comment">//cout &lt;&lt; &quot;in Saving Image(&quot; &lt;&lt; ((CvMat*)src)-&gt;width &lt;&lt; &quot;,&quot; &lt;&lt; ((CvMat*)src)-&gt;height &lt;&lt; &quot;) &#39;&quot; &lt;&lt; filename &lt;&lt; &quot;&#39;.&quot; &lt;&lt; endl;</span></div><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;    <span class="keywordflow">if</span> (CV_MAT_CN(srcMat-&gt;type) != 1 || CV_MAT_DEPTH(srcMat-&gt;type) != 32) {</div><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;        LOG(<span class="stringliteral">&quot;ERROR in saveFloatMat(): Matrix is not single-channel 32-bit float matrix!&quot;</span>);</div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;    }</div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;</div><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;    <span class="comment">// Fill the Matrix&#39;s float data as a float image into this temporary image, since it wont be needed after this function.</span></div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;    IplImage srcIplImg;</div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;    cvGetImage(srcMat, &amp;srcIplImg);</div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;    <span class="comment">// Store the float image</span></div><div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;    <a class="code" href="_image_utils__0_87_8cpp.html#abe19b08095b1fa9012ae8bab9c1a4972">saveFloatImage</a>(filename, &amp;srcIplImg);</div><div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;}</div><div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;</div><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;<span class="comment">// Get an 8-bit equivalent of the 32-bit Float Matrix.</span></div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;<span class="comment">// Returns a new image, so remember to call &#39;cvReleaseImage()&#39; on the result.</span></div><div class="line"><a name="l02073"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#ae4b32640e870feeffb847f9b5a8ced4f"> 2073</a></span>&#160;IplImage* <a class="code" href="_image_utils__0_87_8cpp.html#ae4b32640e870feeffb847f9b5a8ced4f">convertMatrixToUcharImage</a>(<span class="keyword">const</span> CvMat *srcMat)</div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;{</div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;    <span class="comment">// Fill the Matrix&#39;s float data as a float image into this image.</span></div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;    IplImage srcIplImg;</div><div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;    cvGetImage(srcMat, &amp;srcIplImg);</div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;</div><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;    <span class="comment">// Convert the float image into a normal Uchar image.</span></div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="_image_utils__0_87_8cpp.html#a0040030a7c944161c755740a7ce5bb5e">convertFloatImageToUcharImage</a>(&amp;srcIplImg);</div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;}</div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;</div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;<span class="comment">// Get an 8-bit equivalent of the 32-bit Float image.</span></div><div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;<span class="comment">// Returns a new image, so remember to call &#39;cvReleaseImage()&#39; on the result.</span></div><div class="line"><a name="l02085"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#a0040030a7c944161c755740a7ce5bb5e"> 2085</a></span>&#160;IplImage* <a class="code" href="_image_utils__0_87_8cpp.html#a0040030a7c944161c755740a7ce5bb5e">convertFloatImageToUcharImage</a>(<span class="keyword">const</span> IplImage *srcImg)</div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;{</div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;    IplImage *dstImg = 0;</div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;    <span class="keywordflow">if</span> ((srcImg) &amp;&amp; (srcImg-&gt;width &gt; 0 &amp;&amp; srcImg-&gt;height &gt; 0)) {</div><div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;</div><div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;        <span class="keywordflow">if</span> (srcImg-&gt;nChannels != 1 || srcImg-&gt;depth != 32) {</div><div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;            LOG(<span class="stringliteral">&quot;ERROR in convertFloatImageToUcharImage(): Image is not single-channel 32-bit float image!&quot;</span>);</div><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;            <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;        }</div><div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;</div><div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;        <span class="comment">// Spread the 32bit floating point pixels to fit within 8bit pixel range.</span></div><div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;        <span class="keywordtype">double</span> minVal, maxVal;</div><div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;        cvMinMaxLoc(srcImg, &amp;minVal, &amp;maxVal);</div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;</div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;        LOG(<span class="stringliteral">&quot;FloatImage:(minV=%lf, maxV=%lf)&quot;</span>, minVal, maxVal);</div><div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;</div><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;        <span class="comment">// Deal with NaN and extreme values, since the DFT seems to give some NaN results.</span></div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;        <span class="keywordflow">if</span> (cvIsNaN(minVal) || minVal &lt; -1e30)</div><div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;            minVal = -1e30;</div><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;        <span class="keywordflow">if</span> (cvIsNaN(maxVal) || maxVal &gt; 1e30)</div><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;            maxVal = 1e30;</div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;        <span class="keywordflow">if</span> (maxVal-minVal == 0.0f)</div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;            maxVal = minVal + 0.001;    <span class="comment">// remove potential divide by zero errors.</span></div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;</div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;        <span class="comment">// Convert the format</span></div><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;        dstImg = cvCreateImage(cvSize(srcImg-&gt;width, srcImg-&gt;height), 8, 1);</div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;        cvConvertScale(srcImg, dstImg, 255.0 / (maxVal - minVal), - minVal * 255.0 / (maxVal-minVal));</div><div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;    }</div><div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;    <span class="keywordflow">return</span> dstImg;</div><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;}</div><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;</div><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;<span class="comment">// Store a greyscale floating-point CvMat image into a BMP/JPG/GIF/PNG image,</span></div><div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;<span class="comment">// since cvSaveImage() can only handle 8bit images (not 32bit float images).</span></div><div class="line"><a name="l02118"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#abe19b08095b1fa9012ae8bab9c1a4972"> 2118</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="_image_utils__0_87_8cpp.html#abe19b08095b1fa9012ae8bab9c1a4972">saveFloatImage</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *filename, <span class="keyword">const</span> IplImage *srcImg)</div><div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;{</div><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;<span class="preprocessor">#ifdef USE_HIGHGUI</span></div><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;    <span class="comment">//LOG(&quot;Saving Float Image &#39;%s&#39; (%dx%d)&quot;, filename, srcImg-&gt;width, srcImg-&gt;height);</span></div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;    <span class="keywordflow">if</span> (srcImg-&gt;nChannels != 1 || srcImg-&gt;depth != 32) {</div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;        LOG(<span class="stringliteral">&quot;ERROR in saveFloatImage(): Image is not single-channel 32-bit float image!&quot;</span>);</div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;    }</div><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;    IplImage *byteImg = <a class="code" href="_image_utils__0_87_8cpp.html#a0040030a7c944161c755740a7ce5bb5e">convertFloatImageToUcharImage</a>(srcImg);</div><div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;    cvSaveImage(filename, byteImg);</div><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;    cvReleaseImage(&amp;byteImg);</div><div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;    <span class="comment">//cout &lt;&lt; &quot;done saveFloatImage()&quot; &lt;&lt; endl;</span></div><div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;}</div><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;</div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;<span class="comment">// Draw some text onto an image using printf() format.</span></div><div class="line"><a name="l02134"></a><span class="lineno"><a class="line" href="_image_utils__0_87_8cpp.html#af23c87296eb3657d106742b6e888ae2b"> 2134</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="_image_utils__0_87_8cpp.html#af23c87296eb3657d106742b6e888ae2b">drawText</a>(IplImage *img, CvPoint position, CvScalar color, <span class="keywordtype">char</span> *fmt, ...)</div><div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;{</div><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;    <span class="comment">// Write the given arguments to &#39;szMsg&#39; using printf() style formatting.</span></div><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;    va_list marker;</div><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;    <span class="keywordtype">char</span> szMsg[1024];</div><div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;    va_start(marker, fmt);</div><div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;    vsprintf(szMsg, fmt, marker);</div><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;    va_end(marker);</div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;    <span class="comment">//marker = marker;    // stop warning messages</span></div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;</div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;    <span class="comment">// Display the text onto the image.</span></div><div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;    CvFont font;</div><div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;    cvInitFont(&amp;font, CV_FONT_HERSHEY_SIMPLEX, 0.3,0.3, 0, 1, CV_AA);</div><div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;    cvPutText(img, szMsg, position, &amp;font, color);</div><div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;}</div><div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;</div><div class="ttc" id="_image_utils__0_87_8cpp_html_a59a2e877cb44c178fea345bb1f918e42"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#a59a2e877cb44c178fea345bb1f918e42">printMatrix</a></div><div class="ttdeci">void printMatrix(const CvMat *M, const char *label, int maxElements)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l00272">ImageUtils_0.7.cpp:272</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_a9afbb467be07a4c77ae5a0836d15bc12"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#a9afbb467be07a4c77ae5a0836d15bc12">showFloatGraph</a></div><div class="ttdeci">void showFloatGraph(const char *name, const float *arraySrc, int nArrayLength, int delay_ms, IplImage *background)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l00732">ImageUtils_0.7.cpp:732</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_a313404a90ed0a156db06389aab49094e"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#a313404a90ed0a156db06389aab49094e">usingCustomGraphColor</a></div><div class="ttdeci">int usingCustomGraphColor</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l00423">ImageUtils_0.7.cpp:423</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_aa61845612ab6c1b95f56d909b02c2b49"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#aa61845612ab6c1b95f56d909b02c2b49">printDataRange</a></div><div class="ttdeci">void printDataRange(const CvArr *src, const char *msg)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l00389">ImageUtils_0.7.cpp:389</a></div></div>
<div class="ttc" id="process__1_8m_html_a8c4e28b0ee15a1005df90b45f3b82ea8"><div class="ttname"><a href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a></div><div class="ttdeci">Speed_z target for i</div><div class="ttdef"><b>Definition:</b> <a href="process__1_8m_source.html#l00081">process_1.m:81</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_a6c0597165f5d03dfc54600e90f1799d1"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#a6c0597165f5d03dfc54600e90f1799d1">convertImageToGreyscale</a></div><div class="ttdeci">IplImage * convertImageToGreyscale(const IplImage *imageSrc)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l00809">ImageUtils_0.7.cpp:809</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_a56baadc60b4d228703cc4bf6fcb49bbc"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#a56baadc60b4d228703cc4bf6fcb49bbc">customGraphColor</a></div><div class="ttdeci">CvScalar customGraphColor</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l00422">ImageUtils_0.7.cpp:422</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_a8901832277b3f8073d4e10d107d95876"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#a8901832277b3f8073d4e10d107d95876">printPoint</a></div><div class="ttdeci">void printPoint(const CvPoint pt, const char *label)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l01326">ImageUtils_0.7.cpp:1326</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_a8355fae3cd30c8e2134125e715465e1d"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#a8355fae3cd30c8e2134125e715465e1d">findAngleBetweenPointsF</a></div><div class="ttdeci">float findAngleBetweenPointsF(const CvPoint2D32f p1, const CvPoint2D32f p2)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l01305">ImageUtils_0.7.cpp:1305</a></div></div>
<div class="ttc" id="_image_utils_8h_html_a4f4bb67531a9bf6f0b9c6ad76aeba587"><div class="ttname"><a href="_image_utils_8h.html#a4f4bb67531a9bf6f0b9c6ad76aeba587">UCHAR</a></div><div class="ttdeci">unsigned char UCHAR</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils_8h_source.html#l00078">ImageUtils.h:78</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_a185e4810200f8820f7265cd96ff3b38d"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#a185e4810200f8820f7265cd96ff3b38d">offsetRectPt</a></div><div class="ttdeci">CvRect offsetRectPt(const CvRect rectA, const CvPoint pt)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l01408">ImageUtils_0.7.cpp:1408</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_a3ce62ba8ec55fc1637f53a05ed1b0cd3"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#a3ce62ba8ec55fc1637f53a05ed1b0cd3">blendImage</a></div><div class="ttdeci">IplImage * blendImage(const IplImage *image1, const IplImage *image2, const IplImage *imageAlphaMask)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l01946">ImageUtils_0.7.cpp:1946</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_a0bb8ac7243cbe0dbed1514f24e009adf"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#a0bb8ac7243cbe0dbed1514f24e009adf">cropImage</a></div><div class="ttdeci">IplImage * cropImage(const IplImage *img, const CvRect region)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l01541">ImageUtils_0.7.cpp:1541</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_a379a9b2857f990b6781b5891bce4921e"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#a379a9b2857f990b6781b5891bce4921e">drawFloatGraph</a></div><div class="ttdeci">IplImage * drawFloatGraph(const float *arraySrc, int nArrayLength, IplImage *imageDst, float minV, float maxV, int width, int height, char *graphLabel, bool showScale)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l00464">ImageUtils_0.7.cpp:464</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_aa6617d2acf4c31e5049756f4465f2720"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#aa6617d2acf4c31e5049756f4465f2720">getBitDepth</a></div><div class="ttdeci">int getBitDepth(const cv::Mat M)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l00122">ImageUtils_0.7.cpp:122</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_a6d5d1fabb4bbdde9c279c4f0280ddf62"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#a6d5d1fabb4bbdde9c279c4f0280ddf62">combineImagesResized</a></div><div class="ttdeci">IplImage * combineImagesResized(int nArgs,...)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l01708">ImageUtils_0.7.cpp:1708</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_ae3a9ff71129be1f858c07ca765379fcc"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#ae3a9ff71129be1f858c07ca765379fcc">saveFloatMat</a></div><div class="ttdeci">void saveFloatMat(const char *filename, const CvMat *srcMat)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l02056">ImageUtils_0.7.cpp:2056</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_acd59a9dd93ae769d623f63969c65b472"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#acd59a9dd93ae769d623f63969c65b472">drawRectFilled</a></div><div class="ttdeci">void drawRectFilled(IplImage *img, const CvRect rect, const CvScalar color)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l01429">ImageUtils_0.7.cpp:1429</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_af2f2f4eb041fb13a75ff2ad567f9e70a"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#af2f2f4eb041fb13a75ff2ad567f9e70a">convertPixelRGBtoHSV_256</a></div><div class="ttdeci">void convertPixelRGBtoHSV_256(int bR, int bG, int bB, int &amp;bH, int &amp;bS, int &amp;bV)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l00826">ImageUtils_0.7.cpp:826</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_aa8db8389a3a506d6713c637dd3f908c0"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#aa8db8389a3a506d6713c637dd3f908c0">showUCharGraph</a></div><div class="ttdeci">void showUCharGraph(const char *name, const uchar *arraySrc, int nArrayLength, int delay_ms, IplImage *background)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l00772">ImageUtils_0.7.cpp:772</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_a71e1a1379805788f090639ddc8bc046c"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#a71e1a1379805788f090639ddc8bc046c">printImageInfo</a></div><div class="ttdeci">void printImageInfo(const IplImage *image, const char *label)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l00029">ImageUtils_0.7.cpp:29</a></div></div>
<div class="ttc" id="namespacestd_html"><div class="ttname"><a href="namespacestd.html">std</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_aa4511098296beb72b5466963498d0ad7"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#aa4511098296beb72b5466963498d0ad7">findAngleBetweenPointsI</a></div><div class="ttdeci">float findAngleBetweenPointsI(const CvPoint p1, const CvPoint p2)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l01315">ImageUtils_0.7.cpp:1315</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_ac6421fa2581ccc249774c179d87dbda2"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#ac6421fa2581ccc249774c179d87dbda2">WHITE</a></div><div class="ttdeci">const CvScalar WHITE</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l00418">ImageUtils_0.7.cpp:418</a></div></div>
<div class="ttc" id="_p_d_8m_html_a9336ebf25087d91c818ee6e9ec29f8c1"><div class="ttname"><a href="_p_d_8m.html#a9336ebf25087d91c818ee6e9ec29f8c1">x</a></div><div class="ttdeci">x</div><div class="ttdef"><b>Definition:</b> <a href="_p_d_8m_source.html#l00010">PD.m:10</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_a3c4f5e6e80ebcace08d9f2236d8f4104"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#a3c4f5e6e80ebcace08d9f2236d8f4104">printImagePixels</a></div><div class="ttdeci">void printImagePixels(const IplImage *image, const char *label, int maxElements)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l00052">ImageUtils_0.7.cpp:52</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_ada6eb2b9ef6c2ce92a5119ad1568ca26"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#ada6eb2b9ef6c2ce92a5119ad1568ca26">resizeImage</a></div><div class="ttdeci">IplImage * resizeImage(const IplImage *origImg, int newWidth, int newHeight, bool keepAspectRatio)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l01568">ImageUtils_0.7.cpp:1568</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_a0040030a7c944161c755740a7ce5bb5e"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#a0040030a7c944161c755740a7ce5bb5e">convertFloatImageToUcharImage</a></div><div class="ttdeci">IplImage * convertFloatImageToUcharImage(const IplImage *srcImg)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l02085">ImageUtils_0.7.cpp:2085</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_ae69519b4e45351bf4eb791a53d4a6690"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#ae69519b4e45351bf4eb791a53d4a6690">combineImages</a></div><div class="ttdeci">IplImage * combineImages(int nArgs,...)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l01841">ImageUtils_0.7.cpp:1841</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_add3fc44702865288f65ad955b950989e"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#add3fc44702865288f65ad955b950989e">setGraphColor</a></div><div class="ttdeci">void setGraphColor(int index)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l00450">ImageUtils_0.7.cpp:450</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_a9d48f4622feacb441c11524bec0bf94f"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#a9d48f4622feacb441c11524bec0bf94f">setCustomGraphColor</a></div><div class="ttdeci">void setCustomGraphColor(int R, int B, int G)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l00456">ImageUtils_0.7.cpp:456</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_a872f395f8a1d5613534a80eea20bef16"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#a872f395f8a1d5613534a80eea20bef16">saveImage</a></div><div class="ttdeci">int saveImage(const char *filename, const IplImage *image)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l02039">ImageUtils_0.7.cpp:2039</a></div></div>
<div class="ttc" id="_image_utils_8h_html"><div class="ttname"><a href="_image_utils_8h.html">ImageUtils.h</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_a0b7dcfc7e09a1bf62c43ba33d8ca8f92"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#a0b7dcfc7e09a1bf62c43ba33d8ca8f92">showImage</a></div><div class="ttdeci">void showImage(const IplImage *img, int delay_ms, char *name)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l00790">ImageUtils_0.7.cpp:790</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_aab612cb70e652fea8bf399d4cd49fb4f"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#aab612cb70e652fea8bf399d4cd49fb4f">scalePointAroundPointF</a></div><div class="ttdeci">CvPoint2D32f scalePointAroundPointF(const CvPoint2D32f point, const CvPoint2D32f origin, float scale)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l01255">ImageUtils_0.7.cpp:1255</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_a4d4054bce7b2974bf7523a3d0b3e956f"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#a4d4054bce7b2974bf7523a3d0b3e956f">mapRotatedImagePoint</a></div><div class="ttdeci">CvPoint2D32f mapRotatedImagePoint(const CvPoint2D32f pointOrig, const IplImage *image, float angleDegrees, float scale)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l01662">ImageUtils_0.7.cpp:1662</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_a34c452c1bc1c48870e47bfac38b9dc71"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#a34c452c1bc1c48870e47bfac38b9dc71">printMat</a></div><div class="ttdeci">void printMat(const cv::Mat M, const char *label, int maxElements)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l00222">ImageUtils_0.7.cpp:222</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_a40990a9cb5e6b4e8dee6e58ac3895057"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#a40990a9cb5e6b4e8dee6e58ac3895057">cropRect</a></div><div class="ttdeci">CvRect cropRect(const CvRect rectIn, int w, int h)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l01464">ImageUtils_0.7.cpp:1464</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_abcc8c08c2c7c71b2269501cdef97bf1f"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#abcc8c08c2c7c71b2269501cdef97bf1f">BLACK</a></div><div class="ttdeci">const CvScalar BLACK</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l00417">ImageUtils_0.7.cpp:417</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_a9dcb12c5075cf304d27571baa97c11aa"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#a9dcb12c5075cf304d27571baa97c11aa">convertImageRGBtoHSV</a></div><div class="ttdeci">IplImage * convertImageRGBtoHSV(const IplImage *imageRGB)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l00931">ImageUtils_0.7.cpp:931</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_a72d9e00b861e3b95304d921d5b3cad23"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#a72d9e00b861e3b95304d921d5b3cad23">drawIntGraph</a></div><div class="ttdeci">IplImage * drawIntGraph(const int *arraySrc, int nArrayLength, IplImage *imageDst, int minV, int maxV, int width, int height, char *graphLabel, bool showScale)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l00553">ImageUtils_0.7.cpp:553</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_a01f97ecb4f7ab8bc04fb014ad8a28e1d"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#a01f97ecb4f7ab8bc04fb014ad8a28e1d">countGraph</a></div><div class="ttdeci">int countGraph</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l00421">ImageUtils_0.7.cpp:421</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_a02e7e13743d3aa4eaf0776c10f629f34"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#a02e7e13743d3aa4eaf0776c10f629f34">offsetRect</a></div><div class="ttdeci">CvRect offsetRect(const CvRect rectA, const CvRect rectB)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l01397">ImageUtils_0.7.cpp:1397</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_a63255cd7415678275c971abc40a7caea"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#a63255cd7415678275c971abc40a7caea">printLine</a></div><div class="ttdeci">void printLine(const CvPoint ptA, const CvPoint ptB, const char *label)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l00379">ImageUtils_0.7.cpp:379</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_a90c1506df91b35572789b2ef19049ed1"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#a90c1506df91b35572789b2ef19049ed1">smoothImageBilateral</a></div><div class="ttdeci">IplImage * smoothImageBilateral(const IplImage *src, float smoothness)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l01685">ImageUtils_0.7.cpp:1685</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_a9e2b2766488b6a38d506d6c60abd71dd"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#a9e2b2766488b6a38d506d6c60abd71dd">getGraphColor</a></div><div class="ttdeci">CvScalar getGraphColor(void)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l00426">ImageUtils_0.7.cpp:426</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_a58c3dba9a83d379d00c08c8f5fb1751b"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#a58c3dba9a83d379d00c08c8f5fb1751b">showIntGraph</a></div><div class="ttdeci">void showIntGraph(const char *name, const int *arraySrc, int nArrayLength, int delay_ms, IplImage *background)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l00752">ImageUtils_0.7.cpp:752</a></div></div>
<div class="ttc" id="process__1_8m_html_afa522382c3fac96d0f07658ea5d69adc"><div class="ttname"><a href="process__1_8m.html#afa522382c3fac96d0f07658ea5d69adc">r</a></div><div class="ttdeci">r</div><div class="ttdef"><b>Definition:</b> <a href="process__1_8m_source.html#l00029">process_1.m:29</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_a1d4a420196d8b8b9ac303d22e4a10480"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#a1d4a420196d8b8b9ac303d22e4a10480">convertImageHSVtoRGB</a></div><div class="ttdeci">IplImage * convertImageHSVtoRGB(const IplImage *imageHSV)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l01069">ImageUtils_0.7.cpp:1069</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_a06d8cb50bae2f8acac7ace9fa805ac28"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#a06d8cb50bae2f8acac7ace9fa805ac28">rotatePointAroundPointF</a></div><div class="ttdeci">CvPoint2D32f rotatePointAroundPointF(const CvPoint2D32f point, const CvPoint2D32f origin, float angleDegrees)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l01242">ImageUtils_0.7.cpp:1242</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_a44a8b76aadafa4df7e7e4d8f04be4c6c"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#a44a8b76aadafa4df7e7e4d8f04be4c6c">drawRect</a></div><div class="ttdeci">void drawRect(IplImage *img, const CvRect rect, const CvScalar color)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l01419">ImageUtils_0.7.cpp:1419</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_a674ab35bd234d16291add6869bac2fd1"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#a674ab35bd234d16291add6869bac2fd1">scaleRectInPlace</a></div><div class="ttdeci">CvRect scaleRectInPlace(const CvRect rectIn, float scaleX, float scaleY, float borderX, float borderY, int w, int h)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l01370">ImageUtils_0.7.cpp:1370</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_a359bfe66d2413f7e0f061e6930a529e6"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#a359bfe66d2413f7e0f061e6930a529e6">drawCross</a></div><div class="ttdeci">void drawCross(IplImage *img, const CvPoint pt, int radius, const CvScalar color)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l01440">ImageUtils_0.7.cpp:1440</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_ab20516caeb7081b61ca8f92f61731aff"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#ab20516caeb7081b61ca8f92f61731aff">rotateImage</a></div><div class="ttdeci">IplImage * rotateImage(const IplImage *src, float angleDegrees, float scale)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l01628">ImageUtils_0.7.cpp:1628</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_ae4b32640e870feeffb847f9b5a8ced4f"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#ae4b32640e870feeffb847f9b5a8ced4f">convertMatrixToUcharImage</a></div><div class="ttdeci">IplImage * convertMatrixToUcharImage(const CvMat *srcMat)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l02073">ImageUtils_0.7.cpp:2073</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_adf7d71d81f75c4d1798fc88237879a7d"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#adf7d71d81f75c4d1798fc88237879a7d">convertImageYIQtoRGB</a></div><div class="ttdeci">IplImage * convertImageYIQtoRGB(const IplImage *imageYIQ)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l01128">ImageUtils_0.7.cpp:1128</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_ab2c6aa5ac6cbe4bb9c3dd12451323746"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#ab2c6aa5ac6cbe4bb9c3dd12451323746">scaleValueF</a></div><div class="ttdeci">float scaleValueF(float p, float s, float maxVal)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l01266">ImageUtils_0.7.cpp:1266</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_a493f114bc3e141c7d2fe2bb0164b354c"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#a493f114bc3e141c7d2fe2bb0164b354c">printPoint32f</a></div><div class="ttdeci">void printPoint32f(const CvPoint2D32f pt, const char *label)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l00369">ImageUtils_0.7.cpp:369</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_aa1895a075a89e930fd81265778cfc76a"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#aa1895a075a89e930fd81265778cfc76a">convertPixelRGBtoHSV_180</a></div><div class="ttdeci">void convertPixelRGBtoHSV_180(int bR, int bG, int bB, int &amp;bH, int &amp;bS, int &amp;bV)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l01107">ImageUtils_0.7.cpp:1107</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_adee4557fedaf6dc9fda8b12d422f37a9"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#adee4557fedaf6dc9fda8b12d422f37a9">drawUCharGraph</a></div><div class="ttdeci">IplImage * drawUCharGraph(const uchar *arraySrc, int nArrayLength, IplImage *imageDst, int minV, int maxV, int width, int height, char *graphLabel, bool showScale)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l00642">ImageUtils_0.7.cpp:642</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_aade8e3bc2d7d0b6356681953aa18da93"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#aade8e3bc2d7d0b6356681953aa18da93">GREY</a></div><div class="ttdeci">const CvScalar GREY</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l00419">ImageUtils_0.7.cpp:419</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_ab5a8f37501ae03e68eeab5f56bdd15c0"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#ab5a8f37501ae03e68eeab5f56bdd15c0">findDistanceBetweenPointsI</a></div><div class="ttdeci">float findDistanceBetweenPointsI(const CvPoint p1, const CvPoint p2)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l01296">ImageUtils_0.7.cpp:1296</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_a8b339c1ee055e4bb597facdca87fa2dd"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#a8b339c1ee055e4bb597facdca87fa2dd">scalePointF</a></div><div class="ttdeci">CvPoint2D32f scalePointF(const CvPoint2D32f point, float scale)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l01221">ImageUtils_0.7.cpp:1221</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_abe19b08095b1fa9012ae8bab9c1a4972"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#abe19b08095b1fa9012ae8bab9c1a4972">saveFloatImage</a></div><div class="ttdeci">void saveFloatImage(const char *filename, const IplImage *srcImg)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l02118">ImageUtils_0.7.cpp:2118</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_a838a6a38fc180f0dfb070d22b516cf92"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#a838a6a38fc180f0dfb070d22b516cf92">scaleValueI</a></div><div class="ttdeci">int scaleValueI(int p, float s, int maxVal)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l01277">ImageUtils_0.7.cpp:1277</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_af23c87296eb3657d106742b6e888ae2b"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#af23c87296eb3657d106742b6e888ae2b">drawText</a></div><div class="ttdeci">void drawText(IplImage *img, CvPoint position, CvScalar color, char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l02134">ImageUtils_0.7.cpp:2134</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_a077994dd1627ad13e634f5a9e7740b32"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#a077994dd1627ad13e634f5a9e7740b32">convertPixelHSVtoRGB_256</a></div><div class="ttdeci">void convertPixelHSVtoRGB_256(int bH, int bS, int bV, int &amp;bR, int &amp;bG, int &amp;bB)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l00970">ImageUtils_0.7.cpp:970</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_a6ffabb9779799c3b41af29bb58ac8e9a"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#a6ffabb9779799c3b41af29bb58ac8e9a">rotatePointF</a></div><div class="ttdeci">CvPoint2D32f rotatePointF(const CvPoint2D32f point, float angleDegrees)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l01229">ImageUtils_0.7.cpp:1229</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_aa556e96a0166fda3abbfb7a3abff48f6"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#aa556e96a0166fda3abbfb7a3abff48f6">subtractPointF</a></div><div class="ttdeci">CvPoint2D32f subtractPointF(const CvPoint2D32f pointA, const CvPoint2D32f pointB)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l01213">ImageUtils_0.7.cpp:1213</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_a0a7ca8e17d04231c422569e1c1c25d61"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#a0a7ca8e17d04231c422569e1c1c25d61">findDistanceBetweenPointsF</a></div><div class="ttdeci">float findDistanceBetweenPointsF(const CvPoint2D32f p1, const CvPoint2D32f p2)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l01289">ImageUtils_0.7.cpp:1289</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_a8db18c00cae6a0edc0eee50e614634ee"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#a8db18c00cae6a0edc0eee50e614634ee">printRect</a></div><div class="ttdeci">void printRect(const CvRect rect, const char *label)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l01455">ImageUtils_0.7.cpp:1455</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_a9271a93dd613180f6fd8ce77bb639494"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#a9271a93dd613180f6fd8ce77bb639494">addPointF</a></div><div class="ttdeci">CvPoint2D32f addPointF(const CvPoint2D32f pointA, const CvPoint2D32f pointB)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l01205">ImageUtils_0.7.cpp:1205</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_a8b8c337e358870196d79e8edf5888730"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#a8b8c337e358870196d79e8edf5888730">printPointF</a></div><div class="ttdeci">void printPointF(const CvPoint2D32f pt, const char *label)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l01334">ImageUtils_0.7.cpp:1334</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_aa22edb30325622da19c52e7d2993cc8b"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#aa22edb30325622da19c52e7d2993cc8b">printArray2D</a></div><div class="ttdeci">void printArray2D(const uchar *data, int cols, int rows, int channels, int depth_type, int step, int maxElements)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l00142">ImageUtils_0.7.cpp:142</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_ae6e3a6315d54d43364c6c91dd9a67b5f"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#ae6e3a6315d54d43364c6c91dd9a67b5f">scaleRect</a></div><div class="ttdeci">CvRect scaleRect(const CvRect rectIn, float scaleX, float scaleY, int w, int h)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l01349">ImageUtils_0.7.cpp:1349</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_ad114009fb82a047849db183b3dd18657"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#ad114009fb82a047849db183b3dd18657">printMatInfo</a></div><div class="ttdeci">void printMatInfo(const cv::Mat M, const char *label)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l00265">ImageUtils_0.7.cpp:265</a></div></div>
<div class="ttc" id="_image_utils__0_87_8cpp_html_afb0d1a94a04194ea11c1eaaca11a0feb"><div class="ttname"><a href="_image_utils__0_87_8cpp.html#afb0d1a94a04194ea11c1eaaca11a0feb">convertPixelHSVtoRGB_180</a></div><div class="ttdeci">void convertPixelHSVtoRGB_180(int bH, int bS, int bV, int &amp;bR, int &amp;bG, int &amp;bB)</div><div class="ttdef"><b>Definition:</b> <a href="_image_utils__0_87_8cpp_source.html#l01117">ImageUtils_0.7.cpp:1117</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
