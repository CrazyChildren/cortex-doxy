<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CortexRobot: /temp/des/CameraTest_nofreev_branch/Algorithm/VisualServoAlgorithm.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CortexRobot
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_28e1bb8382970ac72e8ae3b23df4a891.html">temp</a></li><li class="navelem"><a class="el" href="dir_7ee3436e08fefa5a3e5de148816e60bf.html">des</a></li><li class="navelem"><a class="el" href="dir_9f521f3c0054d89524661d351ceeeed2.html">CameraTest_nofreev_branch</a></li><li class="navelem"><a class="el" href="dir_11fc880b39daecaf26a43a29a4b0ffd7.html">Algorithm</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">VisualServoAlgorithm.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_visual_servo_algorithm_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_visual_servo_algorithm_8h.html">VisualServoAlgorithm.h</a>&quot;</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &quot;CortexConfig.h&quot;</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div><div class="line"><a name="l00004"></a><span class="lineno"><a class="line" href="_visual_servo_algorithm_8cpp.html#a8e371173b7daec7c4f7f2e6422903af7">    4</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="_visual_servo_algorithm_8cpp.html#a8e371173b7daec7c4f7f2e6422903af7">K</a>[9] = { 615.493, 0, 324.792, 0.0, 615.661, 228.865, 0.0, 0.0, 1.0 };</div><div class="line"><a name="l00005"></a><span class="lineno"><a class="line" href="_visual_servo_algorithm_8cpp.html#a5034861c92021af41db3a46bc814a34b">    5</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="_visual_servo_algorithm_8cpp.html#a5034861c92021af41db3a46bc814a34b">D</a>[5] = { 0 };</div><div class="line"><a name="l00006"></a><span class="lineno"><a class="line" href="_visual_servo_algorithm_8cpp.html#a4c45cdff103e6644a620ba5061509f22">    6</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="_visual_servo_algorithm_8cpp.html#a4c45cdff103e6644a620ba5061509f22">frequency</a>=0.1;    <span class="comment">//100为face_detect 计时器的时间</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div><div class="line"><a name="l00011"></a><span class="lineno"><a class="line" href="class_visual_servo_algorithm.html#a8c91908370ed865721fa61b7ac90fbd7">   11</a></span>&#160;<a class="code" href="class_visual_servo_algorithm.html#a8c91908370ed865721fa61b7ac90fbd7">VisualServoAlgorithm::VisualServoAlgorithm</a>(QObject *parent) : QObject(parent)</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;{</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#aeb01eae8ab5674cd6880020d36fe8c42">end_to_base</a>[6]={0};</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a2a3fe76520035cd0f5488224733142c8">targetSetByHand</a>=<span class="keyword">false</span>;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a64f707a8fa1a248ce5e835024ae4b44a">trackAngle</a>=<span class="keyword">false</span>;</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#ad30eb4d4269fe50a287cda7df0763b49">ifOnlyTrackAngle</a>=<span class="keyword">false</span>;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#ac8d192693788b49498c48dd4b5df1e5a">ifExperiment</a>=<span class="keyword">false</span>;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a940d3f27e05c517340b50fc86ba47e09">trackHead</a>=<span class="keyword">false</span>;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#af890adbfb3b33b42941cb835c7fadba8">ifUseSpeed</a>=<span class="keyword">false</span>;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a4c7041ad81664e5e30077cb092507ee7">ifUseForce</a>=<span class="keyword">true</span>;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#ae126470dc9ce5767c9f25b3cfa6e409e">ifEnterForceMode</a>=<span class="keyword">false</span>;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a87a834a88a092582b206c4327b47a5fa">ifReachTarget</a>=<span class="keyword">false</span>;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#ab7b80eab269c73c1f2e604b695deb963">ifVisualServo</a>=<span class="keyword">true</span>;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a7b7bd4e592be89322e45422018a1fa70">ifDecomposeForce</a>=<span class="keyword">false</span>;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a30023353986c42d8f665d6df66991eb5">ifChangeLastCommand</a>=<span class="keyword">false</span>;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="comment">//************************visual servo**********************//</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a754b275c099792838405c663b9a2a848">error_position</a>=*(<span class="keyword">new</span> VectorXd(6,1));</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a90b8412ec228ef0dbb92a2fa87864919">error_positionDerivative</a>=*(<span class="keyword">new</span> VectorXd(6,1));</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a04ff1215e42e29746aa58372e3773e57">error_positionLast</a>=*(<span class="keyword">new</span> VectorXd(6,1));</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#abeb0fd3250e1b41800497eed5e30fbe5">velocity_visual</a>=*(<span class="keyword">new</span> VectorXd(6,1));</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a94509ddcec8a2fdfed8fd0b5848fb6a2">kp_visual</a>=*(<span class="keyword">new</span> MatrixXd(6,6));</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a8b757fbd59236596eca9be326873367b">kd_visual</a>=*(<span class="keyword">new</span> MatrixXd(6,6));</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a5f958ef24e662bd434538b887e844105">kp_visualAdapt</a>=*(<span class="keyword">new</span> MatrixXd(6,6));</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a9b402f1a244e0ad46ce92141f8b7d06a">kd_visualAdapt</a>=*(<span class="keyword">new</span> MatrixXd(6,6));</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#ab9715d36c9601773d84da2284414cb1b">velocity_final</a>=*(<span class="keyword">new</span> VectorXd(6,1));</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#abeb0fd3250e1b41800497eed5e30fbe5">velocity_visual</a>&lt;&lt;0,0,0,0,0,0;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#ab9715d36c9601773d84da2284414cb1b">velocity_final</a>&lt;&lt;0,0,0,0,0,0;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="comment">//************************visual servo**********************//</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">//************************force servo**********************//</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">//    if(ifUseForce)</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    {</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#a41f75d82693701c90081649f3dc38f6e">force_measureVec</a>=*(<span class="keyword">new</span> VectorXd(6,1));</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#aa6c3194cde43ea089008acbfea3abede">velocity_force</a>=*(<span class="keyword">new</span> VectorXd(6,1));</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#a372265169be6c94899228258042e15cc">force_initialForceV</a>=*(<span class="keyword">new</span> VectorXd(6,1));</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#ad2dd940b6a4afd60a6ebdd71728c4dab">force_error</a>=*(<span class="keyword">new</span> VectorXd(6,1));</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#ab6c289115af50da9dbe3e4ad2f24f8e8">force_errorOld</a>=*(<span class="keyword">new</span> VectorXd(6,1));</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#ad4657bd3ae72e16514b592cffd54f311">matrixKqInverse</a>=*(<span class="keyword">new</span> MatrixXd(6,6));</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#a87284b077f40d9fe18e96d1e4773b78a">kp_force</a>=*(<span class="keyword">new</span> MatrixXd(6,6));</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#a82571c86f896f6e73d65b5652be373cd">kd_force</a>=*(<span class="keyword">new</span> MatrixXd(6,6));</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">//        weightMatrix=*(new MatrixXd(6,6));</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#aa6c3194cde43ea089008acbfea3abede">velocity_force</a>&lt;&lt;0,0,0,0,0,0;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#abf35a3b77e8748c6e8051bf02daffab6">compensateValue</a>=5;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#a14b3367ffa0a3993dd9f76ddc740ab6a">thresholdDistance</a>=0.04;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#a755cec308b85962c1c86377900284d52">forceControlType</a>=2;  <span class="comment">//if =2, &quot;ifDecomposeForce&quot; choose false!!!!!!!!!!!!!</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#aba0e468ba78c40e5f3ff5346cd252f5c">forceDimension</a>=3;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    }</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="comment">//************************force servo**********************//</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">//    if(trackAngle)</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">//    {</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#a1250dd2cd8c97710f3fd8af8396ab070">trackAngleInitial</a>();</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">//    }</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;}</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">//***************************************Initial*****************************************//</span></div><div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="class_visual_servo_algorithm.html#a1250dd2cd8c97710f3fd8af8396ab070">   81</a></span>&#160;<span class="comment"></span><span class="keywordtype">void</span> <a class="code" href="class_visual_servo_algorithm.html#a1250dd2cd8c97710f3fd8af8396ab070">VisualServoAlgorithm:: trackAngleInitial</a>()</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;{</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">//    double D[5] = { 0 };</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">//    cam_matrix=Mat(3, 3, CV_64FC1, K);</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a3df8ca5454e4ba269f19bff13ab56672">objectPoints_PnP</a>.push_back(cv::Point3d(6.825897, 6.760612, 4.402142));     <span class="comment">//#33 left brow left corner</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a3df8ca5454e4ba269f19bff13ab56672">objectPoints_PnP</a>.push_back(cv::Point3d(1.330353, 7.122144, 6.903745));     <span class="comment">//#29 left brow right corner</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a3df8ca5454e4ba269f19bff13ab56672">objectPoints_PnP</a>.push_back(cv::Point3d(-1.330353, 7.122144, 6.903745));    <span class="comment">//#34 right brow left corner</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a3df8ca5454e4ba269f19bff13ab56672">objectPoints_PnP</a>.push_back(cv::Point3d(-6.825897, 6.760612, 4.402142));    <span class="comment">//#38 right brow right corner</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a3df8ca5454e4ba269f19bff13ab56672">objectPoints_PnP</a>.push_back(cv::Point3d(5.311432, 5.485328, 3.987654));     <span class="comment">//#13 left eye left corner</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a3df8ca5454e4ba269f19bff13ab56672">objectPoints_PnP</a>.push_back(cv::Point3d(1.789930, 5.393625, 4.413414));     <span class="comment">//#17 left eye right corner</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a3df8ca5454e4ba269f19bff13ab56672">objectPoints_PnP</a>.push_back(cv::Point3d(-1.789930, 5.393625, 4.413414));    <span class="comment">//#25 right eye left corner</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a3df8ca5454e4ba269f19bff13ab56672">objectPoints_PnP</a>.push_back(cv::Point3d(-5.311432, 5.485328, 3.987654));    <span class="comment">//#21 right eye right corner</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a3df8ca5454e4ba269f19bff13ab56672">objectPoints_PnP</a>.push_back(cv::Point3d(2.005628, 1.409845, 6.165652));     <span class="comment">//#55 nose left corner</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a3df8ca5454e4ba269f19bff13ab56672">objectPoints_PnP</a>.push_back(cv::Point3d(-2.005628, 1.409845, 6.165652));    <span class="comment">//#49 nose right corner</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a3df8ca5454e4ba269f19bff13ab56672">objectPoints_PnP</a>.push_back(cv::Point3d(2.774015, -2.080775, 5.048531));    <span class="comment">//#43 mouth left corner</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a3df8ca5454e4ba269f19bff13ab56672">objectPoints_PnP</a>.push_back(cv::Point3d(-2.774015, -2.080775, 5.048531));   <span class="comment">//#39 mouth right corner</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a3df8ca5454e4ba269f19bff13ab56672">objectPoints_PnP</a>.push_back(cv::Point3d(0.000000, -3.116408, 6.097667));    <span class="comment">//#45 mouth central bottom corner</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a3df8ca5454e4ba269f19bff13ab56672">objectPoints_PnP</a>.push_back(cv::Point3d(0.000000, -7.415691, 4.070434));    <span class="comment">//#6 chin corner</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a8323640cd530b33140efbcd0acd76def">dist_coeffs</a>=Mat(5, 1, CV_64FC1, <a class="code" href="_visual_servo_algorithm_8cpp.html#a5034861c92021af41db3a46bc814a34b">D</a>);</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a4056c904a094a5473551dc89e8066880">out_intrinsics</a> = cv::Mat(3, 3, CV_64FC1);</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a02d3400151a9bde296b2c6e555a6c42a">out_rotation</a> = cv::Mat(3, 3, CV_64FC1);</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a53442ff2fabf272cbef17dabb778116c">out_translation</a> = cv::Mat(3, 1, CV_64FC1);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a9f49448bb766719cb7fd91a70dcde88f">reprojectsrc</a>.push_back(cv::Point3d(10.0, 10.0, 10.0));</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a9f49448bb766719cb7fd91a70dcde88f">reprojectsrc</a>.push_back(cv::Point3d(10.0, 10.0, -10.0));</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a9f49448bb766719cb7fd91a70dcde88f">reprojectsrc</a>.push_back(cv::Point3d(10.0, -10.0, -10.0));</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a9f49448bb766719cb7fd91a70dcde88f">reprojectsrc</a>.push_back(cv::Point3d(10.0, -10.0, 10.0));</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a9f49448bb766719cb7fd91a70dcde88f">reprojectsrc</a>.push_back(cv::Point3d(-10.0, 10.0, 10.0));</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a9f49448bb766719cb7fd91a70dcde88f">reprojectsrc</a>.push_back(cv::Point3d(-10.0, 10.0, -10.0));</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a9f49448bb766719cb7fd91a70dcde88f">reprojectsrc</a>.push_back(cv::Point3d(-10.0, -10.0, -10.0));</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a9f49448bb766719cb7fd91a70dcde88f">reprojectsrc</a>.push_back(cv::Point3d(-10.0, -10.0, 10.0));</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#ae27970fe21617c6f3a6b44a11c93e697">reprojectdst</a>.resize(8);</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;}</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="class_visual_servo_algorithm.html#af37e074356d29f28f05ede2fe6c3c23b">  125</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_visual_servo_algorithm.html#af37e074356d29f28f05ede2fe6c3c23b">VisualServoAlgorithm::getInitialPose</a>()</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;{</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="class_visual_servo_algorithm.html#ac8d192693788b49498c48dd4b5df1e5a">ifExperiment</a>)</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    {</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        fstream magEyeData;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="keywordtype">string</span> magEyeDataPath= CMAKE_CURRENT_SOURCE_DIRS + string(<span class="stringliteral">&quot;/resource/visualServo/magEyeData/magEyeData.txt&quot;</span>);</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">//        cout&lt;&lt;endl&lt;&lt;&quot;read magEyeDataTxt: &quot;&lt;&lt;endl;</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        magEyeData.open(magEyeDataPath);</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>=0;<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>&lt;4;<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>++)</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        {</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;           <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;4;j++)</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;           {</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;             magEyeData&gt;&gt;<a class="code" href="class_visual_servo_algorithm.html#ad80e68d8a382415e6ad9eb4378f87d52">Tcam_to_trans</a>(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,j);    <span class="comment">// 改了类型</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;           }</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        }</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        magEyeData.close();</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#a621aded9c78914579772e4b1a8536965">Ttrans_to_cam</a>=<a class="code" href="class_visual_servo_algorithm.html#ad80e68d8a382415e6ad9eb4378f87d52">Tcam_to_trans</a>.inverse();</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="keywordflow">if</span>(!<a class="code" href="class_visual_servo_algorithm.html#af890adbfb3b33b42941cb835c7fadba8">ifUseSpeed</a>)</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        {</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            <span class="keywordtype">string</span> theoryData_path= CMAKE_CURRENT_SOURCE_DIRS + string(<span class="stringliteral">&quot;/resource/visualServo/experimentData/sensor2trans.txt&quot;</span>);</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            <span class="keywordtype">string</span> transformMats_path=CMAKE_CURRENT_SOURCE_DIRS + string(<span class="stringliteral">&quot;/resource/visualServo/experimentData/transformMats.txt&quot;</span>);</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            <span class="keywordtype">string</span> data_EndEffector_path=CMAKE_CURRENT_SOURCE_DIRS + string(<span class="stringliteral">&quot;/resource/visualServo/experimentData/endEffector.txt&quot;</span>);</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            <span class="keywordtype">string</span> data_featurePoints_path=CMAKE_CURRENT_SOURCE_DIRS + string(<span class="stringliteral">&quot;/resource/visualServo/experimentData/feature.txt&quot;</span>);</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            <span class="keywordtype">string</span> data_realTimeTarget_path=CMAKE_CURRENT_SOURCE_DIRS + string(<span class="stringliteral">&quot;/resource/visualServo/experimentData/data_realTimeTarget.txt&quot;</span>);</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            <span class="keywordtype">string</span> data_speed_path=CMAKE_CURRENT_SOURCE_DIRS + string(<span class="stringliteral">&quot;/resource/visualServo/experimentData/data_speed.txt&quot;</span>);</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            <span class="keywordtype">string</span> data_sensor2transPoint_path=CMAKE_CURRENT_SOURCE_DIRS + string(<span class="stringliteral">&quot;/resource/visualServo/experimentData/sensor2transPoint(click).txt&quot;</span>);</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            <span class="keywordtype">string</span> data_EndEffectorClick_path=CMAKE_CURRENT_SOURCE_DIRS + string(<span class="stringliteral">&quot;/resource/visualServo/experimentData/endEffectorClick.txt&quot;</span>);</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#aacf7aec1bfc84ab45635cca4623bd136">theoryData_sensor2trans</a>=ofstream(theoryData_path,ios_base::out);</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#a6152f3b7da3a366071bacfbe4f8dc639">transformMats</a>=ofstream(transformMats_path,ios_base::out);</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#a1d6856e222aeb89a555930774aec008b">data_EndEffector</a>=ofstream(data_EndEffector_path,ios_base::out);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#af4d0e3f25d10123d6c28b22865168a66">data_featurePoints</a>=ofstream(data_featurePoints_path,ios_base::out);</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#af83e0336208702c2a753d609661b4660">data_realTimeTarget</a>=ofstream(data_realTimeTarget_path,ios_base::out);</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#ac67b124eb3a917d72d25fb3fe1c66878">data_speed</a>=ofstream(data_speed_path,ios_base::out);</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#a6785e841b9cd0cb7adabe158936cc29c">data_sensor2transPointClick</a>=ofstream(data_sensor2transPoint_path,ios_base::out);</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#a2dd50b1de16d067abd986c5fcf07477a">data_EndEffectorClick</a>=ofstream(data_EndEffectorClick_path,ios_base::out);</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        }</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="class_visual_servo_algorithm.html#af890adbfb3b33b42941cb835c7fadba8">ifUseSpeed</a>)</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        {</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            <span class="comment">/********************************servo experiment*************************/</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            <span class="keywordtype">string</span> dataServo_target_path=CMAKE_CURRENT_SOURCE_DIRS + string(<span class="stringliteral">&quot;/resource/visualServo/experimentData_servo/dataServo_target.txt&quot;</span>);</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            <span class="keywordtype">string</span> dataServo_end_path=CMAKE_CURRENT_SOURCE_DIRS + string(<span class="stringliteral">&quot;/resource/visualServo/experimentData_servo/dataServo_end.txt&quot;</span>);</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            <span class="keywordtype">string</span> dataServo_finalSpeed_path=CMAKE_CURRENT_SOURCE_DIRS + string(<span class="stringliteral">&quot;/resource/visualServo/experimentData_servo/dataServo_finalSpeed.txt&quot;</span>);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            <span class="keywordtype">string</span> dataServo_jointSpeed_path=CMAKE_CURRENT_SOURCE_DIRS + string(<span class="stringliteral">&quot;/resource/visualServo/experimentData_servo/dataServo_jointSpeed.txt&quot;</span>);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            <span class="keywordtype">string</span> dataServo_forceError_path=CMAKE_CURRENT_SOURCE_DIRS + string(<span class="stringliteral">&quot;/resource/visualServo/experimentData_servo/dataServo_forceError.txt&quot;</span>);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            <span class="keywordtype">string</span> dataServo_visualSpeed_path=CMAKE_CURRENT_SOURCE_DIRS + string(<span class="stringliteral">&quot;/resource/visualServo/experimentData_servo/dataServo_visualSpeed.txt&quot;</span>);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            <span class="keywordtype">string</span> dataServo_forceSpeed_path=CMAKE_CURRENT_SOURCE_DIRS + string(<span class="stringliteral">&quot;/resource/visualServo/experimentData_servo/dataServo_forceSpeed.txt&quot;</span>);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            <span class="keywordtype">string</span> dataServo_endSpeed_path=CMAKE_CURRENT_SOURCE_DIRS + string(<span class="stringliteral">&quot;/resource/visualServo/experimentData_servo/dataServo_endSpeed.txt&quot;</span>);</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            <span class="keywordtype">string</span> dataServo_positionError_path=CMAKE_CURRENT_SOURCE_DIRS + string(<span class="stringliteral">&quot;/resource/visualServo/experimentData_servo/dataServo_positionError.txt&quot;</span>);</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#a985203c23f6ef2daece9bc6de4b46941">dataServo_target</a>=ofstream(dataServo_target_path,ios_base::out);</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#a3d50c65a387362104891c0b6ad54617a">dataServo_end</a>=ofstream(dataServo_end_path,ios_base::out);</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#a032e8a1498c52fd8f5ccb65ba16605e6">dataServo_endSpeed</a>=ofstream(dataServo_endSpeed_path,ios_base::out);</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#af0d56f94908f1a87dfc39370e55d7482">dataServo_jointSpeed</a>=ofstream(dataServo_jointSpeed_path,ios_base::out);</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#aaa16534a23caee98d7e0fa504d4f8150">dataServo_forceError</a>=ofstream(dataServo_forceError_path,ios_base::out);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#a24297f33904fb2bd505b908ab9164720">dataServo_positionError</a>=ofstream(dataServo_positionError_path,ios_base::out);</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#ac0d47d67d156b781a625812b8e1350a8">dataServo_finalSpeed</a>=ofstream(dataServo_finalSpeed_path,ios_base::out);</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#a2265806b9e8bba7a87aed10dd88e63e4">dataServo_visualSpeed</a>=ofstream(dataServo_visualSpeed_path,ios_base::out);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#a5e7c9ac495c000a03eb02b55fa03259d">dataServo_forceSpeed</a>=ofstream(dataServo_forceSpeed_path,ios_base::out);</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        }</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    }</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    fstream hand_eye_position;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordtype">string</span> handEyePath=CMAKE_CURRENT_SOURCE_DIRS + string(<span class="stringliteral">&quot;/resource/visualServo/handEyeData/handEyeData.txt&quot;</span>);  <span class="comment">// handEyeData</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    hand_eye_position.open(handEyePath);</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="class_visual_servo_algorithm.html#af890adbfb3b33b42941cb835c7fadba8">ifUseSpeed</a>&amp;&amp;<a class="code" href="class_visual_servo_algorithm.html#ab7b80eab269c73c1f2e604b695deb963">ifVisualServo</a>)</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    {</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#af8d4649ec4b6843dc50b07d0839d9e35">kp_visual_1</a>=0.9;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#a6b8e2cae91beb690e325f909e7ee879e">kp_visual_2</a>=0.015;  <span class="comment">//0.9</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#a94509ddcec8a2fdfed8fd0b5848fb6a2">kp_visual</a>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#af8d4649ec4b6843dc50b07d0839d9e35">kp_visual_1</a>,0, 0, 0, 0, 0,</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                    0 ,<a class="code" href="class_visual_servo_algorithm.html#af8d4649ec4b6843dc50b07d0839d9e35">kp_visual_1</a>, 0, 0, 0, 0,</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                    0, 0, <a class="code" href="class_visual_servo_algorithm.html#af8d4649ec4b6843dc50b07d0839d9e35">kp_visual_1</a>, 0, 0, 0,</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                    0 ,0, 0, <a class="code" href="class_visual_servo_algorithm.html#a6b8e2cae91beb690e325f909e7ee879e">kp_visual_2</a>, 0, 0,</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                    0 ,0 ,0 ,0 ,<a class="code" href="class_visual_servo_algorithm.html#a6b8e2cae91beb690e325f909e7ee879e">kp_visual_2</a>,0,</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                    0 ,0, 0, 0, 0, <a class="code" href="class_visual_servo_algorithm.html#a6b8e2cae91beb690e325f909e7ee879e">kp_visual_2</a>;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#a531b98477389ae04321e8579dd07528c">kd_visual_1</a>=0.07;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#a127c5c3b121d220790aa5e7277c707a4">kd_visual_2</a>=0; <span class="comment">//0.07</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#a8b757fbd59236596eca9be326873367b">kd_visual</a>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a531b98477389ae04321e8579dd07528c">kd_visual_1</a>,0, 0, 0, 0, 0,</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                    0 ,<a class="code" href="class_visual_servo_algorithm.html#a531b98477389ae04321e8579dd07528c">kd_visual_1</a>, 0, 0, 0, 0,</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                    0, 0, <a class="code" href="class_visual_servo_algorithm.html#a531b98477389ae04321e8579dd07528c">kd_visual_1</a>, 0, 0, 0,</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                    0 ,0, 0, <a class="code" href="class_visual_servo_algorithm.html#a127c5c3b121d220790aa5e7277c707a4">kd_visual_2</a>, 0, 0,</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                    0 ,0 ,0 ,0 ,<a class="code" href="class_visual_servo_algorithm.html#a127c5c3b121d220790aa5e7277c707a4">kd_visual_2</a>,0,</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                    0 ,0, 0, 0, 0, <a class="code" href="class_visual_servo_algorithm.html#a127c5c3b121d220790aa5e7277c707a4">kd_visual_2</a>;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>=0;<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>&lt;6;<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>++)</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        {</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#a04ff1215e42e29746aa58372e3773e57">error_positionLast</a>(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,0)=0;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        }</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    }</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>=0;<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>&lt;4;<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>++)</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    {</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;4;j++)</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;       {</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;         hand_eye_position&gt;&gt;<a class="code" href="class_visual_servo_algorithm.html#aaaab33ad7fa584237747adef5618b0cf">Tcam_to_armbase</a>(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,j);    <span class="comment">// 改了类型</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;       }</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    }</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    hand_eye_position.close();</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a5c58e315b7fd777f3c2662154bca7c15">Tarmbase_to_cam</a>= <a class="code" href="class_visual_servo_algorithm.html#aaaab33ad7fa584237747adef5618b0cf">Tcam_to_armbase</a>.inverse();</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#aeb01eae8ab5674cd6880020d36fe8c42">end_to_base</a>[0]=this-&gt;<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#ad353fcabaa6cd32ee5a3b6a49b0caa54">x</a>;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#aeb01eae8ab5674cd6880020d36fe8c42">end_to_base</a>[1]=this-&gt;<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#a5b077a16817aed4e303ba381bbd41d81">y</a>;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#aeb01eae8ab5674cd6880020d36fe8c42">end_to_base</a>[2]=this-&gt;<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#ae39948911d9073039718c7a64a1cb447">z</a>;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#aeb01eae8ab5674cd6880020d36fe8c42">end_to_base</a>[3]=this-&gt;<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#a4c88a09aa4c29b89265faa96dc347644">Rx</a>;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#aeb01eae8ab5674cd6880020d36fe8c42">end_to_base</a>[4]=this-&gt;<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#ad4582a7bf33bf2cc9d7d2e67c43f6f50">Ry</a>;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#aeb01eae8ab5674cd6880020d36fe8c42">end_to_base</a>[5]=this-&gt;<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#ae28178cf50e8d7a6cfcfe7504bca7c27">Rz</a>;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>=0;<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>&lt;6;<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>++)</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#aac1535f9e5028c92e8369c1a732a2f16">target_last</a>[<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>]=<a class="code" href="class_visual_servo_algorithm.html#aeb01eae8ab5674cd6880020d36fe8c42">end_to_base</a>[<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>];</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a25191327379f1fea4aa2c562924cb813">faceLast</a>[0]=<a class="code" href="class_visual_servo_algorithm.html#aeb01eae8ab5674cd6880020d36fe8c42">end_to_base</a>[0];</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a25191327379f1fea4aa2c562924cb813">faceLast</a>[1]=<a class="code" href="class_visual_servo_algorithm.html#aeb01eae8ab5674cd6880020d36fe8c42">end_to_base</a>[1];</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a25191327379f1fea4aa2c562924cb813">faceLast</a>[2]=<a class="code" href="class_visual_servo_algorithm.html#aeb01eae8ab5674cd6880020d36fe8c42">end_to_base</a>[2];</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="class_visual_servo_algorithm.html#abee3eb6c8256f98fe78b377dc9fb66a9">have_detect_face</a>)</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    {</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        qDebug()&lt;&lt;<span class="stringliteral">&quot;get initial pose:have detect face&quot;</span>&lt;&lt;endl;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#a9d90802392f05247103b1e572d1e67e7">getIllPoint</a>();</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    }</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    {</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        qDebug()&lt;&lt;<span class="stringliteral">&quot;Cannot detect face, head initial failed!!!&quot;</span>;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    }</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;}</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div><div class="line"><a name="l00259"></a><span class="lineno"><a class="line" href="class_visual_servo_algorithm.html#a9d90802392f05247103b1e572d1e67e7">  259</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_visual_servo_algorithm.html#a9d90802392f05247103b1e572d1e67e7">VisualServoAlgorithm:: getIllPoint</a>()</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;{</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a345ceba7a652a102a6257971be90fc00">getHeadCordinate</a>();</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    Eigen::Vector4d nose1_cam,nose2_cam,nose1_ur5,nose2_ur5,target_cam,target_ur5;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>=0;<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>&lt;3;<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>++)</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    {</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        nose1_cam(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,0)=<a class="code" href="class_visual_servo_algorithm.html#a9714d69516a47f681f105aefe5abc063">coordinate_3DpointInCam</a>[0](<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,0);</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        nose2_cam(i,0)=<a class="code" href="class_visual_servo_algorithm.html#a9714d69516a47f681f105aefe5abc063">coordinate_3DpointInCam</a>[3](<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,0);</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    }</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    nose1_cam(3,0)=1;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    nose2_cam(3,0)=1;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    nose1_ur5=<a class="code" href="class_visual_servo_algorithm.html#aaaab33ad7fa584237747adef5618b0cf">Tcam_to_armbase</a>*nose1_cam;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    nose2_ur5=<a class="code" href="class_visual_servo_algorithm.html#aaaab33ad7fa584237747adef5618b0cf">Tcam_to_armbase</a>*nose2_cam;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="class_visual_servo_algorithm.html#a2a3fe76520035cd0f5488224733142c8">targetSetByHand</a>)</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    {</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    }</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    {</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#ababfa5ab26f7a34b1a7132a496dfd544">end_to_headVec1</a>(0,0)=nose1_ur5(0,0)-<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#ad353fcabaa6cd32ee5a3b6a49b0caa54">x</a>;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#ababfa5ab26f7a34b1a7132a496dfd544">end_to_headVec1</a>(1,0)=nose1_ur5(1,0)-<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#a5b077a16817aed4e303ba381bbd41d81">y</a>;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#ababfa5ab26f7a34b1a7132a496dfd544">end_to_headVec1</a>(2,0)=nose1_ur5(2,0)-<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#ae39948911d9073039718c7a64a1cb447">z</a>;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#ababfa5ab26f7a34b1a7132a496dfd544">end_to_headVec1</a>(3,0)=1;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#a31eed52f484b157debe64dec1bd6298d">end_to_headVec2</a>(0,0)=(nose2_ur5(0,0)-<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#ad353fcabaa6cd32ee5a3b6a49b0caa54">x</a>);</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#a31eed52f484b157debe64dec1bd6298d">end_to_headVec2</a>(1,0)=(nose2_ur5(1,0)-<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#a5b077a16817aed4e303ba381bbd41d81">y</a>);</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#a31eed52f484b157debe64dec1bd6298d">end_to_headVec2</a>(2,0)=(nose2_ur5(2,0)-<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#ae39948911d9073039718c7a64a1cb447">z</a>);   <span class="comment">// !!!!!!!!!!!!!!!!111</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#a31eed52f484b157debe64dec1bd6298d">end_to_headVec2</a>(3,0)=1;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        qDebug()&lt;&lt;<span class="stringliteral">&quot;end_to_head1&quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#ababfa5ab26f7a34b1a7132a496dfd544">end_to_headVec1</a>(0,0)&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#ababfa5ab26f7a34b1a7132a496dfd544">end_to_headVec1</a>(1,0)&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#ababfa5ab26f7a34b1a7132a496dfd544">end_to_headVec1</a>(2,0)&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        qDebug()&lt;&lt;<span class="stringliteral">&quot;end_to_head2&quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a31eed52f484b157debe64dec1bd6298d">end_to_headVec2</a>(0,0)&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#ababfa5ab26f7a34b1a7132a496dfd544">end_to_headVec1</a>(1,0)&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#ababfa5ab26f7a34b1a7132a496dfd544">end_to_headVec1</a>(2,0)&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    }</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="comment">//for head pose tracking</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">//    if(trackAngle)</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    {</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <span class="comment">/***********************test_2************************/</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        Mat end_to_base_rotM;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        Matrix3d Rend_to_base_rotM;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        Vector3d end_to_head_ori;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#aa6542e4980dd93b6b0d933c7d2607615">getPose_Head_to_cam</a>();</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        Mat Rend_to_base_rotVec=(cv::Mat_&lt;double&gt; (3,1)&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#a4c88a09aa4c29b89265faa96dc347644">Rx</a>,<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#ad4582a7bf33bf2cc9d7d2e67c43f6f50">Ry</a>,<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#ae28178cf50e8d7a6cfcfe7504bca7c27">Rz</a>);</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        Rodrigues(Rend_to_base_rotVec,end_to_base_rotM);</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        cv2eigen(end_to_base_rotM,Rend_to_base_rotM);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <span class="comment">/***********************test_2************************/</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        Matrix4d Tend_to_base_test;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        Matrix4d Tcam_to_head_test;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>=0;<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>&lt;3;<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>++)</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        {</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            Tend_to_base_test(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,0)=Rend_to_base_rotM(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,0);</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            Tend_to_base_test(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,1)=Rend_to_base_rotM(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,1);</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;            Tend_to_base_test(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,2)=Rend_to_base_rotM(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,2);</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        }</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        Tend_to_base_test(0,3)=<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#ad353fcabaa6cd32ee5a3b6a49b0caa54">x</a>;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        Tend_to_base_test(1,3)=<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#a5b077a16817aed4e303ba381bbd41d81">y</a>;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        Tend_to_base_test(2,3)=<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#ae39948911d9073039718c7a64a1cb447">z</a>;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        Tend_to_base_test(3,0)=0;Tend_to_base_test(3,1)=0;Tend_to_base_test(3,2)=0;Tend_to_base_test(3,3)=1;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        Matrix4d Thead_to_cam;     <span class="comment">//  !!!!!!!!!!! Eginen 4*4矩阵</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        Matrix3d Rhead_to_cam_test;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        Rhead_to_cam_test=<a class="code" href="class_visual_servo_algorithm.html#a187aa41151a05730320fbc3ad23fc19d">Rcam_to_head_PnP</a>.inverse();<span class="comment">//pnp解算出人脸坐标系相对于相机坐标系的姿态3*3矩阵</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>=0;<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>&lt;3;<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>++)<span class="comment">//把前三列赋值给Thead_to_cam</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        {</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;            Thead_to_cam(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,0)=Rhead_to_cam_test(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,0);</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            Thead_to_cam(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,1)=Rhead_to_cam_test(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,1);</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;            Thead_to_cam(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,2)=Rhead_to_cam_test(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,2);</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;            Thead_to_cam(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,3)=nose2_cam(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,0);</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        }</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        Thead_to_cam(3,0)=0;Thead_to_cam(3,1)=0;Thead_to_cam(3,2)=0;Thead_to_cam(3,3)=1;<span class="comment">//把最后一列赋值给Thead_to_cam</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#a29a3b060141338eb8c2d95c69f5253ff">Thead_to_cam_RQ</a>=Thead_to_cam;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        Tcam_to_head_test=Thead_to_cam.inverse();</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#a49e21809f2067d76925d2d5a249ac648">Tend_to_head</a>=Tcam_to_head_test*<a class="code" href="class_visual_servo_algorithm.html#a5c58e315b7fd777f3c2662154bca7c15">Tarmbase_to_cam</a>*Tend_to_base_test;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="class_visual_servo_algorithm.html#ac8d192693788b49498c48dd4b5df1e5a">ifExperiment</a>&amp;&amp;(!<a class="code" href="class_visual_servo_algorithm.html#af890adbfb3b33b42941cb835c7fadba8">ifUseSpeed</a>))</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        {</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            emit <a class="code" href="class_visual_servo_algorithm.html#a60dbcc2f9388e147aa08b7484071c34e">signalMagneticTransMatrix</a>();</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            cout&lt;&lt;<span class="stringliteral">&quot;Tsensor_to_trans: &quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a786982135c49a73880cd69c6f7cfd19d">Tsensor_to_trans</a>&lt;&lt;endl;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#a1da03a0bc2f3d5920d052b911c011e3d">Thead_to_sensor</a>=<a class="code" href="class_visual_servo_algorithm.html#a786982135c49a73880cd69c6f7cfd19d">Tsensor_to_trans</a>.inverse()*<a class="code" href="class_visual_servo_algorithm.html#ad80e68d8a382415e6ad9eb4378f87d52">Tcam_to_trans</a>*Thead_to_cam;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            <span class="comment">//cout&lt;&lt;endl&lt;&lt;&quot;Thead_to_sensor: &quot;&lt;&lt;endl&lt;&lt;Thead_to_sensor&lt;&lt;endl;</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#a6152f3b7da3a366071bacfbe4f8dc639">transformMats</a>&lt;&lt;<span class="stringliteral">&quot;Tend2head&quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a49e21809f2067d76925d2d5a249ac648">Tend_to_head</a>&lt;&lt;endl&lt;&lt;<span class="stringliteral">&quot;Thead_to_sensor&quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a1da03a0bc2f3d5920d052b911c011e3d">Thead_to_sensor</a>&lt;&lt;endl&lt;&lt;<span class="stringliteral">&quot;Tsensor_to_trans&quot;</span>&lt;&lt;endl&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a786982135c49a73880cd69c6f7cfd19d">Tsensor_to_trans</a>&lt;&lt;endl&lt;&lt;<span class="stringliteral">&quot;Tend_to_base&quot;</span>&lt;&lt;Tend_to_base_test&lt;&lt;endl;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            <span class="comment">//Ttrans_to_base=Tcam_to_armbase*Ttrans_to_cam;</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        }</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    }</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">//    else</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    {</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="class_visual_servo_algorithm.html#ac8d192693788b49498c48dd4b5df1e5a">ifExperiment</a>&amp;&amp;(!<a class="code" href="class_visual_servo_algorithm.html#af890adbfb3b33b42941cb835c7fadba8">ifUseSpeed</a>))</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        {</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            Mat end_to_base_rotM;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;            Matrix3d Rend_to_base_rotM;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            Vector3d end_to_head_ori;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;            Mat Rend_to_base_rotVec=(cv::Mat_&lt;double&gt; (3,1)&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#a4c88a09aa4c29b89265faa96dc347644">Rx</a>,<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#ad4582a7bf33bf2cc9d7d2e67c43f6f50">Ry</a>,<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#ae28178cf50e8d7a6cfcfe7504bca7c27">Rz</a>);</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;            Rodrigues(Rend_to_base_rotVec,end_to_base_rotM);</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;            cv2eigen(end_to_base_rotM,Rend_to_base_rotM);</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            <span class="comment">/***********************test_2************************/</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            Matrix4d Tend_to_base_test;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            Matrix4d Tcam_to_head_test;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>=0;<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>&lt;3;<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>++)</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            {</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                Tend_to_base_test(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,0)=Rend_to_base_rotM(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,0);</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                Tend_to_base_test(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,1)=Rend_to_base_rotM(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,1);</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                Tend_to_base_test(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,2)=Rend_to_base_rotM(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,2);</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            }</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            Tend_to_base_test(0,3)=<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#ad353fcabaa6cd32ee5a3b6a49b0caa54">x</a>;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;            Tend_to_base_test(1,3)=<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#a5b077a16817aed4e303ba381bbd41d81">y</a>;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            Tend_to_base_test(2,3)=<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#ae39948911d9073039718c7a64a1cb447">z</a>;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            Tend_to_base_test(3,0)=0;Tend_to_base_test(3,1)=0;Tend_to_base_test(3,2)=0;Tend_to_base_test(3,3)=1;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            emit <a class="code" href="class_visual_servo_algorithm.html#a60dbcc2f9388e147aa08b7484071c34e">signalMagneticTransMatrix</a>();</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#a6152f3b7da3a366071bacfbe4f8dc639">transformMats</a>&lt;&lt;<span class="stringliteral">&quot;Tsensor_to_trans&quot;</span>&lt;&lt;endl&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a786982135c49a73880cd69c6f7cfd19d">Tsensor_to_trans</a>&lt;&lt;endl&lt;&lt;<span class="stringliteral">&quot;Tend_to_base&quot;</span>&lt;&lt;Tend_to_base_test&lt;&lt;endl;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        }</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    }</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;}</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">//***************************************Track*****************************************//</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div><div class="line"><a name="l00376"></a><span class="lineno"><a class="line" href="class_visual_servo_algorithm.html#a345ceba7a652a102a6257971be90fc00">  376</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_visual_servo_algorithm.html#a345ceba7a652a102a6257971be90fc00">VisualServoAlgorithm::getHeadCordinate</a>()  <span class="comment">//just get point</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;{</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="class_visual_servo_algorithm.html#abee3eb6c8256f98fe78b377dc9fb66a9">have_detect_face</a>)</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    {</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        Point3f temp;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        Vector3d point_temp;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#a9714d69516a47f681f105aefe5abc063">coordinate_3DpointInCam</a>.clear();</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>=0;<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>&lt;<a class="code" href="class_visual_servo_algorithm.html#aee7160ceecb6a13e3d624eb7a89a1946">feature_3Dpoints</a>.size();<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>++)</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        {</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;            point_temp(0,0)=<a class="code" href="class_visual_servo_algorithm.html#aee7160ceecb6a13e3d624eb7a89a1946">feature_3Dpoints</a>[<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>].x;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            point_temp(1,0)=<a class="code" href="class_visual_servo_algorithm.html#aee7160ceecb6a13e3d624eb7a89a1946">feature_3Dpoints</a>[<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>].y;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;            point_temp(2,0)=<a class="code" href="class_visual_servo_algorithm.html#aee7160ceecb6a13e3d624eb7a89a1946">feature_3Dpoints</a>[<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>].z;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#a9714d69516a47f681f105aefe5abc063">coordinate_3DpointInCam</a>.push_back(point_temp);</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        }</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        Eigen::Vector3d point_vec_tempX1,point_vec_tempY1,point_vec_tempX2,point_vec_tempY2;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        point_vec_tempX1=<a class="code" href="class_visual_servo_algorithm.html#a9714d69516a47f681f105aefe5abc063">coordinate_3DpointInCam</a>[3]-<a class="code" href="class_visual_servo_algorithm.html#a9714d69516a47f681f105aefe5abc063">coordinate_3DpointInCam</a>[0];</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        point_vec_tempX2=coordinate_3DpointInCam[2]-coordinate_3DpointInCam[1];</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#af42339c1422fc5cc281f3bc7945da65c">head_X_inCam</a>=(point_vec_tempX1+point_vec_tempX2)/2;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        point_vec_tempY1=coordinate_3DpointInCam[7]-coordinate_3DpointInCam[4];</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        point_vec_tempY2=coordinate_3DpointInCam[6]-coordinate_3DpointInCam[5];</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#a9085ecdc7ee9292a37c5235c99c7a03e">head_Y_inCam</a>=(point_vec_tempY1+point_vec_tempY2)/2;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#aaba3808e67b47180208c47ee681bb513">head_Z_inCam</a>=<a class="code" href="class_visual_servo_algorithm.html#af42339c1422fc5cc281f3bc7945da65c">head_X_inCam</a>.cross(<a class="code" href="class_visual_servo_algorithm.html#a9085ecdc7ee9292a37c5235c99c7a03e">head_Y_inCam</a>);</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#af42339c1422fc5cc281f3bc7945da65c">head_X_inCam</a>/=<a class="code" href="class_visual_servo_algorithm.html#af42339c1422fc5cc281f3bc7945da65c">head_X_inCam</a>.norm();</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#a9085ecdc7ee9292a37c5235c99c7a03e">head_Y_inCam</a>/=<a class="code" href="class_visual_servo_algorithm.html#a9085ecdc7ee9292a37c5235c99c7a03e">head_Y_inCam</a>.norm();</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#aaba3808e67b47180208c47ee681bb513">head_Z_inCam</a>/=<a class="code" href="class_visual_servo_algorithm.html#aaba3808e67b47180208c47ee681bb513">head_Z_inCam</a>.norm();</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#a8784388831a5c13feb80adae63a3b432">head_ori</a>=(coordinate_3DpointInCam[7]+coordinate_3DpointInCam[6]+coordinate_3DpointInCam[5]+coordinate_3DpointInCam[4])/4.0;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#aba8ecbac194304303e51ada1a6558245">T_head_to_cam</a>=Eigen::Isometry3d::Identity();</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>=0;<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>&lt;3;<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>++)</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        {</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;          <a class="code" href="class_visual_servo_algorithm.html#aba8ecbac194304303e51ada1a6558245">T_head_to_cam</a>(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,0)=<a class="code" href="class_visual_servo_algorithm.html#af42339c1422fc5cc281f3bc7945da65c">head_X_inCam</a>(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,0);</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;          <a class="code" href="class_visual_servo_algorithm.html#aba8ecbac194304303e51ada1a6558245">T_head_to_cam</a>(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,1)=<a class="code" href="class_visual_servo_algorithm.html#a9085ecdc7ee9292a37c5235c99c7a03e">head_Y_inCam</a>(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,0);</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;          <a class="code" href="class_visual_servo_algorithm.html#aba8ecbac194304303e51ada1a6558245">T_head_to_cam</a>(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,2)=<a class="code" href="class_visual_servo_algorithm.html#aaba3808e67b47180208c47ee681bb513">head_Z_inCam</a>(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,0);</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;          <a class="code" href="class_visual_servo_algorithm.html#aba8ecbac194304303e51ada1a6558245">T_head_to_cam</a>(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,3)=<a class="code" href="class_visual_servo_algorithm.html#a8784388831a5c13feb80adae63a3b432">head_ori</a>(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,0);</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        }</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    }</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;}</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div><div class="line"><a name="l00418"></a><span class="lineno"><a class="line" href="class_visual_servo_algorithm.html#aa6542e4980dd93b6b0d933c7d2607615">  418</a></span>&#160;Isometry3d <a class="code" href="class_visual_servo_algorithm.html#aa6542e4980dd93b6b0d933c7d2607615">VisualServoAlgorithm::getPose_Head_to_cam</a>()</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;{</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a9bb0ea8e64bfcc556c8398dae2029bce">sPnP</a>();</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#acfb710db4a4d59cf2f8aa369c126a825">Thead_to_cam_PnP</a>=Isometry3d::Identity();</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    Matrix3d temp_out_rotation;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    Vector3d temp_out_translation;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    cv2eigen(<a class="code" href="class_visual_servo_algorithm.html#a02d3400151a9bde296b2c6e555a6c42a">out_rotation</a>,temp_out_rotation);<span class="comment">//opencv的结构转换成engin的结构</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a187aa41151a05730320fbc3ad23fc19d">Rcam_to_head_PnP</a>=temp_out_rotation.inverse();<span class="comment">//temp_out_rotation是3*3的矩阵</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    cv2eigen(<a class="code" href="class_visual_servo_algorithm.html#a53442ff2fabf272cbef17dabb778116c">out_translation</a>,temp_out_translation);</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#acfb710db4a4d59cf2f8aa369c126a825">Thead_to_cam_PnP</a>.prerotate(temp_out_rotation);</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#acfb710db4a4d59cf2f8aa369c126a825">Thead_to_cam_PnP</a>.pretranslate(temp_out_translation);</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="class_visual_servo_algorithm.html#acfb710db4a4d59cf2f8aa369c126a825">Thead_to_cam_PnP</a>;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;}</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div><div class="line"><a name="l00433"></a><span class="lineno"><a class="line" href="class_visual_servo_algorithm.html#a9bb0ea8e64bfcc556c8398dae2029bce">  433</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_visual_servo_algorithm.html#a9bb0ea8e64bfcc556c8398dae2029bce">VisualServoAlgorithm::sPnP</a>()</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;{</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="comment">//objectPoints_PnP.clear();</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a408155cf6ae9175197a2e37366a4e4b9">image_Points_PnP</a>.clear();</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>=0;<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>&lt;14;<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>++)</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    {</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        <span class="comment">//objectPoints_PnP.push_back(feature_3Dpoints[i+8]);</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#a408155cf6ae9175197a2e37366a4e4b9">image_Points_PnP</a>.push_back(<a class="code" href="class_visual_servo_algorithm.html#a4838d8a68adc7e1a0c14eec2360f9f4c">feature_points</a>[<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>+8]);</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    }</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a5ab834a9163334da4d781eec82857cfa">cam_matrix</a>=Mat(3, 3, CV_64FC1, <a class="code" href="_visual_servo_algorithm_8cpp.html#a8e371173b7daec7c4f7f2e6422903af7">K</a>);</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a8323640cd530b33140efbcd0acd76def">dist_coeffs</a>=Mat(5, 1, CV_64FC1, <a class="code" href="_visual_servo_algorithm_8cpp.html#a5034861c92021af41db3a46bc814a34b">D</a>);</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    solvePnP(<a class="code" href="class_visual_servo_algorithm.html#a3df8ca5454e4ba269f19bff13ab56672">objectPoints_PnP</a>, <a class="code" href="class_visual_servo_algorithm.html#a408155cf6ae9175197a2e37366a4e4b9">image_Points_PnP</a>, <a class="code" href="class_visual_servo_algorithm.html#a5ab834a9163334da4d781eec82857cfa">cam_matrix</a>, <a class="code" href="class_visual_servo_algorithm.html#a8323640cd530b33140efbcd0acd76def">dist_coeffs</a>, <a class="code" href="class_visual_servo_algorithm.html#a6f623e949a3cb5d6cff4a94fd4ebf0a2">rotation_vec_PnP</a>, <a class="code" href="class_visual_servo_algorithm.html#aafa4ad63ed9be3b77f44d1a163bbe990">translation_vec_PnP</a>);<span class="comment">// repro!!</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="comment">//projectPoints(reprojectsrc, rotation_vec_PnP, translation_vec_PnP, cam_matrix, dist_coeffs, reprojectdst);</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    Rodrigues(<a class="code" href="class_visual_servo_algorithm.html#a6f623e949a3cb5d6cff4a94fd4ebf0a2">rotation_vec_PnP</a>,<a class="code" href="class_visual_servo_algorithm.html#acecff666c098d905c23e5b185daacde0">rotation_mat_PnP</a>);</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    hconcat(<a class="code" href="class_visual_servo_algorithm.html#acecff666c098d905c23e5b185daacde0">rotation_mat_PnP</a>, <a class="code" href="class_visual_servo_algorithm.html#aafa4ad63ed9be3b77f44d1a163bbe990">translation_vec_PnP</a>, <a class="code" href="class_visual_servo_algorithm.html#a7d87d385fdfd09eb07037c94258e55ef">pose_mat</a>);</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="comment">//cout&lt;&lt;&quot;rotation mat :  &quot;&lt;&lt;rotation_mat_PnP&lt;&lt;endl;</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a342b5b8a7064c166f2939c19bac88433">tempHeadPose</a>[0]=<a class="code" href="class_visual_servo_algorithm.html#acecff666c098d905c23e5b185daacde0">rotation_mat_PnP</a>.at&lt;<span class="keywordtype">double</span>&gt;(0,0);    <a class="code" href="class_visual_servo_algorithm.html#a342b5b8a7064c166f2939c19bac88433">tempHeadPose</a>[1]=<a class="code" href="class_visual_servo_algorithm.html#acecff666c098d905c23e5b185daacde0">rotation_mat_PnP</a>.at&lt;<span class="keywordtype">double</span>&gt;(1,0);    tempHeadPose[2]=<a class="code" href="class_visual_servo_algorithm.html#acecff666c098d905c23e5b185daacde0">rotation_mat_PnP</a>.at&lt;<span class="keywordtype">double</span>&gt;(2,0);</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    cv::decomposeProjectionMatrix(<a class="code" href="class_visual_servo_algorithm.html#a7d87d385fdfd09eb07037c94258e55ef">pose_mat</a>, <a class="code" href="class_visual_servo_algorithm.html#a4056c904a094a5473551dc89e8066880">out_intrinsics</a>, <a class="code" href="class_visual_servo_algorithm.html#a02d3400151a9bde296b2c6e555a6c42a">out_rotation</a>, <a class="code" href="class_visual_servo_algorithm.html#a53442ff2fabf272cbef17dabb778116c">out_translation</a>, cv::noArray(), cv::noArray(), cv::noArray(), <a class="code" href="class_visual_servo_algorithm.html#a7fe41859151a95e178b5de0e4ac8b68a">euler_angle</a>);</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;}</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;</div><div class="line"><a name="l00460"></a><span class="lineno"><a class="line" href="class_visual_servo_algorithm.html#ac304753f8fa8435b1ab684ee324c8861">  460</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_visual_servo_algorithm.html#ac304753f8fa8435b1ab684ee324c8861">VisualServoAlgorithm::detect_cycle</a>()</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;{</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="class_visual_servo_algorithm.html#abee3eb6c8256f98fe78b377dc9fb66a9">have_detect_face</a>)<span class="comment">//判断是否检测到人脸 have_detect_face是在uodateCaeraCvImageSlot里面把是否检测到的结果穿进去的</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    {</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        qDebug()&lt;&lt;<span class="stringliteral">&quot;cycle:have_detect_face=true&quot;</span>&lt;&lt;endl;<span class="comment">// 界面显示</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    }</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    {</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        qDebug()&lt;&lt;<span class="stringliteral">&quot;cycle:have_detect_face=false&quot;</span>&lt;&lt;endl;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    }</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">// *******************************visual servo******************************//</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment">//    if(have_detect_face&amp;&amp;trackHead&amp;&amp;ifUseSpeed)</span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="class_visual_servo_algorithm.html#abee3eb6c8256f98fe78b377dc9fb66a9">have_detect_face</a>&amp;&amp;<a class="code" href="class_visual_servo_algorithm.html#a940d3f27e05c517340b50fc86ba47e09">trackHead</a>&amp;&amp;(!<a class="code" href="class_visual_servo_algorithm.html#a87a834a88a092582b206c4327b47a5fa">ifReachTarget</a>))<span class="comment">//如果检测到人脸而且还点击了&quot;开始追踪&quot;按键 而且还没到达目标点 (trackHead标志位也是在uodateCaeraCvImageSlot中传值的)</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    {</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#ae126470dc9ce5767c9f25b3cfa6e409e">ifEnterForceMode</a>=<span class="keyword">false</span>;<span class="comment">//不启动力控模式</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        <span class="comment">/*****************************visual servo***********************/</span>    <span class="comment">//flag1</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="class_visual_servo_algorithm.html#ab7b80eab269c73c1f2e604b695deb963">ifVisualServo</a>)<span class="comment">//ifVisualServo在构造函数里面默认是true</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        {</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#af0fea33b6a33df48d2d97d1f72fe397d">track_head</a>();</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#af1ab554e59077ab1adc907684faac879">visualServoPD</a>();</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        }</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        <span class="comment">/*****************************visual servo***********************/</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        <span class="comment">/*****************************force control***********************/</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        <span class="keywordtype">double</span> eDistance=sqrt(pow(<a class="code" href="class_visual_servo_algorithm.html#a754b275c099792838405c663b9a2a848">error_position</a>[0],2)+pow(<a class="code" href="class_visual_servo_algorithm.html#a754b275c099792838405c663b9a2a848">error_position</a>[1],2)+pow(<a class="code" href="class_visual_servo_algorithm.html#a754b275c099792838405c663b9a2a848">error_position</a>[2],2));</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="class_visual_servo_algorithm.html#a4c7041ad81664e5e30077cb092507ee7">ifUseForce</a>&amp;&amp;(eDistance&lt;0.005))</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        {</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#a581feacfae37663fee336ab09d42c8e1">getForceError</a>();</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;            <span class="keywordflow">if</span>(!(<a class="code" href="class_visual_servo_algorithm.html#ad2dd940b6a4afd60a6ebdd71728c4dab">force_error</a>(2,0)&gt;-4&amp;&amp;<a class="code" href="class_visual_servo_algorithm.html#ad2dd940b6a4afd60a6ebdd71728c4dab">force_error</a>(2,0)&lt;4))</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;            {</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                <span class="comment">/*if(forceControlType==1)</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment">                {</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment">                    forceControlOne();</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment">                }</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment">                else */</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                <a class="code" href="class_visual_servo_algorithm.html#ae126470dc9ce5767c9f25b3cfa6e409e">ifEnterForceMode</a>=<span class="keyword">true</span>;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="class_visual_servo_algorithm.html#a755cec308b85962c1c86377900284d52">forceControlType</a>==2)</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                {</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                    <a class="code" href="class_visual_servo_algorithm.html#a5de5a6cbf65c0ccbe98527911d9e304a">forceControlTwo</a>();</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                }</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;            }</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;            {</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                <a class="code" href="class_visual_servo_algorithm.html#aa6c3194cde43ea089008acbfea3abede">velocity_force</a>&lt;&lt;0,0,0,0,0,0;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;            }</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#ab6c289115af50da9dbe3e4ad2f24f8e8">force_errorOld</a>=<a class="code" href="class_visual_servo_algorithm.html#ad2dd940b6a4afd60a6ebdd71728c4dab">force_error</a>;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;            cout&lt;&lt;<span class="stringliteral">&quot;velocity force:  &quot;</span>&lt;&lt;endl&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#aa6c3194cde43ea089008acbfea3abede">velocity_force</a>&lt;&lt;endl;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        }</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        {</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#aa6c3194cde43ea089008acbfea3abede">velocity_force</a>&lt;&lt;0,0,0,0,0,0;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        }</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        <span class="comment">/*****************************force control***********************/</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        <span class="comment">/*****************************hybrid control***********************/</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">//        weight=1;</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#a924ad3787aabf2d9f09fb92e72981fa0">getWeightMatrix</a>();</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        VectorXd velocity_visualTemp(6,1);velocity_visualTemp=(1-<a class="code" href="class_visual_servo_algorithm.html#ab08adb4c51432bad3e286c3550eb4587">weight</a>)*<a class="code" href="class_visual_servo_algorithm.html#abeb0fd3250e1b41800497eed5e30fbe5">velocity_visual</a>;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        VectorXd velocity_forceTemp(6,1);velocity_forceTemp=<a class="code" href="class_visual_servo_algorithm.html#ab08adb4c51432bad3e286c3550eb4587">weight</a>*<a class="code" href="class_visual_servo_algorithm.html#aa6c3194cde43ea089008acbfea3abede">velocity_force</a>;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#ab9715d36c9601773d84da2284414cb1b">velocity_final</a>=velocity_visualTemp+velocity_forceTemp;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">//        velocity_final=velocity_visual;</span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="class_visual_servo_algorithm.html#ac8d192693788b49498c48dd4b5df1e5a">ifExperiment</a>&amp;&amp;(<a class="code" href="class_visual_servo_algorithm.html#af890adbfb3b33b42941cb835c7fadba8">ifUseSpeed</a>))<span class="comment">//ifExperiment在构造函数里面默认是false</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        {</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;            <span class="comment">//target position</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#a985203c23f6ef2daece9bc6de4b46941">dataServo_target</a>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[0]&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[1]&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[2]&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[3]&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[4]&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[5]&lt;&lt;endl;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;            <span class="comment">//current position</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#a3d50c65a387362104891c0b6ad54617a">dataServo_end</a>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#ad353fcabaa6cd32ee5a3b6a49b0caa54">x</a>&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#a5b077a16817aed4e303ba381bbd41d81">y</a>&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#ae39948911d9073039718c7a64a1cb447">z</a>&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#a4c88a09aa4c29b89265faa96dc347644">Rx</a>&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#ad4582a7bf33bf2cc9d7d2e67c43f6f50">Ry</a>&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#ae28178cf50e8d7a6cfcfe7504bca7c27">Rz</a>&lt;&lt;endl;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;            <span class="comment">//current speed</span></div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#a032e8a1498c52fd8f5ccb65ba16605e6">dataServo_endSpeed</a>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#aacc797803bc4b9f441ca5d6c6b351cba">x_speed</a>&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#a06a0357d91e3c0463f4dc0746c6677a4">y_speed</a>&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#a9ff4428b606350b2e6278776f10cb484">z_speed</a>&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#aa17ebe6f933ad8f2c065754bfddb4bd2">Rx_speed</a>&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#a2a1969610c9ab46b922d5580be04d40c">Ry_speed</a>&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#a9bc86c1da135c6394dd143da968f463b">Rz_speed</a>&lt;&lt;endl;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#af0d56f94908f1a87dfc39370e55d7482">dataServo_jointSpeed</a>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a4041a8fc6cb6ca1cf0f5e6ab64753750">mCurrentRobotAngles</a>.<a class="code" href="classrobot_joint.html#a6b21b2b5e0600510525ae1e2c1962fa8">joint1_speed</a>&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a4041a8fc6cb6ca1cf0f5e6ab64753750">mCurrentRobotAngles</a>.<a class="code" href="classrobot_joint.html#a121309aaef0817db7d5b82d6e334eb7a">joint2_speed</a>&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a4041a8fc6cb6ca1cf0f5e6ab64753750">mCurrentRobotAngles</a>.<a class="code" href="classrobot_joint.html#a955842dfcb1857c418e7f821195b333a">joint3_speed</a>&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a4041a8fc6cb6ca1cf0f5e6ab64753750">mCurrentRobotAngles</a>.<a class="code" href="classrobot_joint.html#a87d8af20858b67656309ed09d8bd72ea">joint4_speed</a>&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a4041a8fc6cb6ca1cf0f5e6ab64753750">mCurrentRobotAngles</a>.<a class="code" href="classrobot_joint.html#a5be708bac63145b315856404f313f81b">joint5_speed</a>&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a4041a8fc6cb6ca1cf0f5e6ab64753750">mCurrentRobotAngles</a>.<a class="code" href="classrobot_joint.html#ad573113298735a17810790a1a0b9f578">joint6_speed</a>&lt;&lt;endl;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;            <span class="comment">//error force &amp;position</span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#aaa16534a23caee98d7e0fa504d4f8150">dataServo_forceError</a>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#ad2dd940b6a4afd60a6ebdd71728c4dab">force_error</a>&lt;&lt;endl;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#a24297f33904fb2bd505b908ab9164720">dataServo_positionError</a>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a754b275c099792838405c663b9a2a848">error_position</a>&lt;&lt;endl;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;            <span class="comment">//calculated speed</span></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#ac0d47d67d156b781a625812b8e1350a8">dataServo_finalSpeed</a>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#ab9715d36c9601773d84da2284414cb1b">velocity_final</a>&lt;&lt;endl;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#a2265806b9e8bba7a87aed10dd88e63e4">dataServo_visualSpeed</a>&lt;&lt;velocity_visualTemp&lt;&lt;endl;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#a5e7c9ac495c000a03eb02b55fa03259d">dataServo_forceSpeed</a>&lt;&lt;velocity_forceTemp&lt;&lt;endl;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        }</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        <span class="comment">/*****************************hybrid control***********************/</span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">//        RobotProxy::speedlpos(velocity_final(0,0),velocity_final(1,0),velocity_final(2,0),velocity_final(3,0),velocity_final(4,0),velocity_final(5,0),0.2,0.8);</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        <a class="code" href="class_robot_proxy.html#a64c0a6703c48f7fc34ffe86f8cde5eb0">RobotProxy::speedlpos</a>(<a class="code" href="class_visual_servo_algorithm.html#ab9715d36c9601773d84da2284414cb1b">velocity_final</a>(0,0),<a class="code" href="class_visual_servo_algorithm.html#ab9715d36c9601773d84da2284414cb1b">velocity_final</a>(1,0),<a class="code" href="class_visual_servo_algorithm.html#ab9715d36c9601773d84da2284414cb1b">velocity_final</a>(2,0),<a class="code" href="class_visual_servo_algorithm.html#ab9715d36c9601773d84da2284414cb1b">velocity_final</a>(3,0),<a class="code" href="class_visual_servo_algorithm.html#ab9715d36c9601773d84da2284414cb1b">velocity_final</a>(4,0),<a class="code" href="class_visual_servo_algorithm.html#ab9715d36c9601773d84da2284414cb1b">velocity_final</a>(5,0),0.08,0.20);</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#aac1535f9e5028c92e8369c1a732a2f16">target_last</a>[0]=<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#ad353fcabaa6cd32ee5a3b6a49b0caa54">x</a>;<a class="code" href="class_visual_servo_algorithm.html#aac1535f9e5028c92e8369c1a732a2f16">target_last</a>[1]=<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#a5b077a16817aed4e303ba381bbd41d81">y</a>;<a class="code" href="class_visual_servo_algorithm.html#aac1535f9e5028c92e8369c1a732a2f16">target_last</a>[2]=<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#ae39948911d9073039718c7a64a1cb447">z</a>;<a class="code" href="class_visual_servo_algorithm.html#aac1535f9e5028c92e8369c1a732a2f16">target_last</a>[3]=<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#a4c88a09aa4c29b89265faa96dc347644">Rx</a>;<a class="code" href="class_visual_servo_algorithm.html#aac1535f9e5028c92e8369c1a732a2f16">target_last</a>[4]=<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#ad4582a7bf33bf2cc9d7d2e67c43f6f50">Ry</a>;<a class="code" href="class_visual_servo_algorithm.html#aac1535f9e5028c92e8369c1a732a2f16">target_last</a>[5]=<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#ae28178cf50e8d7a6cfcfe7504bca7c27">Rz</a>;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        <span class="keywordflow">if</span>(sqrt(pow(<a class="code" href="class_visual_servo_algorithm.html#a754b275c099792838405c663b9a2a848">error_position</a>(0,0),2)+pow(<a class="code" href="class_visual_servo_algorithm.html#a754b275c099792838405c663b9a2a848">error_position</a>(1,0),2)+pow(<a class="code" href="class_visual_servo_algorithm.html#a754b275c099792838405c663b9a2a848">error_position</a>(2,0),2))&lt;0.003)</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        {</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#a87a834a88a092582b206c4327b47a5fa">ifReachTarget</a>=<span class="keyword">true</span>;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#a64f707a8fa1a248ce5e835024ae4b44a">trackAngle</a>=<span class="keyword">true</span>;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#a30023353986c42d8f665d6df66991eb5">ifChangeLastCommand</a>=<span class="keyword">true</span>;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;            cout&lt;&lt;<span class="stringliteral">&quot;mode change to positon!!!!!!!!!!!&quot;</span>&lt;&lt;endl;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        }</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        cout&lt;&lt;<span class="stringliteral">&quot;using servo!!!!!!!!!!&quot;</span>&lt;&lt;endl;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#a25191327379f1fea4aa2c562924cb813">faceLast</a>[0]=<a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[0];<a class="code" href="class_visual_servo_algorithm.html#a25191327379f1fea4aa2c562924cb813">faceLast</a>[1]=<a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[1];<a class="code" href="class_visual_servo_algorithm.html#a25191327379f1fea4aa2c562924cb813">faceLast</a>[2]=<a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[2];</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    }</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">// *******************************visual servo******************************//</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="class_visual_servo_algorithm.html#abee3eb6c8256f98fe78b377dc9fb66a9">have_detect_face</a>&amp;&amp;<a class="code" href="class_visual_servo_algorithm.html#a940d3f27e05c517340b50fc86ba47e09">trackHead</a>&amp;&amp;(<a class="code" href="class_visual_servo_algorithm.html#a87a834a88a092582b206c4327b47a5fa">ifReachTarget</a>))</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    {</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        <span class="comment">//qDebug()&lt;&lt;&quot;cycle: trackHead&quot;&lt;&lt;endl;</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        <span class="keywordtype">double</span> speed_now=sqrt(<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#aacc797803bc4b9f441ca5d6c6b351cba">x_speed</a>*<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#aacc797803bc4b9f441ca5d6c6b351cba">x_speed</a>+<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#a06a0357d91e3c0463f4dc0746c6677a4">y_speed</a>*<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#a06a0357d91e3c0463f4dc0746c6677a4">y_speed</a>+<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#a9ff4428b606350b2e6278776f10cb484">z_speed</a>*<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#a9ff4428b606350b2e6278776f10cb484">z_speed</a>);</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#af0fea33b6a33df48d2d97d1f72fe397d">track_head</a>();</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        <span class="keywordflow">if</span>((speed_now&lt;0.002)&amp;&amp;<a class="code" href="class_visual_servo_algorithm.html#ad30eb4d4269fe50a287cda7df0763b49">ifOnlyTrackAngle</a>==<span class="keyword">false</span>)</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        {</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;            <span class="keywordtype">double</span> error[3];</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;            <span class="keywordtype">double</span> errorAngle;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;            error[0]=<a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[0]-<a class="code" href="class_visual_servo_algorithm.html#aac1535f9e5028c92e8369c1a732a2f16">target_last</a>[0];</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;            error[1]=<a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[1]-target_last[1];</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;            error[2]=<a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[2]-target_last[2];</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="comment">//            errorAngle=abs((sqrt(pow(targetCommand[3],2)+pow(targetCommand[4],2)+pow(targetCommand[5],2)))-(sqrt(pow(target_last[3],2)+pow(target_last[4],2)+pow(target_last[5],2))));</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;            <span class="comment">//cout&lt;&lt;&quot;error:  &quot;&lt;&lt;error[0]&lt;&lt;&quot;  &quot;&lt;&lt;error[1]&lt;&lt;&quot;  &quot;&lt;&lt;error[2]&lt;&lt;&quot;  &quot;&lt;&lt;sqrt(error[0]*error[0]+error[1]*error[1]+error[2]*error[2]);</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="comment">//            cout&lt;&lt;&quot;angle error&quot;&lt;&lt;sqrt(pow(targetCommand[3],2)+pow(targetCommand[4],2)+pow(targetCommand[5],2));</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;            <span class="keywordtype">double</span> errorDistance=sqrt(pow(error[0],2)+pow(error[1],2)+pow(error[2],2));</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;            <span class="comment">/************mutipleMoves************/</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#a85d52fa336f1eaf4c76df45699bb66bf">lastCommand</a>[0]=<a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[0];<a class="code" href="class_visual_servo_algorithm.html#a85d52fa336f1eaf4c76df45699bb66bf">lastCommand</a>[1]=<a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[1];<a class="code" href="class_visual_servo_algorithm.html#a85d52fa336f1eaf4c76df45699bb66bf">lastCommand</a>[2]=<a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[2];</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;            <span class="keywordtype">double</span> faceError;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;            faceError=sqrt(pow(<a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[0]-<a class="code" href="class_visual_servo_algorithm.html#a25191327379f1fea4aa2c562924cb813">faceLast</a>[0],2)+pow(<a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[1]-<a class="code" href="class_visual_servo_algorithm.html#a25191327379f1fea4aa2c562924cb813">faceLast</a>[1],2)+pow(<a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[2]-<a class="code" href="class_visual_servo_algorithm.html#a25191327379f1fea4aa2c562924cb813">faceLast</a>[2],2));</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="class_visual_servo_algorithm.html#a30023353986c42d8f665d6df66991eb5">ifChangeLastCommand</a>)</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;            {</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                <a class="code" href="class_visual_servo_algorithm.html#a25191327379f1fea4aa2c562924cb813">faceLast</a>[0]=<a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[0];<a class="code" href="class_visual_servo_algorithm.html#a25191327379f1fea4aa2c562924cb813">faceLast</a>[1]=<a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[1];<a class="code" href="class_visual_servo_algorithm.html#a25191327379f1fea4aa2c562924cb813">faceLast</a>[2]=<a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[2];</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                <a class="code" href="class_visual_servo_algorithm.html#a30023353986c42d8f665d6df66991eb5">ifChangeLastCommand</a>=<span class="keyword">false</span>;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;            }</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            <span class="comment">/************mutipleMoves************/</span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="comment">//            cout&lt;&lt;&quot;before decision!!!!!&quot;&lt;&lt;endl;</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="comment">//            if(errorDistance&lt;0.016)   // angle variation</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="comment">//            {</span></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment">//                //do nothing</span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment">//                //cout&lt;&lt;&quot;do nothing &quot;&lt;&lt;endl;</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment">//            }</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;            <span class="comment">//else if(fabs(error[0])&lt;0.3&amp;&amp;fabs(error[1])&lt;0.3&amp;&amp;fabs(error[2])&lt;0.3&amp;&amp;faceError&lt;0.05)  //mutipleMoves</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="comment">//            else if(errorDistance&lt;0.3&amp;&amp;faceError&lt;0.008)</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="comment">//            else if(errorDistance&lt;0.3)//   &amp;&amp;faceError&lt;0.008</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="comment">//            if(errorDistance&lt;0.3)</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;            {</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                <a class="code" href="class_visual_servo_algorithm.html#a659be41d2db5ad190538446546a720bc">toolTarget</a>.<a class="code" href="class_tool_coordinate.html#ad353fcabaa6cd32ee5a3b6a49b0caa54">x</a>=<a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[0];</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                <a class="code" href="class_visual_servo_algorithm.html#a659be41d2db5ad190538446546a720bc">toolTarget</a>.<a class="code" href="class_tool_coordinate.html#a5b077a16817aed4e303ba381bbd41d81">y</a>=<a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[1];</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                <a class="code" href="class_visual_servo_algorithm.html#a659be41d2db5ad190538446546a720bc">toolTarget</a>.<a class="code" href="class_tool_coordinate.html#ae39948911d9073039718c7a64a1cb447">z</a>=<a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[2];</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                <a class="code" href="class_visual_servo_algorithm.html#a659be41d2db5ad190538446546a720bc">toolTarget</a>.<a class="code" href="class_tool_coordinate.html#a4c88a09aa4c29b89265faa96dc347644">Rx</a>=<a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[3];</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                <a class="code" href="class_visual_servo_algorithm.html#a659be41d2db5ad190538446546a720bc">toolTarget</a>.<a class="code" href="class_tool_coordinate.html#ad4582a7bf33bf2cc9d7d2e67c43f6f50">Ry</a>=<a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[4];</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                <a class="code" href="class_visual_servo_algorithm.html#a659be41d2db5ad190538446546a720bc">toolTarget</a>.<a class="code" href="class_tool_coordinate.html#ae28178cf50e8d7a6cfcfe7504bca7c27">Rz</a>=<a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[5];</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="comment">//                if(errorAngle&lt;3)</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="comment">//                {</span></div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="comment">//                    targetCommand[3]=target_last[3];targetCommand[4]=target_last[4];targetCommand[5]=target_last[5];</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="comment">//                }</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                cout&lt;&lt;<span class="stringliteral">&quot;send Signal:signal_1   &quot;</span>&lt;&lt;endl;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                qDebug()&lt;&lt;<span class="stringliteral">&quot;x  &quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a659be41d2db5ad190538446546a720bc">toolTarget</a>.<a class="code" href="class_tool_coordinate.html#ad353fcabaa6cd32ee5a3b6a49b0caa54">x</a>&lt;&lt;<span class="stringliteral">&quot;  y  &quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a659be41d2db5ad190538446546a720bc">toolTarget</a>.<a class="code" href="class_tool_coordinate.html#a5b077a16817aed4e303ba381bbd41d81">y</a>&lt;&lt;<span class="stringliteral">&quot;  z  &quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a659be41d2db5ad190538446546a720bc">toolTarget</a>.<a class="code" href="class_tool_coordinate.html#ae39948911d9073039718c7a64a1cb447">z</a>&lt;&lt;<span class="stringliteral">&quot;  Rx  &quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a659be41d2db5ad190538446546a720bc">toolTarget</a>.<a class="code" href="class_tool_coordinate.html#a4c88a09aa4c29b89265faa96dc347644">Rx</a>&lt;&lt;<span class="stringliteral">&quot;  Ry  &quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a659be41d2db5ad190538446546a720bc">toolTarget</a>.<a class="code" href="class_tool_coordinate.html#ad4582a7bf33bf2cc9d7d2e67c43f6f50">Ry</a>&lt;&lt;<span class="stringliteral">&quot;  Rz  &quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a659be41d2db5ad190538446546a720bc">toolTarget</a>.<a class="code" href="class_tool_coordinate.html#ae28178cf50e8d7a6cfcfe7504bca7c27">Rz</a>&lt;&lt;endl;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                <a class="code" href="class_robot_proxy.html#af4736f390ab857ccdfebbd3514ba8daf">RobotProxy::movelpos</a>(<a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[0],<a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[1],<a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[2],<a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[3],<a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[4],<a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[5],0.2,0.2);</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                cout&lt;&lt;<span class="stringliteral">&quot;positon mode send command!!!!!&quot;</span>&lt;&lt;endl;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                <span class="comment">//cout&lt;&lt;&quot;target_last:  &quot;;</span></div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>=0;<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>&lt;6;<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>++)</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                {</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                   target_last[<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>]=<a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>];</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                    <span class="comment">//cout&lt;&lt;&quot;target_last &quot;&lt;&lt;target_last[i];</span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                }</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                <span class="comment">//cout&lt;&lt;endl;</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;            }</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="comment">//            else</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="comment">//            {</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="comment">//                qDebug()&lt;&lt;&quot;the change is too big!!!!!!!!!!!!!!!!!&quot;&lt;&lt;endl;</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment">//            }</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="comment">//            if(faceError&gt;0.008)</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;            <span class="keywordtype">double</span> currentError=sqrt(pow(<a class="code" href="class_visual_servo_algorithm.html#a85d52fa336f1eaf4c76df45699bb66bf">lastCommand</a>[0]-<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#ad353fcabaa6cd32ee5a3b6a49b0caa54">x</a>,2)+pow(<a class="code" href="class_visual_servo_algorithm.html#a85d52fa336f1eaf4c76df45699bb66bf">lastCommand</a>[1]-<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#a5b077a16817aed4e303ba381bbd41d81">y</a>,2)+pow(<a class="code" href="class_visual_servo_algorithm.html#a85d52fa336f1eaf4c76df45699bb66bf">lastCommand</a>[2]-<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#ae39948911d9073039718c7a64a1cb447">z</a>,2));</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;            <span class="keywordflow">if</span>(currentError&lt;0.01)</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;            {</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                <a class="code" href="class_visual_servo_algorithm.html#a87a834a88a092582b206c4327b47a5fa">ifReachTarget</a>=<span class="keyword">false</span>;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                <a class="code" href="class_visual_servo_algorithm.html#a64f707a8fa1a248ce5e835024ae4b44a">trackAngle</a>=<span class="keyword">false</span>;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                cout&lt;&lt;<span class="stringliteral">&quot;mode change to servo!!!!!!!!!!!&quot;</span>&lt;&lt;endl;</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;            }</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        }</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="comment">//        if(ifExperiment&amp;&amp;(!ifUseSpeed))</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="comment">//        {</span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="comment"></span><span class="comment">//        }</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="comment">//        cout&lt;&lt;&quot;using position!!!!!!!!!!&quot;&lt;&lt;endl;</span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    }</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;}</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;</div><div class="line"><a name="l00656"></a><span class="lineno"><a class="line" href="class_visual_servo_algorithm.html#af1ab554e59077ab1adc907684faac879">  656</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_visual_servo_algorithm.html#af1ab554e59077ab1adc907684faac879">VisualServoAlgorithm::visualServoPD</a>()</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;{</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    VectorXd yD(6,1);</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    VectorXd yC(6,1);</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    yD(0,0)=<a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[0];yD(1,0)=<a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[1];yD(2,0)=<a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[2];yD(3,0)=<a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[3];yD(4,0)=<a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[4];yD(5,0)=<a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[5];</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    yC(0,0)=<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#ad353fcabaa6cd32ee5a3b6a49b0caa54">x</a>;yC(1,0)=<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#a5b077a16817aed4e303ba381bbd41d81">y</a>;yC(2,0)=<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#ae39948911d9073039718c7a64a1cb447">z</a>;yC(3,0)=<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#a4c88a09aa4c29b89265faa96dc347644">Rx</a>;yC(4,0)=<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#ad4582a7bf33bf2cc9d7d2e67c43f6f50">Ry</a>;yC(5,0)=<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#ae28178cf50e8d7a6cfcfe7504bca7c27">Rz</a>;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a754b275c099792838405c663b9a2a848">error_position</a>=yD-yC;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a90b8412ec228ef0dbb92a2fa87864919">error_positionDerivative</a>=(<a class="code" href="class_visual_servo_algorithm.html#a754b275c099792838405c663b9a2a848">error_position</a>-<a class="code" href="class_visual_servo_algorithm.html#a04ff1215e42e29746aa58372e3773e57">error_positionLast</a>)/<a class="code" href="_visual_servo_algorithm_8cpp.html#a4c45cdff103e6644a620ba5061509f22">frequency</a>;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="comment">//    cout&lt;&lt;&quot;error_positionLast:  &quot;&lt;&lt;endl&lt;&lt;error_positionLast&lt;&lt;endl;</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#af14a9c41cba03e0a224acac1a69dd109">selfAdapt</a>();</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a5f958ef24e662bd434538b887e844105">kp_visualAdapt</a>(3,3)=0;<a class="code" href="class_visual_servo_algorithm.html#a5f958ef24e662bd434538b887e844105">kp_visualAdapt</a>(4,4)=0;<a class="code" href="class_visual_servo_algorithm.html#a5f958ef24e662bd434538b887e844105">kp_visualAdapt</a>(5,5)=0;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#abeb0fd3250e1b41800497eed5e30fbe5">velocity_visual</a>=<a class="code" href="class_visual_servo_algorithm.html#a5f958ef24e662bd434538b887e844105">kp_visualAdapt</a>*<a class="code" href="class_visual_servo_algorithm.html#a754b275c099792838405c663b9a2a848">error_position</a>+<a class="code" href="class_visual_servo_algorithm.html#a9b402f1a244e0ad46ce92141f8b7d06a">kd_visualAdapt</a>*<a class="code" href="class_visual_servo_algorithm.html#a90b8412ec228ef0dbb92a2fa87864919">error_positionDerivative</a>;</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="comment">//    velocity_visual=kp_visualAdapt*error_position;</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="comment">//    cout&lt;&lt;&quot;kp_visualAdapt:&quot;&lt;&lt;endl&lt;&lt;kp_visualAdapt&lt;&lt;endl&lt;&lt;&quot;error_position&quot;&lt;&lt;endl&lt;&lt;error_position&lt;&lt;endl;</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="comment">//    cout&lt;&lt;&quot;error_positionDerivative&quot;&lt;&lt;endl&lt;&lt;error_positionDerivative&lt;&lt;endl;</span></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="comment">//    cout&lt;&lt;&quot;PD control&quot;&lt;&lt;endl&lt;&lt;kd_visualAdapt*error_positionDerivative&lt;&lt;endl;</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="comment">//    velocity_visual=kp_visualAdapt*error_position;</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="class_visual_servo_algorithm.html#a64f707a8fa1a248ce5e835024ae4b44a">trackAngle</a>)</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    {</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#abeb0fd3250e1b41800497eed5e30fbe5">velocity_visual</a>[3]=0;<a class="code" href="class_visual_servo_algorithm.html#abeb0fd3250e1b41800497eed5e30fbe5">velocity_visual</a>[4]=0;<a class="code" href="class_visual_servo_algorithm.html#abeb0fd3250e1b41800497eed5e30fbe5">velocity_visual</a>[5]=0;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    }</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#abeb0fd3250e1b41800497eed5e30fbe5">velocity_visual</a>[3]=0;<a class="code" href="class_visual_servo_algorithm.html#abeb0fd3250e1b41800497eed5e30fbe5">velocity_visual</a>[4]=0;<a class="code" href="class_visual_servo_algorithm.html#abeb0fd3250e1b41800497eed5e30fbe5">velocity_visual</a>[5]=0;<span class="comment">// !!!!!!!!!!!!!!</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    cout&lt;&lt;<span class="stringliteral">&quot;endl&quot;</span>&lt;&lt;<span class="stringliteral">&quot;angle speed&quot;</span>&lt;&lt;endl&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#abeb0fd3250e1b41800497eed5e30fbe5">velocity_visual</a>[3]&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#abeb0fd3250e1b41800497eed5e30fbe5">velocity_visual</a>[4]&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#abeb0fd3250e1b41800497eed5e30fbe5">velocity_visual</a>[5]&lt;&lt;endl;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <span class="keywordflow">if</span>(sqrt(pow(<a class="code" href="class_visual_servo_algorithm.html#a754b275c099792838405c663b9a2a848">error_position</a>(0,0),2)+pow(<a class="code" href="class_visual_servo_algorithm.html#a754b275c099792838405c663b9a2a848">error_position</a>(1,0),2)+pow(<a class="code" href="class_visual_servo_algorithm.html#a754b275c099792838405c663b9a2a848">error_position</a>(2,0),2))&lt;0.01)   <span class="comment">//threshold</span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    {</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="comment">//        velocity_visual[0]=0;velocity_visual[1]=0;velocity_visual[2]=0;</span></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    }</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a04ff1215e42e29746aa58372e3773e57">error_positionLast</a>=<a class="code" href="class_visual_servo_algorithm.html#a754b275c099792838405c663b9a2a848">error_position</a>;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="comment">//    RobotProxy::speedlpos(velocity_visual[0],velocity_visual[1],velocity_visual[2],velocity_visual[3],velocity_visual[4],velocity_visual[5],0.8,1.2);</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;}</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;</div><div class="line"><a name="l00690"></a><span class="lineno"><a class="line" href="class_visual_servo_algorithm.html#af14a9c41cba03e0a224acac1a69dd109">  690</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_visual_servo_algorithm.html#af14a9c41cba03e0a224acac1a69dd109">VisualServoAlgorithm::selfAdapt</a>()</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;{</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    VectorXd error_temp=<a class="code" href="class_visual_servo_algorithm.html#a754b275c099792838405c663b9a2a848">error_position</a>;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <span class="keywordtype">int</span> times=1.2;<span class="keywordtype">int</span> powN=2.7; <span class="keywordtype">int</span> <a class="code" href="_p_d_8m.html#ade64d4b891680caa3d6bb56d9d81e272">kp_coef</a>=2; <span class="keywordtype">int</span> powN_d=2.7; <span class="keywordtype">double</span> <a class="code" href="_p_d_8m.html#a6e8ece5f28c087abd2dc870fd74db230">kd_coef</a>=0.5; <span class="keywordtype">double</span> times_d=1;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="comment">//    VectorXd one(6,1);</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="comment">//    one&lt;&lt;1,1,1,1,1,1;</span></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>=0;<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>&lt;6;<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>++)</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    {</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        error_temp(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,0)=abs(error_temp(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,0));</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#a5f958ef24e662bd434538b887e844105">kp_visualAdapt</a>(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>)=<a class="code" href="class_visual_servo_algorithm.html#a94509ddcec8a2fdfed8fd0b5848fb6a2">kp_visual</a>(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>)+kp_coef*(pow(powN,(times*error_temp(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,0))));</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#a9b402f1a244e0ad46ce92141f8b7d06a">kd_visualAdapt</a>(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>)=<a class="code" href="class_visual_servo_algorithm.html#a8b757fbd59236596eca9be326873367b">kd_visual</a>(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>)+kd_coef*(pow(powN_d,(times_d*error_temp(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,0))));</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    }</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="comment">//    cout&lt;&lt;&quot;~~&quot;&lt;&lt;endl&lt;&lt;&quot;kp&quot;&lt;&lt;endl&lt;&lt;kp_visualAdapt&lt;&lt;endl&lt;&lt;&quot;kd&quot;&lt;&lt;endl&lt;&lt;kd_visualAdapt&lt;&lt;endl&lt;&lt;&quot;~~&quot;&lt;&lt;endl;</span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;}</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;</div><div class="line"><a name="l00705"></a><span class="lineno"><a class="line" href="class_visual_servo_algorithm.html#af0fea33b6a33df48d2d97d1f72fe397d">  705</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_visual_servo_algorithm.html#af0fea33b6a33df48d2d97d1f72fe397d">VisualServoAlgorithm::track_head</a>()</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;{</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a345ceba7a652a102a6257971be90fc00">getHeadCordinate</a>();</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="class_visual_servo_algorithm.html#a64f707a8fa1a248ce5e835024ae4b44a">trackAngle</a>)</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    {</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        Vector4d nose2_cam;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        nose2_cam(0,0)= <a class="code" href="class_visual_servo_algorithm.html#aee7160ceecb6a13e3d624eb7a89a1946">feature_3Dpoints</a>[3].x;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        nose2_cam(1,0)= <a class="code" href="class_visual_servo_algorithm.html#aee7160ceecb6a13e3d624eb7a89a1946">feature_3Dpoints</a>[3].y;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        nose2_cam(2,0)= <a class="code" href="class_visual_servo_algorithm.html#aee7160ceecb6a13e3d624eb7a89a1946">feature_3Dpoints</a>[3].z;</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        nose2_cam(3,0)= 1;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        <span class="comment">// PnP!!!!!!</span></div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#aa6542e4980dd93b6b0d933c7d2607615">getPose_Head_to_cam</a>();</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        Matrix3d Rend_to_base_targetMat;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        Matrix3d Rhead_to_cam;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        Mat Rend_to_base_targetCVMat;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        Mat Rend_to_base_targetCVVec;</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        Rhead_to_cam=<a class="code" href="class_visual_servo_algorithm.html#a187aa41151a05730320fbc3ad23fc19d">Rcam_to_head_PnP</a>.inverse();</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        <span class="comment">//Rend_to_base_targetMat=Rcam_to_base_rot*Rhead_to_cam*Rend_to_head;  //CORE!!!!!</span></div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        Matrix4d Tend_to_base_targetMat;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        Matrix4d T_head_to_cam_Rt;</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>=0;<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>&lt;3;<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>++)</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        {</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;            T_head_to_cam_Rt(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,0)=Rhead_to_cam(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,0);</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;            T_head_to_cam_Rt(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,1)=Rhead_to_cam(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,1);</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;            T_head_to_cam_Rt(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,2)=Rhead_to_cam(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,2);</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;            T_head_to_cam_Rt(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,3)=nose2_cam(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,0);</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;        }</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        T_head_to_cam_Rt(3,0)=0;T_head_to_cam_Rt(3,1)=0;T_head_to_cam_Rt(3,2)=0;T_head_to_cam_Rt(3,3)=1;</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="comment">//        Vector4d testTranslate;</span></div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="comment">//        Vector4d testTarget;</span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="comment">//        for(int i=0;i&lt;4;i++)</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="comment">//        {</span></div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="comment">//            testTranslate(i,0)=Tend_to_head(i,3);</span></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="comment">//        }</span></div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        <span class="comment">//Tend_to_base_targetMat=Tcam_to_armbase*T_head_to_cam_Rt*Tend_to_head;</span></div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;        Tend_to_base_targetMat=<a class="code" href="class_visual_servo_algorithm.html#aaaab33ad7fa584237747adef5618b0cf">Tcam_to_armbase</a>*T_head_to_cam_Rt*<a class="code" href="class_visual_servo_algorithm.html#a49e21809f2067d76925d2d5a249ac648">Tend_to_head</a>;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="comment">//        testTarget=Tcam_to_armbase*T_head_to_cam_Rt*testTranslate;</span></div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>=0;<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>&lt;3;<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>++)</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        {</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;            Rend_to_base_targetMat(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,0)=Tend_to_base_targetMat(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,0);</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;            Rend_to_base_targetMat(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,1)=Tend_to_base_targetMat(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,1);</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;            Rend_to_base_targetMat(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,2)=Tend_to_base_targetMat(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,2);</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        }</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        eigen2cv(Rend_to_base_targetMat,Rend_to_base_targetCVMat);</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        Rodrigues(Rend_to_base_targetCVMat,Rend_to_base_targetCVVec);</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[0]=Tend_to_base_targetMat(0,3);</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[1]=Tend_to_base_targetMat(1,3);</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[2]=Tend_to_base_targetMat(2,3);</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="comment">//        targetCommand[0]=target_last[0];</span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;<span class="comment">//        targetCommand[1]=target_last[1];</span></div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="comment">//        targetCommand[2]=target_last[2];</span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        <span class="comment">//cout&lt;&lt;&quot;Tend_to_head:  &quot;&lt;&lt;endl&lt;&lt;Tend_to_head&lt;&lt;endl;</span></div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;        <span class="comment">//cout&lt;&lt;&quot;nose2_cam:  &quot;&lt;&lt;nose2_cam(0,0)&lt;&lt;&quot;  &quot;&lt;&lt;nose2_cam(1,0)&lt;&lt;&quot;  &quot;&lt;&lt;nose2_cam(2,0)&lt;&lt;&quot;  &quot;&lt;&lt;endl;</span></div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        <span class="comment">//cout&lt;&lt;&quot;T_head_to_cam_Rt: &quot;&lt;&lt;T_head_to_cam_Rt(0,3)&lt;&lt;&quot;  &quot;&lt;&lt;T_head_to_cam_Rt(1,3)&lt;&lt;&quot;  &quot;&lt;&lt;T_head_to_cam_Rt(2,3)&lt;&lt;&quot;  &quot;&lt;&lt;endl;</span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        <span class="comment">//cout&lt;&lt;&quot;Tend_to_head:   &quot;&lt;&lt;Tend_to_head(0,3)&lt;&lt;&quot;  &quot;&lt;&lt;Tend_to_head(1,3)&lt;&lt;&quot;  &quot;&lt;&lt;Tend_to_head(2,3)&lt;&lt;&quot;  &quot;&lt;&lt;&quot;initial distance:  &quot;&lt;&lt;sqrt(Tend_to_head(0,3)*Tend_to_head(0,3)+Tend_to_head(1,3)*Tend_to_head(1,3)+Tend_to_head(2,3)*Tend_to_head(2,3))&lt;&lt;endl;</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        <span class="comment">//cout&lt;&lt;&quot;Thead_to_cam_Rt:  &quot;&lt;&lt;endl&lt;&lt;T_head_to_cam_Rt&lt;&lt;endl;</span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        <span class="comment">//cout&lt;&lt;&quot;Tcam_to_base:  &quot;&lt;&lt;Tcam_to_armbase.matrix()&lt;&lt;endl;</span></div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        <span class="comment">//cout&lt;&lt;&quot;Tend_to_base_targetMat:  &quot;&lt;&lt;endl&lt;&lt;Tend_to_base_targetMat&lt;&lt;endl;</span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        <span class="comment">//cout&lt;&lt;&quot;testTarget:  &quot;&lt;&lt;testTarget(0,0)&lt;&lt;&quot;  &quot;&lt;&lt;testTarget(1,0)&lt;&lt;&quot;  &quot;&lt;&lt;testTarget(2,0)&lt;&lt;&quot;  &quot;&lt;&lt;&quot;test distance:  &quot;&lt;&lt;sqrt(testTarget(0,0)*testTarget(0,0)+testTarget(1,0)*testTarget(1,0)+testTarget(2,0)*testTarget(2,0));</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        <span class="comment">//cout&lt;&lt;&quot;targetCommand:  &quot;&lt;&lt;targetCommand[0]&lt;&lt;&quot;  &quot;&lt;&lt;targetCommand[1]&lt;&lt;&quot;  &quot;&lt;&lt;targetCommand[2]&lt;&lt;&quot;  &quot;&lt;&lt;&quot;target distance:  &quot;&lt;&lt;sqrt(targetCommand[0]*targetCommand[0]+targetCommand[1]*targetCommand[1]+targetCommand[2]*targetCommand[2])&lt;&lt;endl;</span></div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;        <span class="keywordtype">double</span> error[3];</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        error[0]=<a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[0]-<a class="code" href="class_visual_servo_algorithm.html#aac1535f9e5028c92e8369c1a732a2f16">target_last</a>[0];</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;        error[1]=<a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[1]-target_last[1];</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;        error[2]=<a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[2]-target_last[2];</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        <span class="comment">//cout&lt;&lt;&quot;error:  &quot;&lt;&lt;error[0]&lt;&lt;&quot;  &quot;&lt;&lt;error[1]&lt;&lt;&quot;  &quot;&lt;&lt;error[2]&lt;&lt;&quot;  &quot;&lt;&lt;&quot;distance  &quot;&lt;&lt;sqrt(error[0]*error[0]+error[1]*error[1]+error[2]*error[2])&lt;&lt;endl;</span></div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[3]=Rend_to_base_targetCVVec.at&lt;<span class="keywordtype">double</span>&gt;(0,0);</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[4]=Rend_to_base_targetCVVec.at&lt;<span class="keywordtype">double</span>&gt;(1,0);</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        targetCommand[5]=Rend_to_base_targetCVVec.at&lt;<span class="keywordtype">double</span>&gt;(2,0);</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    }</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    {</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;        Vector4d nose1_cam,nose2_cam,nose1_ur5,nose2_ur5;</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;        nose1_cam(0,0)= <a class="code" href="class_visual_servo_algorithm.html#aee7160ceecb6a13e3d624eb7a89a1946">feature_3Dpoints</a>[0].x;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;        nose1_cam(1,0)= <a class="code" href="class_visual_servo_algorithm.html#aee7160ceecb6a13e3d624eb7a89a1946">feature_3Dpoints</a>[0].y;</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;        nose1_cam(2,0)= <a class="code" href="class_visual_servo_algorithm.html#aee7160ceecb6a13e3d624eb7a89a1946">feature_3Dpoints</a>[0].z;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        nose1_cam(3,0)= 1;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        nose2_cam(0,0)= <a class="code" href="class_visual_servo_algorithm.html#aee7160ceecb6a13e3d624eb7a89a1946">feature_3Dpoints</a>[3].x;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        nose2_cam(1,0)= <a class="code" href="class_visual_servo_algorithm.html#aee7160ceecb6a13e3d624eb7a89a1946">feature_3Dpoints</a>[3].y;</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        nose2_cam(2,0)= <a class="code" href="class_visual_servo_algorithm.html#aee7160ceecb6a13e3d624eb7a89a1946">feature_3Dpoints</a>[3].z;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        nose2_cam(3,0)= 1;</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;        nose1_cam(3,0)= 1;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        nose1_ur5=<a class="code" href="class_visual_servo_algorithm.html#aaaab33ad7fa584237747adef5618b0cf">Tcam_to_armbase</a>*nose1_cam;</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        nose2_ur5=<a class="code" href="class_visual_servo_algorithm.html#aaaab33ad7fa584237747adef5618b0cf">Tcam_to_armbase</a>*nose2_cam;</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="comment">//        //  !!!!!!!!!set nose tip to to be the target</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="comment">//        targetCommand[0]=feature_3Dpoints[3].x;</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="comment">//        targetCommand[1]=feature_3Dpoints[3].y;</span></div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="comment">//        targetCommand[2]=feature_3Dpoints[3].z;</span></div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="comment">//        targetCommand[3]=target_last[3];</span></div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="comment">//        targetCommand[4]=target_last[4];</span></div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="comment">//        targetCommand[5]=target_last[5];</span></div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        <span class="comment">//change 0519</span></div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[0]=(nose1_ur5(0,0)-<a class="code" href="class_visual_servo_algorithm.html#ababfa5ab26f7a34b1a7132a496dfd544">end_to_headVec1</a>(0,0)+nose2_ur5(0,0)-<a class="code" href="class_visual_servo_algorithm.html#a31eed52f484b157debe64dec1bd6298d">end_to_headVec2</a>(0,0))/2.0;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[1]=(nose1_ur5(1,0)-<a class="code" href="class_visual_servo_algorithm.html#ababfa5ab26f7a34b1a7132a496dfd544">end_to_headVec1</a>(1,0)+nose2_ur5(1,0)-<a class="code" href="class_visual_servo_algorithm.html#a31eed52f484b157debe64dec1bd6298d">end_to_headVec2</a>(1,0))/2.0;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[2]=(nose1_ur5(2,0)-<a class="code" href="class_visual_servo_algorithm.html#ababfa5ab26f7a34b1a7132a496dfd544">end_to_headVec1</a>(2,0)+nose2_ur5(2,0)-<a class="code" href="class_visual_servo_algorithm.html#a31eed52f484b157debe64dec1bd6298d">end_to_headVec2</a>(2,0))/2.0;</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[3]=<a class="code" href="class_visual_servo_algorithm.html#aac1535f9e5028c92e8369c1a732a2f16">target_last</a>[3];</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[4]=<a class="code" href="class_visual_servo_algorithm.html#aac1535f9e5028c92e8369c1a732a2f16">target_last</a>[4];</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">targetCommand</a>[5]=<a class="code" href="class_visual_servo_algorithm.html#aac1535f9e5028c92e8369c1a732a2f16">target_last</a>[5];</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    }</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;}</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;</div><div class="line"><a name="l00821"></a><span class="lineno"><a class="line" href="class_visual_servo_algorithm.html#a6e2a0a2b8b64cee72c33ecb81f1bc09a">  821</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_visual_servo_algorithm.html#a6e2a0a2b8b64cee72c33ecb81f1bc09a">VisualServoAlgorithm::getExpData</a>()</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;{</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="class_visual_servo_algorithm.html#ac8d192693788b49498c48dd4b5df1e5a">ifExperiment</a>&amp;&amp;(!<a class="code" href="class_visual_servo_algorithm.html#af890adbfb3b33b42941cb835c7fadba8">ifUseSpeed</a>))</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    {</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#a6785e841b9cd0cb7adabe158936cc29c">data_sensor2transPointClick</a>&lt;&lt;this-&gt;<a class="code" href="class_visual_servo_algorithm.html#a786982135c49a73880cd69c6f7cfd19d">Tsensor_to_trans</a>&lt;&lt;endl;</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#a2dd50b1de16d067abd986c5fcf07477a">data_EndEffectorClick</a>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#ad353fcabaa6cd32ee5a3b6a49b0caa54">x</a>&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#a5b077a16817aed4e303ba381bbd41d81">y</a>&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#ae39948911d9073039718c7a64a1cb447">z</a>&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#a4c88a09aa4c29b89265faa96dc347644">Rx</a>&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#ad4582a7bf33bf2cc9d7d2e67c43f6f50">Ry</a>&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#ae28178cf50e8d7a6cfcfe7504bca7c27">Rz</a>&lt;&lt;endl;</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    }</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;}</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;</div><div class="line"><a name="l00837"></a><span class="lineno"><a class="line" href="class_visual_servo_algorithm.html#a015a8e65e2cd015fdba54eacd906b7f0">  837</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_visual_servo_algorithm.html#a015a8e65e2cd015fdba54eacd906b7f0">VisualServoAlgorithm::slotOpenForceSensor</a>()</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;{</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="class_visual_servo_algorithm.html#a4c7041ad81664e5e30077cb092507ee7">ifUseForce</a>)</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    {</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;        <span class="keywordtype">bool</span> ifForceOpen=<a class="code" href="ftusb_8cpp.html#a3a69a05a8138547d5c8e10437c359c0f">open_sensor</a>();</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#adb164a1ebbc53f45a9e6d263755891cd">forceControlOne_initial</a>();</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        <span class="keywordflow">if</span>(ifForceOpen)</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        {</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#a97cf44120b818f0fa90252de66a8ca82">forcevalue1</a>=<a class="code" href="ftusb_8cpp.html#a7b8ff57e555872b432b085a4a9e6d201">force_measure</a>();</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#a97cf44120b818f0fa90252de66a8ca82">forcevalue1</a>[0]=<a class="code" href="class_visual_servo_algorithm.html#a97cf44120b818f0fa90252de66a8ca82">forcevalue1</a>[0]/10;</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#a97cf44120b818f0fa90252de66a8ca82">forcevalue1</a>[1]=<a class="code" href="class_visual_servo_algorithm.html#a97cf44120b818f0fa90252de66a8ca82">forcevalue1</a>[1]/10;</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#a97cf44120b818f0fa90252de66a8ca82">forcevalue1</a>[2]=<a class="code" href="class_visual_servo_algorithm.html#a97cf44120b818f0fa90252de66a8ca82">forcevalue1</a>[2]/10;</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#a97cf44120b818f0fa90252de66a8ca82">forcevalue1</a>[3]=<a class="code" href="class_visual_servo_algorithm.html#a97cf44120b818f0fa90252de66a8ca82">forcevalue1</a>[3]/1000;</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#a97cf44120b818f0fa90252de66a8ca82">forcevalue1</a>[4]=<a class="code" href="class_visual_servo_algorithm.html#a97cf44120b818f0fa90252de66a8ca82">forcevalue1</a>[4]/1000;</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#a97cf44120b818f0fa90252de66a8ca82">forcevalue1</a>[5]=<a class="code" href="class_visual_servo_algorithm.html#a97cf44120b818f0fa90252de66a8ca82">forcevalue1</a>[5]/1000;</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;            cout&lt;&lt;<span class="stringliteral">&quot;forcevalue&quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a97cf44120b818f0fa90252de66a8ca82">forcevalue1</a>[0]&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a97cf44120b818f0fa90252de66a8ca82">forcevalue1</a>[1]&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a97cf44120b818f0fa90252de66a8ca82">forcevalue1</a>[2]&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a97cf44120b818f0fa90252de66a8ca82">forcevalue1</a>[3]&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a97cf44120b818f0fa90252de66a8ca82">forcevalue1</a>[4]&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a97cf44120b818f0fa90252de66a8ca82">forcevalue1</a>[5]&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;endl;</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>=0;<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>&lt;6;<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>++)</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;            {</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                <a class="code" href="class_visual_servo_algorithm.html#a372265169be6c94899228258042e15cc">force_initialForceV</a>(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,0)=<a class="code" href="class_visual_servo_algorithm.html#a97cf44120b818f0fa90252de66a8ca82">forcevalue1</a>[<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>];</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;            }</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;            cout&lt;&lt;<span class="stringliteral">&quot;force initial&quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a372265169be6c94899228258042e15cc">force_initialForceV</a>(0,0)&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a372265169be6c94899228258042e15cc">force_initialForceV</a>(1,0)&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a372265169be6c94899228258042e15cc">force_initialForceV</a>(2,0)&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a372265169be6c94899228258042e15cc">force_initialForceV</a>(3,0)&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a372265169be6c94899228258042e15cc">force_initialForceV</a>(4,0)&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a372265169be6c94899228258042e15cc">force_initialForceV</a>(5,0)&lt;&lt;<span class="stringliteral">&quot;  &quot;</span>&lt;&lt;endl;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="comment">//            cout&lt;&lt;&quot;joint: &quot;&lt;&lt;mCurrentRobotAngles.joint1&lt;&lt;&quot;  &quot;&lt;&lt;mCurrentRobotAngles.joint2&lt;&lt;&quot;  &quot;&lt;&lt;mCurrentRobotAngles.joint3&lt;&lt;&quot;  &quot;&lt;&lt;mCurrentRobotAngles.joint4&lt;&lt;&quot;  &quot;&lt;&lt;mCurrentRobotAngles.joint5&lt;&lt;&quot;  &quot;&lt;&lt;mCurrentRobotAngles.joint6&lt;&lt;&quot;  &quot;&lt;&lt;endl;</span></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="comment">//            cout&lt;&lt;&quot;joint: &quot;&lt;&lt;mCurrentRobotAngles.joint1*180/3.1415&lt;&lt;&quot;  &quot;&lt;&lt;mCurrentRobotAngles.joint2*180/3.1415&lt;&lt;&quot;  &quot;&lt;&lt;mCurrentRobotAngles.joint3*180/3.1415&lt;&lt;&quot;  &quot;&lt;&lt;mCurrentRobotAngles.joint4*180/3.1415&lt;&lt;&quot;  &quot;&lt;&lt;mCurrentRobotAngles.joint5*180/3.1415&lt;&lt;&quot;  &quot;&lt;&lt;mCurrentRobotAngles.joint6*180/3.1415&lt;&lt;&quot;  &quot;&lt;&lt;endl;</span></div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;        }</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    }</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    {</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;        cout&lt;&lt;<span class="stringliteral">&quot;You did not open force sensor!&quot;</span>;</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    }</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;}</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;</div><div class="line"><a name="l00876"></a><span class="lineno"><a class="line" href="class_visual_servo_algorithm.html#a205d74c95cc860ae55e31250f7dd636d">  876</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_visual_servo_algorithm.html#a205d74c95cc860ae55e31250f7dd636d">VisualServoAlgorithm::slotCloseForceSensor</a>()</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;{</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    <a class="code" href="ftusb_8cpp.html#aebe98d6927c678b5f9aa8a156a75c109">close_sensor</a>();</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;}</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;</div><div class="line"><a name="l00882"></a><span class="lineno"><a class="line" href="class_visual_servo_algorithm.html#a581feacfae37663fee336ab09d42c8e1">  882</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_visual_servo_algorithm.html#a581feacfae37663fee336ab09d42c8e1">VisualServoAlgorithm::getForceError</a>()</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;{</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="class_visual_servo_algorithm.html#a4c7041ad81664e5e30077cb092507ee7">ifUseForce</a>)</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    {</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#a97cf44120b818f0fa90252de66a8ca82">forcevalue1</a>=<a class="code" href="ftusb_8cpp.html#a7b8ff57e555872b432b085a4a9e6d201">force_measure</a>();</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        <span class="comment">//add force compensation</span></div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#a41f75d82693701c90081649f3dc38f6e">force_measureVec</a>&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a97cf44120b818f0fa90252de66a8ca82">forcevalue1</a>[0]/10,<a class="code" href="class_visual_servo_algorithm.html#a97cf44120b818f0fa90252de66a8ca82">forcevalue1</a>[1]/10,<a class="code" href="class_visual_servo_algorithm.html#a97cf44120b818f0fa90252de66a8ca82">forcevalue1</a>[2]/10+<a class="code" href="class_visual_servo_algorithm.html#abf35a3b77e8748c6e8051bf02daffab6">compensateValue</a>,<a class="code" href="class_visual_servo_algorithm.html#a97cf44120b818f0fa90252de66a8ca82">forcevalue1</a>[3]/1000,<a class="code" href="class_visual_servo_algorithm.html#a97cf44120b818f0fa90252de66a8ca82">forcevalue1</a>[4]/1000,<a class="code" href="class_visual_servo_algorithm.html#a97cf44120b818f0fa90252de66a8ca82">forcevalue1</a>[5]/1000;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#ad2dd940b6a4afd60a6ebdd71728c4dab">force_error</a>=<a class="code" href="class_visual_servo_algorithm.html#a41f75d82693701c90081649f3dc38f6e">force_measureVec</a>-<a class="code" href="class_visual_servo_algorithm.html#a372265169be6c94899228258042e15cc">force_initialForceV</a>;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<span class="comment">//        force_error(0,0)=0;force_error(1,0)=0;</span></div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#ad2dd940b6a4afd60a6ebdd71728c4dab">force_error</a>(3,0)=0; <a class="code" href="class_visual_servo_algorithm.html#ad2dd940b6a4afd60a6ebdd71728c4dab">force_error</a>(4,0)=0; <a class="code" href="class_visual_servo_algorithm.html#ad2dd940b6a4afd60a6ebdd71728c4dab">force_error</a>(5,0)=0;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="class_visual_servo_algorithm.html#a7b7bd4e592be89322e45422018a1fa70">ifDecomposeForce</a>)</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        {</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;            Mat end_to_base_rotM;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;            Matrix3d Rend_to_base_rotM;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;            VectorXd force_errorTemp(3,1);</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;            force_errorTemp&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#ad2dd940b6a4afd60a6ebdd71728c4dab">force_error</a>(0,0),<a class="code" href="class_visual_servo_algorithm.html#ad2dd940b6a4afd60a6ebdd71728c4dab">force_error</a>(1,0),<a class="code" href="class_visual_servo_algorithm.html#ad2dd940b6a4afd60a6ebdd71728c4dab">force_error</a>(2,0);</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;            Mat Rend_to_base_rotVec=(cv::Mat_&lt;double&gt; (3,1)&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#a4c88a09aa4c29b89265faa96dc347644">Rx</a>,<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#ad4582a7bf33bf2cc9d7d2e67c43f6f50">Ry</a>,<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#ae28178cf50e8d7a6cfcfe7504bca7c27">Rz</a>);</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;            Rodrigues(Rend_to_base_rotVec,end_to_base_rotM);</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;            cv2eigen(end_to_base_rotM,Rend_to_base_rotM);</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;            force_errorTemp=Rend_to_base_rotM*force_errorTemp;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#ad2dd940b6a4afd60a6ebdd71728c4dab">force_error</a>(0,0)=force_errorTemp(0,0);<a class="code" href="class_visual_servo_algorithm.html#ad2dd940b6a4afd60a6ebdd71728c4dab">force_error</a>(1,0)=force_errorTemp(1,0);<a class="code" href="class_visual_servo_algorithm.html#ad2dd940b6a4afd60a6ebdd71728c4dab">force_error</a>(2,0)=force_errorTemp(2,0);</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#ad2dd940b6a4afd60a6ebdd71728c4dab">force_error</a>(3,0)=0;<a class="code" href="class_visual_servo_algorithm.html#ad2dd940b6a4afd60a6ebdd71728c4dab">force_error</a>(4,0)=0;<a class="code" href="class_visual_servo_algorithm.html#ad2dd940b6a4afd60a6ebdd71728c4dab">force_error</a>(5,0)=0;</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;        }</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    }</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;}</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;</div><div class="line"><a name="l00909"></a><span class="lineno"><a class="line" href="class_visual_servo_algorithm.html#afb6be5a138c15350b70aff537c6c8456">  909</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_visual_servo_algorithm.html#afb6be5a138c15350b70aff537c6c8456">VisualServoAlgorithm::forceControlOne</a>()</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;{</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    <span class="keywordtype">double</span> angle[6]={<a class="code" href="class_visual_servo_algorithm.html#a4041a8fc6cb6ca1cf0f5e6ab64753750">mCurrentRobotAngles</a>.<a class="code" href="classrobot_joint.html#a0fabef95fa1891899b67db907f8c9969">joint1</a>,<a class="code" href="class_visual_servo_algorithm.html#a4041a8fc6cb6ca1cf0f5e6ab64753750">mCurrentRobotAngles</a>.<a class="code" href="classrobot_joint.html#a7b6cc11fe6e66f24e740caf4e2931a24">joint2</a>,<a class="code" href="class_visual_servo_algorithm.html#a4041a8fc6cb6ca1cf0f5e6ab64753750">mCurrentRobotAngles</a>.<a class="code" href="classrobot_joint.html#ae168937a1a467d8dd4ccdf50e19492d8">joint3</a>,<a class="code" href="class_visual_servo_algorithm.html#a4041a8fc6cb6ca1cf0f5e6ab64753750">mCurrentRobotAngles</a>.<a class="code" href="classrobot_joint.html#a540a629edd868250a4a3a1670d289719">joint4</a>,<a class="code" href="class_visual_servo_algorithm.html#a4041a8fc6cb6ca1cf0f5e6ab64753750">mCurrentRobotAngles</a>.<a class="code" href="classrobot_joint.html#a3864ea38b5643c1081fd72cf6de78eff">joint5</a>,<a class="code" href="class_visual_servo_algorithm.html#a4041a8fc6cb6ca1cf0f5e6ab64753750">mCurrentRobotAngles</a>.<a class="code" href="classrobot_joint.html#ab29be7c25af451e47c3ca3a712f601e2">joint6</a>};</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    cout&lt;&lt;<span class="stringliteral">&quot;force error&quot;</span>&lt;&lt;endl&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#ad2dd940b6a4afd60a6ebdd71728c4dab">force_error</a>;</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#aa6c3194cde43ea089008acbfea3abede">velocity_force</a>=<a class="code" href="class_visual_servo_algorithm.html#ad9241ccfddf9fa4c80f1709f6520e447">complianceControl</a>(angle,force_error);</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;}</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;</div><div class="line"><a name="l00916"></a><span class="lineno"><a class="line" href="class_visual_servo_algorithm.html#a5de5a6cbf65c0ccbe98527911d9e304a">  916</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_visual_servo_algorithm.html#a5de5a6cbf65c0ccbe98527911d9e304a">VisualServoAlgorithm::forceControlTwo</a>()</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;{  <span class="comment">// do not use force decompose!!!!</span></div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    <span class="keywordtype">double</span> kp=0.002; <span class="keywordtype">double</span> kd=0.0001;</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    Matrix3d decomposeM=<a class="code" href="class_visual_servo_algorithm.html#a680fa5600a5f2b56a67773ee06912972">getDecomposeMatrix</a>();</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    VectorXd velocityTemp(3,1);</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="class_visual_servo_algorithm.html#aba0e468ba78c40e5f3ff5346cd252f5c">forceDimension</a>==1)</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    {</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        VectorXd force_errorTemp(3,1);force_errorTemp&lt;&lt;0,0,<a class="code" href="class_visual_servo_algorithm.html#ad2dd940b6a4afd60a6ebdd71728c4dab">force_error</a>(2,0);</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;        VectorXd force_errorOldTemp(3,1);force_errorOldTemp&lt;&lt;0,0,<a class="code" href="class_visual_servo_algorithm.html#ab6c289115af50da9dbe3e4ad2f24f8e8">force_errorOld</a>(2,0);</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        velocityTemp=kp*force_errorTemp+kd*(force_errorTemp-force_errorOldTemp)/<a class="code" href="_visual_servo_algorithm_8cpp.html#a4c45cdff103e6644a620ba5061509f22">frequency</a>;</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;        cout&lt;&lt;<span class="stringliteral">&quot;force error Z:  &quot;</span>&lt;&lt;endl&lt;&lt;force_errorTemp(2,0)&lt;&lt;endl;</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;        cout&lt;&lt;<span class="stringliteral">&quot;P velocity: &quot;</span>&lt;&lt;endl&lt;&lt;kp*force_errorTemp&lt;&lt;endl&lt;&lt;<span class="stringliteral">&quot;D velocity: &quot;</span>&lt;&lt;endl&lt;&lt;kd*(force_errorTemp-force_errorOldTemp)/<a class="code" href="_visual_servo_algorithm_8cpp.html#a4c45cdff103e6644a620ba5061509f22">frequency</a>&lt;&lt;endl;</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    }</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="class_visual_servo_algorithm.html#aba0e468ba78c40e5f3ff5346cd252f5c">forceDimension</a>==3)</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    {</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        VectorXd force_errorTemp(3,1);force_errorTemp&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#ad2dd940b6a4afd60a6ebdd71728c4dab">force_error</a>(0,0),<a class="code" href="class_visual_servo_algorithm.html#ad2dd940b6a4afd60a6ebdd71728c4dab">force_error</a>(1,0),<a class="code" href="class_visual_servo_algorithm.html#ad2dd940b6a4afd60a6ebdd71728c4dab">force_error</a>(2,0);</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        VectorXd force_errorOldTemp(3,1);force_errorOldTemp&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#ab6c289115af50da9dbe3e4ad2f24f8e8">force_errorOld</a>(0,0),<a class="code" href="class_visual_servo_algorithm.html#ab6c289115af50da9dbe3e4ad2f24f8e8">force_errorOld</a>(1,0),<a class="code" href="class_visual_servo_algorithm.html#ab6c289115af50da9dbe3e4ad2f24f8e8">force_errorOld</a>(2,0);</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;        velocityTemp=kp*force_errorTemp+kd*(force_errorTemp-force_errorOldTemp)/<a class="code" href="_visual_servo_algorithm_8cpp.html#a4c45cdff103e6644a620ba5061509f22">frequency</a>;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    }</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <span class="keywordtype">double</span> speedNorm=sqrt(pow(velocityTemp(0,0),2)+pow(velocityTemp(1,0),2)+pow(velocityTemp(2,0),2));</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;<span class="comment">//    if(speedNorm&gt;0.006)</span></div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;<span class="comment">//    {</span></div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;<span class="comment">//        velocityTemp=speedNorm/0.006;</span></div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;<span class="comment">//    }</span></div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    velocityTemp=decomposeM*velocityTemp;</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#aa6c3194cde43ea089008acbfea3abede">velocity_force</a>(0,0)=velocityTemp(0,0);<a class="code" href="class_visual_servo_algorithm.html#aa6c3194cde43ea089008acbfea3abede">velocity_force</a>(1,0)=velocityTemp(1,0);<a class="code" href="class_visual_servo_algorithm.html#aa6c3194cde43ea089008acbfea3abede">velocity_force</a>(2,0)=velocityTemp(2,0);<a class="code" href="class_visual_servo_algorithm.html#aa6c3194cde43ea089008acbfea3abede">velocity_force</a>(3,0)=0;<a class="code" href="class_visual_servo_algorithm.html#aa6c3194cde43ea089008acbfea3abede">velocity_force</a>(4,0)=0;<a class="code" href="class_visual_servo_algorithm.html#aa6c3194cde43ea089008acbfea3abede">velocity_force</a>(5,0)=0;</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;}</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;</div><div class="line"><a name="l00945"></a><span class="lineno"><a class="line" href="class_visual_servo_algorithm.html#ad9241ccfddf9fa4c80f1709f6520e447">  945</a></span>&#160;VectorXd <a class="code" href="class_visual_servo_algorithm.html#ad9241ccfddf9fa4c80f1709f6520e447">VisualServoAlgorithm::complianceControl</a>(<span class="keywordtype">double</span> *angle,VectorXd force6D)</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;{</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    MatrixXd matrixJacobian(6,6);</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    matrixJacobian=<a class="code" href="class_visual_servo_algorithm.html#ae41f86bc1f247c83ce34834d99839928">getJacobianMatrix</a>(angle);</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="comment">//    cout&lt;&lt;&quot;jacobian:  &quot;&lt;&lt;endl&lt;&lt;matrixJacobian&lt;&lt;endl;</span></div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    MatrixXd matrixCompliance(6,6);</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    matrixCompliance=matrixJacobian*<a class="code" href="class_visual_servo_algorithm.html#ad4657bd3ae72e16514b592cffd54f311">matrixKqInverse</a>*matrixJacobian.transpose();</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;<span class="comment">//    cout&lt;&lt;&quot;matrixCompliance:  &quot;&lt;&lt;endl&lt;&lt;matrixCompliance&lt;&lt;endl;</span></div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    VectorXd speedTemp(6,1);</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    speedTemp=<a class="code" href="class_visual_servo_algorithm.html#a87284b077f40d9fe18e96d1e4773b78a">kp_force</a>*matrixCompliance*<a class="code" href="class_visual_servo_algorithm.html#ad2dd940b6a4afd60a6ebdd71728c4dab">force_error</a>+<a class="code" href="class_visual_servo_algorithm.html#a82571c86f896f6e73d65b5652be373cd">kd_force</a>*matrixCompliance*(<a class="code" href="class_visual_servo_algorithm.html#ad2dd940b6a4afd60a6ebdd71728c4dab">force_error</a>-<a class="code" href="class_visual_servo_algorithm.html#ab6c289115af50da9dbe3e4ad2f24f8e8">force_errorOld</a>)/<a class="code" href="_visual_servo_algorithm_8cpp.html#a4c45cdff103e6644a620ba5061509f22">frequency</a>;</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;<span class="comment">//    cout&lt;&lt;&quot;speed Temp:  &quot;&lt;&lt;endl&lt;&lt;speedTemp&lt;&lt;endl;</span></div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    speedTemp(3,0)=0;speedTemp(4,0)=0;speedTemp(5,0)=0;</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    <span class="keywordflow">return</span> speedTemp;</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;}</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;</div><div class="line"><a name="l00964"></a><span class="lineno"><a class="line" href="class_visual_servo_algorithm.html#adb164a1ebbc53f45a9e6d263755891cd">  964</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_visual_servo_algorithm.html#adb164a1ebbc53f45a9e6d263755891cd">VisualServoAlgorithm::forceControlOne_initial</a>()</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;{</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>=0;<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>&lt;6;<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>++)</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        <a class="code" href="class_visual_servo_algorithm.html#ab6c289115af50da9dbe3e4ad2f24f8e8">force_errorOld</a>(<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>,0)=0;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a87284b077f40d9fe18e96d1e4773b78a">kp_force</a>&lt;&lt;  1,0, 0, 0, 0, 0,</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;                0 ,1, 0, 0, 0, 0,</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;                0, 0, 1, 0, 0, 0,</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                0 ,0, 0, 1, 0, 0,</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                0 ,0 ,0 ,0 ,1 ,0,</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                0 ,0, 0, 0, 0, 1;</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a87284b077f40d9fe18e96d1e4773b78a">kp_force</a>=<a class="code" href="class_visual_servo_algorithm.html#a87284b077f40d9fe18e96d1e4773b78a">kp_force</a>*0.06;</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a82571c86f896f6e73d65b5652be373cd">kd_force</a>&lt;&lt;1,0, 0, 0, 0, 0,</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                0 ,1, 0, 0, 0, 0,</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                0, 0, 1, 0, 0, 0,</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;                0 ,0, 0, 1, 0, 0,</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;                0 ,0 ,0 ,0 ,1 ,0,</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                0 ,0, 0, 0, 0, 1;</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#a82571c86f896f6e73d65b5652be373cd">kd_force</a>=<a class="code" href="class_visual_servo_algorithm.html#a82571c86f896f6e73d65b5652be373cd">kd_force</a>*0.04;</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#ad4657bd3ae72e16514b592cffd54f311">matrixKqInverse</a>&lt;&lt;1,0, 0, 0, 0, 0,</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;                0 ,1, 0, 0, 0, 0,</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;                0, 0, 1, 0, 0, 0,</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;                0 ,0, 0, 1, 0, 0,</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;                0 ,0 ,0 ,0 ,1 ,0,</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                0 ,0, 0, 0, 0, 1;</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    <a class="code" href="class_visual_servo_algorithm.html#ad4657bd3ae72e16514b592cffd54f311">matrixKqInverse</a>=<a class="code" href="class_visual_servo_algorithm.html#ad4657bd3ae72e16514b592cffd54f311">matrixKqInverse</a>*0.5;</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;}</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;</div><div class="line"><a name="l00993"></a><span class="lineno"><a class="line" href="class_visual_servo_algorithm.html#a924ad3787aabf2d9f09fb92e72981fa0">  993</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_visual_servo_algorithm.html#a924ad3787aabf2d9f09fb92e72981fa0">VisualServoAlgorithm::getWeightMatrix</a>()</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;{</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    <span class="keywordtype">double</span> errorDistance=sqrt(pow(<a class="code" href="class_visual_servo_algorithm.html#a754b275c099792838405c663b9a2a848">error_position</a>(0,0),2)+pow(<a class="code" href="class_visual_servo_algorithm.html#a754b275c099792838405c663b9a2a848">error_position</a>(1,0),2)+pow(<a class="code" href="class_visual_servo_algorithm.html#a754b275c099792838405c663b9a2a848">error_position</a>(2,0),2));</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;<span class="comment">//    if(errorDistance&gt;thresholdDistance||(ifUseForce==false))</span></div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;<span class="comment">//    {</span></div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="comment">//        weight=0;</span></div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="comment">//    }</span></div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="comment">//    else</span></div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="comment">//    {</span></div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="comment"></span><span class="comment">//        weight=1;</span></div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;<span class="comment">//    }</span></div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="class_visual_servo_algorithm.html#ae126470dc9ce5767c9f25b3cfa6e409e">ifEnterForceMode</a>)</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;        {</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#ab08adb4c51432bad3e286c3550eb4587">weight</a>=1;</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;            emit <a class="code" href="class_visual_servo_algorithm.html#a889258e1d9da8ab15a999f38aaf2d1ad">signalForceAdjustMode</a>();</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;        }</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        {</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    <span class="comment">//        weight=(errorDistance/thresholdDistance);</span></div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;            <a class="code" href="class_visual_servo_algorithm.html#ab08adb4c51432bad3e286c3550eb4587">weight</a>=0;</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;            emit <a class="code" href="class_visual_servo_algorithm.html#a14d76fabefd3cbade421870c34e46f6a">signalTrackHeadMode</a>();</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;        }</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;}</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;</div><div class="line"><a name="l01022"></a><span class="lineno"><a class="line" href="class_visual_servo_algorithm.html#a680fa5600a5f2b56a67773ee06912972"> 1022</a></span>&#160;Matrix3d <a class="code" href="class_visual_servo_algorithm.html#a680fa5600a5f2b56a67773ee06912972">VisualServoAlgorithm::getDecomposeMatrix</a>()</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;{</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    Mat end_to_base_rotM;</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    Matrix3d Rend_to_base_rotM;</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    Mat Rend_to_base_rotVec=(cv::Mat_&lt;double&gt; (3,1)&lt;&lt;<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#a4c88a09aa4c29b89265faa96dc347644">Rx</a>,<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#ad4582a7bf33bf2cc9d7d2e67c43f6f50">Ry</a>,<a class="code" href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">mCurrentToolCoordinate</a>.<a class="code" href="class_tool_coordinate.html#ae28178cf50e8d7a6cfcfe7504bca7c27">Rz</a>);</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    Rodrigues(Rend_to_base_rotVec,end_to_base_rotM);</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    cv2eigen(end_to_base_rotM,Rend_to_base_rotM);</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    <span class="keywordflow">return</span> Rend_to_base_rotM;</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;}</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;</div><div class="line"><a name="l01036"></a><span class="lineno"><a class="line" href="class_visual_servo_algorithm.html#ae41f86bc1f247c83ce34834d99839928"> 1036</a></span>&#160;MatrixXd <a class="code" href="class_visual_servo_algorithm.html#ae41f86bc1f247c83ce34834d99839928">VisualServoAlgorithm::getJacobianMatrix</a>(<span class="keywordtype">double</span> *q)</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;{</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    <span class="keywordtype">float</span> JV[18];</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    <span class="keywordtype">float</span> JW[18];</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    <span class="keywordtype">float</span> q1,q2,q3,q4,q5,q6;</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    q1=q[0];</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    q2=q[1];</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    q3=q[2];</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    q4=q[3];</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    q5=q[4];</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    q6=q[5];</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    <span class="comment">//q1=0.0038;</span></div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    <span class="comment">//q6=0.0035;</span></div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    <span class="comment">//JV11=0.107*sin(q1 + q2 + q3) - 0.043*cos(q2 - 1.0*q1 + q3 + q4) - 0.020*cos(q2 - 1.0*q1 + q3 + q4 - 1.0*q5) + 0.041*cos(q1 - 1.0*q5) + 0.122*sin(q1 - 1.0*q2) + 0.043*cos(q1 + q2 + q3 + q4) + 0.020*cos(q1 + q2 + q3 + q4 - 1.0*q5) + 0.020*cos(q2 - 1.0*q1 + q3 + q4 + q5) + 0.041*cos(q1 + q5) + 0.122*sin(q1 + q2) - 0.107*sin(q2 - 1.0*q1 + q3) + 0.112*cos(q1) - 0.021*cos(q1 + q2 + q3 + q4 + q5);</span></div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    JV[0]=0.106625*sin(q1 + q2 + q3) - 0.042675*cos(q2 - 1.0*q1 + q3 + q4) - 0.020475*cos(q2 - 1.0*q1 + q3 + q4 - 1.0*q5) + 0.04095*cos(q1 - 1.0*q5) + 0.121825*sin(q1 - 1.0*q2) + 0.042675*cos(q1 + q2 + q3 + q4) + 0.020475*cos(q1 + q2 + q3 + q4 - 1.0*q5) + 0.020475*cos(q2 - 1.0*q1 + q3 + q4 + q5) + 0.04095*cos(q1 + q5) + 0.121825*sin(q1 + q2) - 0.106625*sin(q2 - 1.0*q1 + q3) + 0.11235*cos(q1) - 0.020475*cos(q1 + q2 + q3 + q4 + q5);</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    JV[1]=0.106625*sin(q1 + q2 + q3) + 0.042675*cos(q2 - 1.0*q1 + q3 + q4) + 0.020475*cos(q2 - 1.0*q1 + q3 + q4 - 1.0*q5) - 0.121825*sin(q1 - 1.0*q2) + 0.042675*cos(q1 + q2 + q3 + q4) + 0.020475*cos(q1 + q2 + q3 + q4 - 1.0*q5) - 0.020475*cos(q2 - 1.0*q1 + q3 + q4 + q5) + 0.121825*sin(q1 + q2) + 0.106625*sin(q2 - 1.0*q1 + q3) - 0.020475*cos(q1 + q2 + q3 + q4 + q5);</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    JV[2]=0.106625*sin(q1 + q2 + q3) + 0.042675*cos(q2 - 1.0*q1 + q3 + q4) + 0.020475*cos(q2 - 1.0*q1 + q3 + q4 - 1.0*q5) + 0.042675*cos(q1 + q2 + q3 + q4) + 0.020475*cos(q1 + q2 + q3 + q4 - 1.0*q5) - 0.020475*cos(q2 - 1.0*q1 + q3 + q4 + q5) + 0.106625*sin(q2 - 1.0*q1 + q3) - 0.020475*cos(q1 + q2 + q3 + q4 + q5);</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    JV[3]=0.042675*cos(q2 - 1.0*q1 + q3 + q4) + 0.020475*cos(q2 - 1.0*q1 + q3 + q4 - 1.0*q5) + 0.042675*cos(q1 + q2 + q3 + q4) + 0.020475*cos(q1 + q2 + q3 + q4 - 1.0*q5) - 0.020475*cos(q2 - 1.0*q1 + q3 + q4 + q5) - 0.020475*cos(q1 + q2 + q3 + q4 + q5);</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    JV[4]=0.04095*cos(q1 + q5) - 0.04095*cos(q1 - 1.0*q5) - 0.020475*cos(q1 + q2 + q3 + q4 - 1.0*q5) - 0.020475*cos(q2 - 1.0*q1 + q3 + q4 + q5) - 0.020475*cos(q2 - 1.0*q1 + q3 + q4 - 1.0*q5) - 0.020475*cos(q1 + q2 + q3 + q4 + q5);</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    JV[5]=0;</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    JV[6]=0.042675*sin(q2 - 1.0*q1 + q3 + q4) - 0.106625*cos(q1 + q2 + q3) - 0.020475*sin(q1 + q2 + q3 + q4 + q5) - 0.121825*cos(q1 - 1.0*q2) + 0.020475*sin(q2 - 1.0*q1 + q3 + q4 - 1.0*q5) + 0.04095*sin(q1 - 1.0*q5) + 0.042675*sin(q1 + q2 + q3 + q4) - 0.121825*cos(q1 + q2) + 0.020475*sin(q1 + q2 + q3 + q4 - 1.0*q5) - 0.020475*sin(q2 - 1.0*q1 + q3 + q4 + q5) + 0.04095*sin(q1 + q5) - 0.106625*cos(q2 - 1.0*q1 + q3) + 0.11235*sin(q1);</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    JV[7]=0.121825*cos(q1 - 1.0*q2) - 0.106625*cos(q1 + q2 + q3) - 0.042675*sin(q2 - 1.0*q1 + q3 + q4) - 0.020475*sin(q1 + q2 + q3 + q4 + q5) - 0.020475*sin(q2 - 1.0*q1 + q3 + q4 - 1.0*q5) + 0.042675*sin(q1 + q2 + q3 + q4) - 0.121825*cos(q1 + q2) + 0.020475*sin(q1 + q2 + q3 + q4 - 1.0*q5) + 0.020475*sin(q2 - 1.0*q1 + q3 + q4 + q5) + 0.106625*cos(q2 - 1.0*q1 + q3);</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    JV[8]=0.042675*sin(q1 + q2 + q3 + q4) - 0.106625*cos(q1 + q2 + q3) - 0.042675*sin(q2 - 1.0*q1 + q3 + q4) - 0.020475*sin(q2 - 1.0*q1 + q3 + q4 - 1.0*q5) - 0.020475*sin(q1 + q2 + q3 + q4 + q5) + 0.020475*sin(q1 + q2 + q3 + q4 - 1.0*q5) + 0.020475*sin(q2 - 1.0*q1 + q3 + q4 + q5) + 0.106625*cos(q2 - 1.0*q1 + q3);</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    JV[9]=0.042675*sin(q1 + q2 + q3 + q4) - 0.042675*sin(q2 - 1.0*q1 + q3 + q4) - 0.020475*sin(q2 - 1.0*q1 + q3 + q4 - 1.0*q5) - 0.020475*sin(q1 + q2 + q3 + q4 + q5) + 0.020475*sin(q1 + q2 + q3 + q4 - 1.0*q5) + 0.020475*sin(q2 - 1.0*q1 + q3 + q4 + q5);</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    JV[10]=0.020475*sin(q2 - 1.0*q1 + q3 + q4 - 1.0*q5) - 0.020475*sin(q1 + q2 + q3 + q4 + q5) - 0.04095*sin(q1 - 1.0*q5) - 0.020475*sin(q1 + q2 + q3 + q4 - 1.0*q5) + 0.020475*sin(q2 - 1.0*q1 + q3 + q4 + q5) + 0.04095*sin(q1 + q5);</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    JV[11]=0;</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    JV[12]=0;</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    JV[13]=0.08535*sin(q2 + q3 + q4) + 0.04095*sin(q2 + q3 + q4 - 1.0*q5) - 0.04095*sin(q2 + q3 + q4 + q5) - 0.21325*cos(q2 + q3) - 0.24365*cos(q2);</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    JV[14]=0.08535*sin(q2 + q3 + q4) + 0.04095*sin(q2 + q3 + q4 - 1.0*q5) - 0.04095*sin(q2 + q3 + q4 + q5) - 0.21325*cos(q2 + q3);</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    JV[15]=0.08535*sin(q2 + q3 + q4) + 0.04095*sin(q2 + q3 + q4 - 1.0*q5) - 0.04095*sin(q2 + q3 + q4 + q5);</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    JV[16]=1.6797971e-11*sin(q5) - 0.04095*sin(q2 + q3 + q4 + q5) - 0.04095*sin(q2 + q3 + q4 - 1.0*q5);</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    JV[17]=0;</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    JW[0]=(2.0510343e-10*cos(q5) + cos(q2)*(cos(q3)*(2.0510343e-10*cos(q4)*cos(q5) - 2.0510343e-10*cos(q4) + sin(q4)*sin(q5)) + sin(q3)*(2.0510343e-10*sin(q4) + cos(q4)*sin(q5) - 2.0510343e-10*cos(q5)*sin(q4))) + sin(q2)*(cos(q3)*(2.0510343e-10*sin(q4) + cos(q4)*sin(q5) - 2.0510343e-10*cos(q5)*sin(q4)) - 1.0*sin(q3)*(2.0510343e-10*cos(q4)*cos(q5) - 2.0510343e-10*cos(q4) + sin(q4)*sin(q5))) + 8.6281713e-30)*(sin(q5)*(0.5*cos(q2 - 1.0*q1 + q3 + q4) + 0.5*cos(q1 + q2 + q3 + q4)) - 4.2067416e-20*sin(q1) - 1.0*cos(q5)*(1.0255171e-10*sin(q2 - 1.0*q1 + q3 + q4) + 1.0255171e-10*sin(q1 + q2 + q3 + q4) + sin(q1)) + 2.0510343e-10*sin(q4)*(0.5*cos(q1 + q2 + q3) + 0.5*cos(q2 - 1.0*q1 + q3)) + 2.0510343e-10*cos(q4)*(0.5*sin(q1 + q2 + q3) + 0.5*sin(q2 - 1.0*q1 + q3))) + 1.0*(sin(q6)*(cos(q5)*(0.5*cos(q2 - 1.0*q1 + q3 + q4) + 0.5*cos(q1 + q2 + q3 + q4)) + sin(q5)*(1.0255171e-10*sin(q2 - 1.0*q1 + q3 + q4) + 1.0255171e-10*sin(q1 + q2 + q3 + q4) + sin(q1))) + cos(q6)*(2.0510343e-10*cos(q5)*(1.0255171e-10*sin(q2 - 1.0*q1 + q3 + q4) + 1.0255171e-10*sin(q1 + q2 + q3 + q4) + sin(q1)) - 2.0510343e-10*sin(q5)*(0.5*cos(q2 - 1.0*q1 + q3 + q4) + 0.5*cos(q1 + q2 + q3 + q4)) - 2.0510343e-10*sin(q1) + sin(q4)*(0.5*cos(q1 + q2 + q3) + 0.5*cos(q2 - 1.0*q1 + q3)) + cos(q4)*(0.5*sin(q1 + q2 + q3) + 0.5*sin(q2 - 1.0*q1 + q3))))*(4.2067416e-20*cos(q6) + 1.0*sin(q2)*(cos(q3)*(cos(q4)*(cos(q5)*sin(q6) - 2.0510343e-10*cos(q6)*sin(q5)) + 2.0510343e-10*sin(q4)*(2.0510343e-10*cos(q5)*cos(q6) + sin(q5)*sin(q6)) + cos(q6)*sin(q4)) + sin(q3)*(2.0510343e-10*cos(q4)*(2.0510343e-10*cos(q5)*cos(q6) + sin(q5)*sin(q6)) - 1.0*sin(q4)*(cos(q5)*sin(q6) - 2.0510343e-10*cos(q6)*sin(q5)) + cos(q4)*cos(q6))) + cos(q2)*(1.0*sin(q3)*(cos(q4)*(cos(q5)*sin(q6) - 2.0510343e-10*cos(q6)*sin(q5)) + 2.0510343e-10*sin(q4)*(2.0510343e-10*cos(q5)*cos(q6) + sin(q5)*sin(q6)) + cos(q6)*sin(q4)) - cos(q3)*(2.0510343e-10*cos(q4)*(2.0510343e-10*cos(q5)*cos(q6) + sin(q5)*sin(q6)) - 1.0*sin(q4)*(cos(q5)*sin(q6) - 2.0510343e-10*cos(q6)*sin(q5)) + cos(q4)*cos(q6))) - 4.2067416e-20*cos(q5)*cos(q6) - 2.0510343e-10*sin(q5)*sin(q6)) - 1.0*(cos(q6)*(cos(q5)*(0.5*cos(q2 - 1.0*q1 + q3 + q4) + 0.5*cos(q1 + q2 + q3 + q4)) + sin(q5)*(1.0255171e-10*sin(q2 - 1.0*q1 + q3 + q4) + 1.0255171e-10*sin(q1 + q2 + q3 + q4) + sin(q1))) - 1.0*sin(q6)*(2.0510343e-10*cos(q5)*(1.0255171e-10*sin(q2 - 1.0*q1 + q3 + q4) + 1.0255171e-10*sin(q1 + q2 + q3 + q4) + sin(q1)) - 2.0510343e-10*sin(q5)*(0.5*cos(q2 - 1.0*q1 + q3 + q4) + 0.5*cos(q1 + q2 + q3 + q4)) - 2.0510343e-10*sin(q1) + sin(q4)*(0.5*cos(q1 + q2 + q3) + 0.5*cos(q2 - 1.0*q1 + q3)) + cos(q4)*(0.5*sin(q1 + q2 + q3) + 0.5*sin(q2 - 1.0*q1 + q3))))*(4.2067416e-20*sin(q6) + sin(q2)*(cos(q3)*(2.0510343e-10*sin(q4)*(2.0510343e-10*cos(q5)*sin(q6) - 1.0*cos(q6)*sin(q5)) - 1.0*cos(q4)*(cos(q5)*cos(q6) + 2.0510343e-10*sin(q5)*sin(q6)) + sin(q4)*sin(q6)) + sin(q3)*(sin(q4)*(cos(q5)*cos(q6) + 2.0510343e-10*sin(q5)*sin(q6)) + 2.0510343e-10*cos(q4)*(2.0510343e-10*cos(q5)*sin(q6) - 1.0*cos(q6)*sin(q5)) + cos(q4)*sin(q6))) + 1.0*cos(q2)*(1.0*sin(q3)*(2.0510343e-10*sin(q4)*(2.0510343e-10*cos(q5)*sin(q6) - 1.0*cos(q6)*sin(q5)) - 1.0*cos(q4)*(cos(q5)*cos(q6) + 2.0510343e-10*sin(q5)*sin(q6)) + sin(q4)*sin(q6)) - cos(q3)*(sin(q4)*(cos(q5)*cos(q6) + 2.0510343e-10*sin(q5)*sin(q6)) + 2.0510343e-10*cos(q4)*(2.0510343e-10*cos(q5)*sin(q6) - 1.0*cos(q6)*sin(q5)) + cos(q4)*sin(q6))) - 4.2067416e-20*cos(q5)*sin(q6) + 2.0510343e-10*cos(q6)*sin(q5));</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    JW[1]=(sin(q6)*(cos(q5)*(0.5*cos(q2 - 1.0*q1 + q3 + q4) + 0.5*cos(q1 + q2 + q3 + q4)) + sin(q5)*(1.0255171e-10*sin(q2 - 1.0*q1 + q3 + q4) + 1.0255171e-10*sin(q1 + q2 + q3 + q4) + sin(q1))) + cos(q6)*(2.0510343e-10*cos(q5)*(1.0255171e-10*sin(q2 - 1.0*q1 + q3 + q4) + 1.0255171e-10*sin(q1 + q2 + q3 + q4) + sin(q1)) - 2.0510343e-10*sin(q5)*(0.5*cos(q2 - 1.0*q1 + q3 + q4) + 0.5*cos(q1 + q2 + q3 + q4)) - 2.0510343e-10*sin(q1) + sin(q4)*(0.5*cos(q1 + q2 + q3) + 0.5*cos(q2 - 1.0*q1 + q3)) + cos(q4)*(0.5*sin(q1 + q2 + q3) + 0.5*sin(q2 - 1.0*q1 + q3))))*(2.0510343e-10*cos(q5)*cos(q6) - 2.0510343e-10*cos(q6) + sin(q5)*sin(q6)) - 1.0*(cos(q5) + 4.2067416e-20)*(sin(q5)*(0.5*cos(q2 - 1.0*q1 + q3 + q4) + 0.5*cos(q1 + q2 + q3 + q4)) - 4.2067416e-20*sin(q1) - 1.0*cos(q5)*(1.0255171e-10*sin(q2 - 1.0*q1 + q3 + q4) + 1.0255171e-10*sin(q1 + q2 + q3 + q4) + sin(q1)) + 2.0510343e-10*sin(q4)*(0.5*cos(q1 + q2 + q3) + 0.5*cos(q2 - 1.0*q1 + q3)) + 2.0510343e-10*cos(q4)*(0.5*sin(q1 + q2 + q3) + 0.5*sin(q2 - 1.0*q1 + q3))) + (cos(q6)*(cos(q5)*(0.5*cos(q2 - 1.0*q1 + q3 + q4) + 0.5*cos(q1 + q2 + q3 + q4)) + sin(q5)*(1.0255171e-10*sin(q2 - 1.0*q1 + q3 + q4) + 1.0255171e-10*sin(q1 + q2 + q3 + q4) + sin(q1))) - 1.0*sin(q6)*(2.0510343e-10*cos(q5)*(1.0255171e-10*sin(q2 - 1.0*q1 + q3 + q4) + 1.0255171e-10*sin(q1 + q2 + q3 + q4) + sin(q1)) - 2.0510343e-10*sin(q5)*(0.5*cos(q2 - 1.0*q1 + q3 + q4) + 0.5*cos(q1 + q2 + q3 + q4)) - 2.0510343e-10*sin(q1) + sin(q4)*(0.5*cos(q1 + q2 + q3) + 0.5*cos(q2 - 1.0*q1 + q3)) + cos(q4)*(0.5*sin(q1 + q2 + q3) + 0.5*sin(q2 - 1.0*q1 + q3))))*(2.0510343e-10*sin(q6) - 2.0510343e-10*cos(q5)*sin(q6) + cos(q6)*sin(q5));</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    JW[2]=(sin(q6)*(cos(q5)*(0.5*cos(q2 - 1.0*q1 + q3 + q4) + 0.5*cos(q1 + q2 + q3 + q4)) + sin(q5)*(1.0255171e-10*sin(q2 - 1.0*q1 + q3 + q4) + 1.0255171e-10*sin(q1 + q2 + q3 + q4) + sin(q1))) + cos(q6)*(2.0510343e-10*cos(q5)*(1.0255171e-10*sin(q2 - 1.0*q1 + q3 + q4) + 1.0255171e-10*sin(q1 + q2 + q3 + q4) + sin(q1)) - 2.0510343e-10*sin(q5)*(0.5*cos(q2 - 1.0*q1 + q3 + q4) + 0.5*cos(q1 + q2 + q3 + q4)) - 2.0510343e-10*sin(q1) + sin(q4)*(0.5*cos(q1 + q2 + q3) + 0.5*cos(q2 - 1.0*q1 + q3)) + cos(q4)*(0.5*sin(q1 + q2 + q3) + 0.5*sin(q2 - 1.0*q1 + q3))))*(2.0510343e-10*cos(q5)*cos(q6) - 2.0510343e-10*cos(q6) + sin(q5)*sin(q6)) - 1.0*(cos(q5) + 4.2067416e-20)*(sin(q5)*(0.5*cos(q2 - 1.0*q1 + q3 + q4) + 0.5*cos(q1 + q2 + q3 + q4)) - 4.2067416e-20*sin(q1) - 1.0*cos(q5)*(1.0255171e-10*sin(q2 - 1.0*q1 + q3 + q4) + 1.0255171e-10*sin(q1 + q2 + q3 + q4) + sin(q1)) + 2.0510343e-10*sin(q4)*(0.5*cos(q1 + q2 + q3) + 0.5*cos(q2 - 1.0*q1 + q3)) + 2.0510343e-10*cos(q4)*(0.5*sin(q1 + q2 + q3) + 0.5*sin(q2 - 1.0*q1 + q3))) + (cos(q6)*(cos(q5)*(0.5*cos(q2 - 1.0*q1 + q3 + q4) + 0.5*cos(q1 + q2 + q3 + q4)) + sin(q5)*(1.0255171e-10*sin(q2 - 1.0*q1 + q3 + q4) + 1.0255171e-10*sin(q1 + q2 + q3 + q4) + sin(q1))) - 1.0*sin(q6)*(2.0510343e-10*cos(q5)*(1.0255171e-10*sin(q2 - 1.0*q1 + q3 + q4) + 1.0255171e-10*sin(q1 + q2 + q3 + q4) + sin(q1)) - 2.0510343e-10*sin(q5)*(0.5*cos(q2 - 1.0*q1 + q3 + q4) + 0.5*cos(q1 + q2 + q3 + q4)) - 2.0510343e-10*sin(q1) + sin(q4)*(0.5*cos(q1 + q2 + q3) + 0.5*cos(q2 - 1.0*q1 + q3)) + cos(q4)*(0.5*sin(q1 + q2 + q3) + 0.5*sin(q2 - 1.0*q1 + q3))))*(2.0510343e-10*sin(q6) - 2.0510343e-10*cos(q5)*sin(q6) + cos(q6)*sin(q5));</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    JW[3]=(sin(q6)*(cos(q5)*(0.5*cos(q2 - 1.0*q1 + q3 + q4) + 0.5*cos(q1 + q2 + q3 + q4)) + sin(q5)*(1.0255171e-10*sin(q2 - 1.0*q1 + q3 + q4) + 1.0255171e-10*sin(q1 + q2 + q3 + q4) + sin(q1))) + cos(q6)*(2.0510343e-10*cos(q5)*(1.0255171e-10*sin(q2 - 1.0*q1 + q3 + q4) + 1.0255171e-10*sin(q1 + q2 + q3 + q4) + sin(q1)) - 2.0510343e-10*sin(q5)*(0.5*cos(q2 - 1.0*q1 + q3 + q4) + 0.5*cos(q1 + q2 + q3 + q4)) - 2.0510343e-10*sin(q1) + sin(q4)*(0.5*cos(q1 + q2 + q3) + 0.5*cos(q2 - 1.0*q1 + q3)) + cos(q4)*(0.5*sin(q1 + q2 + q3) + 0.5*sin(q2 - 1.0*q1 + q3))))*(2.0510343e-10*cos(q5)*cos(q6) - 2.0510343e-10*cos(q6) + sin(q5)*sin(q6)) - 1.0*(cos(q5) + 4.2067416e-20)*(sin(q5)*(0.5*cos(q2 - 1.0*q1 + q3 + q4) + 0.5*cos(q1 + q2 + q3 + q4)) - 4.2067416e-20*sin(q1) - 1.0*cos(q5)*(1.0255171e-10*sin(q2 - 1.0*q1 + q3 + q4) + 1.0255171e-10*sin(q1 + q2 + q3 + q4) + sin(q1)) + 2.0510343e-10*sin(q4)*(0.5*cos(q1 + q2 + q3) + 0.5*cos(q2 - 1.0*q1 + q3)) + 2.0510343e-10*cos(q4)*(0.5*sin(q1 + q2 + q3) + 0.5*sin(q2 - 1.0*q1 + q3))) + (cos(q6)*(cos(q5)*(0.5*cos(q2 - 1.0*q1 + q3 + q4) + 0.5*cos(q1 + q2 + q3 + q4)) + sin(q5)*(1.0255171e-10*sin(q2 - 1.0*q1 + q3 + q4) + 1.0255171e-10*sin(q1 + q2 + q3 + q4) + sin(q1))) - 1.0*sin(q6)*(2.0510343e-10*cos(q5)*(1.0255171e-10*sin(q2 - 1.0*q1 + q3 + q4) + 1.0255171e-10*sin(q1 + q2 + q3 + q4) + sin(q1)) - 2.0510343e-10*sin(q5)*(0.5*cos(q2 - 1.0*q1 + q3 + q4) + 0.5*cos(q1 + q2 + q3 + q4)) - 2.0510343e-10*sin(q1) + sin(q4)*(0.5*cos(q1 + q2 + q3) + 0.5*cos(q2 - 1.0*q1 + q3)) + cos(q4)*(0.5*sin(q1 + q2 + q3) + 0.5*sin(q2 - 1.0*q1 + q3))))*(2.0510343e-10*sin(q6) - 2.0510343e-10*cos(q5)*sin(q6) + cos(q6)*sin(q5));</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    JW[4]=cos(q6)*(sin(q6)*(cos(q5)*(0.5*cos(q2 - 1.0*q1 + q3 + q4) + 0.5*cos(q1 + q2 + q3 + q4)) + sin(q5)*(1.0255171e-10*sin(q2 - 1.0*q1 + q3 + q4) + 1.0255171e-10*sin(q1 + q2 + q3 + q4) + sin(q1))) + cos(q6)*(2.0510343e-10*cos(q5)*(1.0255171e-10*sin(q2 - 1.0*q1 + q3 + q4) + 1.0255171e-10*sin(q1 + q2 + q3 + q4) + sin(q1)) - 2.0510343e-10*sin(q5)*(0.5*cos(q2 - 1.0*q1 + q3 + q4) + 0.5*cos(q1 + q2 + q3 + q4)) - 2.0510343e-10*sin(q1) + sin(q4)*(0.5*cos(q1 + q2 + q3) + 0.5*cos(q2 - 1.0*q1 + q3)) + cos(q4)*(0.5*sin(q1 + q2 + q3) + 0.5*sin(q2 - 1.0*q1 + q3)))) - 8.6281713e-30*sin(q1) - 1.0*sin(q6)*(cos(q6)*(cos(q5)*(0.5*cos(q2 - 1.0*q1 + q3 + q4) + 0.5*cos(q1 + q2 + q3 + q4)) + sin(q5)*(1.0255171e-10*sin(q2 - 1.0*q1 + q3 + q4) + 1.0255171e-10*sin(q1 + q2 + q3 + q4) + sin(q1))) - 1.0*sin(q6)*(2.0510343e-10*cos(q5)*(1.0255171e-10*sin(q2 - 1.0*q1 + q3 + q4) + 1.0255171e-10*sin(q1 + q2 + q3 + q4) + sin(q1)) - 2.0510343e-10*sin(q5)*(0.5*cos(q2 - 1.0*q1 + q3 + q4) + 0.5*cos(q1 + q2 + q3 + q4)) - 2.0510343e-10*sin(q1) + sin(q4)*(0.5*cos(q1 + q2 + q3) + 0.5*cos(q2 - 1.0*q1 + q3)) + cos(q4)*(0.5*sin(q1 + q2 + q3) + 0.5*sin(q2 - 1.0*q1 + q3)))) + 2.0510343e-10*sin(q5)*(0.5*cos(q2 - 1.0*q1 + q3 + q4) + 0.5*cos(q1 + q2 + q3 + q4)) - 2.0510343e-10*cos(q5)*(1.0255171e-10*sin(q2 - 1.0*q1 + q3 + q4) + 1.0255171e-10*sin(q1 + q2 + q3 + q4) + sin(q1)) + 4.2067416e-20*sin(q4)*(0.5*cos(q1 + q2 + q3) + 0.5*cos(q2 - 1.0*q1 + q3)) + 4.2067416e-20*cos(q4)*(0.5*sin(q1 + q2 + q3) + 0.5*sin(q2 - 1.0*q1 + q3));</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    JW[5]=4.2067416e-20*sin(q1) - 1.0*sin(q5)*(0.5*cos(q2 - 1.0*q1 + q3 + q4) + 0.5*cos(q1 + q2 + q3 + q4)) + cos(q5)*(1.0255171e-10*sin(q2 - 1.0*q1 + q3 + q4) + 1.0255171e-10*sin(q1 + q2 + q3 + q4) + sin(q1)) - 2.0510343e-10*sin(q4)*(0.5*cos(q1 + q2 + q3) + 0.5*cos(q2 - 1.0*q1 + q3)) - 2.0510343e-10*cos(q4)*(0.5*sin(q1 + q2 + q3) + 0.5*sin(q2 - 1.0*q1 + q3));</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    JW[6]=(1.0*sin(q6)*(2.0510343e-10*cos(q1) + 1.2924697e-26*sin(q4)*(3.8685626e25*sin(q1 + q2 + q3) - 3.8685626e25*sin(q2 - 1.0*q1 + q3)) - 2.0510343e-10*cos(q5)*(1.0255171e-10*cos(q1 + q2 + q3 + q4) - 1.0255171e-10*cos(q2 - 1.0*q1 + q3 + q4) + cos(q1)) - 1.2924697e-26*cos(q4)*(3.8685626e25*cos(q1 + q2 + q3) - 3.8685626e25*cos(q2 - 1.0*q1 + q3)) + 2.0510343e-10*sin(q5)*(0.5*sin(q2 - 1.0*q1 + q3 + q4) - 0.5*sin(q1 + q2 + q3 + q4))) + cos(q6)*(sin(q5)*(1.0255171e-10*cos(q1 + q2 + q3 + q4) - 1.0255171e-10*cos(q2 - 1.0*q1 + q3 + q4) + cos(q1)) + 1.2924697e-26*cos(q5)*(3.8685626e25*sin(q2 - 1.0*q1 + q3 + q4) - 3.8685626e25*sin(q1 + q2 + q3 + q4))))*(4.2067416e-20*sin(q6) + sin(q2)*(cos(q3)*(2.0510343e-10*sin(q4)*(2.0510343e-10*cos(q5)*sin(q6) - 1.0*cos(q6)*sin(q5)) - 1.0*cos(q4)*(cos(q5)*cos(q6) + 2.0510343e-10*sin(q5)*sin(q6)) + sin(q4)*sin(q6)) + sin(q3)*(sin(q4)*(cos(q5)*cos(q6) + 2.0510343e-10*sin(q5)*sin(q6)) + 2.0510343e-10*cos(q4)*(2.0510343e-10*cos(q5)*sin(q6) - 1.0*cos(q6)*sin(q5)) + cos(q4)*sin(q6))) + 1.0*cos(q2)*(1.0*sin(q3)*(2.0510343e-10*sin(q4)*(2.0510343e-10*cos(q5)*sin(q6) - 1.0*cos(q6)*sin(q5)) - 1.0*cos(q4)*(cos(q5)*cos(q6) + 2.0510343e-10*sin(q5)*sin(q6)) + sin(q4)*sin(q6)) - cos(q3)*(sin(q4)*(cos(q5)*cos(q6) + 2.0510343e-10*sin(q5)*sin(q6)) + 2.0510343e-10*cos(q4)*(2.0510343e-10*cos(q5)*sin(q6) - 1.0*cos(q6)*sin(q5)) + cos(q4)*sin(q6))) - 4.2067416e-20*cos(q5)*sin(q6) + 2.0510343e-10*cos(q6)*sin(q5)) + (cos(q6)*(2.0510343e-10*cos(q1) + 1.2924697e-26*sin(q4)*(3.8685626e25*sin(q1 + q2 + q3) - 3.8685626e25*sin(q2 - 1.0*q1 + q3)) - 2.0510343e-10*cos(q5)*(1.0255171e-10*cos(q1 + q2 + q3 + q4) - 1.0255171e-10*cos(q2 - 1.0*q1 + q3 + q4) + cos(q1)) - 1.2924697e-26*cos(q4)*(3.8685626e25*cos(q1 + q2 + q3) - 3.8685626e25*cos(q2 - 1.0*q1 + q3)) + 2.0510343e-10*sin(q5)*(0.5*sin(q2 - 1.0*q1 + q3 + q4) - 0.5*sin(q1 + q2 + q3 + q4))) - sin(q6)*(sin(q5)*(1.0255171e-10*cos(q1 + q2 + q3 + q4) - 1.0255171e-10*cos(q2 - 1.0*q1 + q3 + q4) + cos(q1)) + 1.2924697e-26*cos(q5)*(3.8685626e25*sin(q2 - 1.0*q1 + q3 + q4) - 3.8685626e25*sin(q1 + q2 + q3 + q4))))*(4.2067416e-20*cos(q6) + 1.0*sin(q2)*(cos(q3)*(cos(q4)*(cos(q5)*sin(q6) - 2.0510343e-10*cos(q6)*sin(q5)) + 2.0510343e-10*sin(q4)*(2.0510343e-10*cos(q5)*cos(q6) + sin(q5)*sin(q6)) + cos(q6)*sin(q4)) + sin(q3)*(2.0510343e-10*cos(q4)*(2.0510343e-10*cos(q5)*cos(q6) + sin(q5)*sin(q6)) - 1.0*sin(q4)*(cos(q5)*sin(q6) - 2.0510343e-10*cos(q6)*sin(q5)) + cos(q4)*cos(q6))) + cos(q2)*(1.0*sin(q3)*(cos(q4)*(cos(q5)*sin(q6) - 2.0510343e-10*cos(q6)*sin(q5)) + 2.0510343e-10*sin(q4)*(2.0510343e-10*cos(q5)*cos(q6) + sin(q5)*sin(q6)) + cos(q6)*sin(q4)) - cos(q3)*(2.0510343e-10*cos(q4)*(2.0510343e-10*cos(q5)*cos(q6) + sin(q5)*sin(q6)) - 1.0*sin(q4)*(cos(q5)*sin(q6) - 2.0510343e-10*cos(q6)*sin(q5)) + cos(q4)*cos(q6))) - 4.2067416e-20*cos(q5)*cos(q6) - 2.0510343e-10*sin(q5)*sin(q6)) + (2.0510343e-10*cos(q5) + cos(q2)*(cos(q3)*(2.0510343e-10*cos(q4)*cos(q5) - 2.0510343e-10*cos(q4) + sin(q4)*sin(q5)) + sin(q3)*(2.0510343e-10*sin(q4) + cos(q4)*sin(q5) - 2.0510343e-10*cos(q5)*sin(q4))) + sin(q2)*(cos(q3)*(2.0510343e-10*sin(q4) + cos(q4)*sin(q5) - 2.0510343e-10*cos(q5)*sin(q4)) - 1.0*sin(q3)*(2.0510343e-10*cos(q4)*cos(q5) - 2.0510343e-10*cos(q4) + sin(q4)*sin(q5))) + 8.6281713e-30)*(4.2067416e-20*cos(q1) + 2.0510343e-10*sin(q4)*(0.5*sin(q1 + q2 + q3) - 0.5*sin(q2 - 1.0*q1 + q3)) + cos(q5)*(1.0255171e-10*cos(q1 + q2 + q3 + q4) - 1.0255171e-10*cos(q2 - 1.0*q1 + q3 + q4) + cos(q1)) - 2.0510343e-10*cos(q4)*(0.5*cos(q1 + q2 + q3) - 0.5*cos(q2 - 1.0*q1 + q3)) - 1.2924697e-26*sin(q5)*(3.8685626e25*sin(q2 - 1.0*q1 + q3 + q4) - 3.8685626e25*sin(q1 + q2 + q3 + q4)));</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    JW[7]=1.0*(cos(q6)*(2.0510343e-10*cos(q1) + 1.2924697e-26*sin(q4)*(3.8685626e25*sin(q1 + q2 + q3) - 3.8685626e25*sin(q2 - 1.0*q1 + q3)) - 2.0510343e-10*cos(q5)*(1.0255171e-10*cos(q1 + q2 + q3 + q4) - 1.0255171e-10*cos(q2 - 1.0*q1 + q3 + q4) + cos(q1)) - 1.2924697e-26*cos(q4)*(3.8685626e25*cos(q1 + q2 + q3) - 3.8685626e25*cos(q2 - 1.0*q1 + q3)) + 2.0510343e-10*sin(q5)*(0.5*sin(q2 - 1.0*q1 + q3 + q4) - 0.5*sin(q1 + q2 + q3 + q4))) - sin(q6)*(sin(q5)*(1.0255171e-10*cos(q1 + q2 + q3 + q4) - 1.0255171e-10*cos(q2 - 1.0*q1 + q3 + q4) + cos(q1)) + 1.2924697e-26*cos(q5)*(3.8685626e25*sin(q2 - 1.0*q1 + q3 + q4) - 3.8685626e25*sin(q1 + q2 + q3 + q4))))*(2.0510343e-10*cos(q5)*cos(q6) - 2.0510343e-10*cos(q6) + sin(q5)*sin(q6)) - 1.0*(cos(q5) + 4.2067416e-20)*(4.2067416e-20*cos(q1) + 2.0510343e-10*sin(q4)*(0.5*sin(q1 + q2 + q3) - 0.5*sin(q2 - 1.0*q1 + q3)) + cos(q5)*(1.0255171e-10*cos(q1 + q2 + q3 + q4) - 1.0255171e-10*cos(q2 - 1.0*q1 + q3 + q4) + cos(q1)) - 2.0510343e-10*cos(q4)*(0.5*cos(q1 + q2 + q3) - 0.5*cos(q2 - 1.0*q1 + q3)) - 1.2924697e-26*sin(q5)*(3.8685626e25*sin(q2 - 1.0*q1 + q3 + q4) - 3.8685626e25*sin(q1 + q2 + q3 + q4))) - 1.0*(1.0*sin(q6)*(2.0510343e-10*cos(q1) + 1.2924697e-26*sin(q4)*(3.8685626e25*sin(q1 + q2 + q3) - 3.8685626e25*sin(q2 - 1.0*q1 + q3)) - 2.0510343e-10*cos(q5)*(1.0255171e-10*cos(q1 + q2 + q3 + q4) - 1.0255171e-10*cos(q2 - 1.0*q1 + q3 + q4) + cos(q1)) - 1.2924697e-26*cos(q4)*(3.8685626e25*cos(q1 + q2 + q3) - 3.8685626e25*cos(q2 - 1.0*q1 + q3)) + 2.0510343e-10*sin(q5)*(0.5*sin(q2 - 1.0*q1 + q3 + q4) - 0.5*sin(q1 + q2 + q3 + q4))) + cos(q6)*(sin(q5)*(1.0255171e-10*cos(q1 + q2 + q3 + q4) - 1.0255171e-10*cos(q2 - 1.0*q1 + q3 + q4) + cos(q1)) + 1.2924697e-26*cos(q5)*(3.8685626e25*sin(q2 - 1.0*q1 + q3 + q4) - 3.8685626e25*sin(q1 + q2 + q3 + q4))))*(2.0510343e-10*sin(q6) - 2.0510343e-10*cos(q5)*sin(q6) + cos(q6)*sin(q5));</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    JW[8]=1.0*(cos(q6)*(2.0510343e-10*cos(q1) + 1.2924697e-26*sin(q4)*(3.8685626e25*sin(q1 + q2 + q3) - 3.8685626e25*sin(q2 - 1.0*q1 + q3)) - 2.0510343e-10*cos(q5)*(1.0255171e-10*cos(q1 + q2 + q3 + q4) - 1.0255171e-10*cos(q2 - 1.0*q1 + q3 + q4) + cos(q1)) - 1.2924697e-26*cos(q4)*(3.8685626e25*cos(q1 + q2 + q3) - 3.8685626e25*cos(q2 - 1.0*q1 + q3)) + 2.0510343e-10*sin(q5)*(0.5*sin(q2 - 1.0*q1 + q3 + q4) - 0.5*sin(q1 + q2 + q3 + q4))) - sin(q6)*(sin(q5)*(1.0255171e-10*cos(q1 + q2 + q3 + q4) - 1.0255171e-10*cos(q2 - 1.0*q1 + q3 + q4) + cos(q1)) + 1.2924697e-26*cos(q5)*(3.8685626e25*sin(q2 - 1.0*q1 + q3 + q4) - 3.8685626e25*sin(q1 + q2 + q3 + q4))))*(2.0510343e-10*cos(q5)*cos(q6) - 2.0510343e-10*cos(q6) + sin(q5)*sin(q6)) - 1.0*(cos(q5) + 4.2067416e-20)*(4.2067416e-20*cos(q1) + 2.0510343e-10*sin(q4)*(0.5*sin(q1 + q2 + q3) - 0.5*sin(q2 - 1.0*q1 + q3)) + cos(q5)*(1.0255171e-10*cos(q1 + q2 + q3 + q4) - 1.0255171e-10*cos(q2 - 1.0*q1 + q3 + q4) + cos(q1)) - 2.0510343e-10*cos(q4)*(0.5*cos(q1 + q2 + q3) - 0.5*cos(q2 - 1.0*q1 + q3)) - 1.2924697e-26*sin(q5)*(3.8685626e25*sin(q2 - 1.0*q1 + q3 + q4) - 3.8685626e25*sin(q1 + q2 + q3 + q4))) - 1.0*(1.0*sin(q6)*(2.0510343e-10*cos(q1) + 1.2924697e-26*sin(q4)*(3.8685626e25*sin(q1 + q2 + q3) - 3.8685626e25*sin(q2 - 1.0*q1 + q3)) - 2.0510343e-10*cos(q5)*(1.0255171e-10*cos(q1 + q2 + q3 + q4) - 1.0255171e-10*cos(q2 - 1.0*q1 + q3 + q4) + cos(q1)) - 1.2924697e-26*cos(q4)*(3.8685626e25*cos(q1 + q2 + q3) - 3.8685626e25*cos(q2 - 1.0*q1 + q3)) + 2.0510343e-10*sin(q5)*(0.5*sin(q2 - 1.0*q1 + q3 + q4) - 0.5*sin(q1 + q2 + q3 + q4))) + cos(q6)*(sin(q5)*(1.0255171e-10*cos(q1 + q2 + q3 + q4) - 1.0255171e-10*cos(q2 - 1.0*q1 + q3 + q4) + cos(q1)) + 1.2924697e-26*cos(q5)*(3.8685626e25*sin(q2 - 1.0*q1 + q3 + q4) - 3.8685626e25*sin(q1 + q2 + q3 + q4))))*(2.0510343e-10*sin(q6) - 2.0510343e-10*cos(q5)*sin(q6) + cos(q6)*sin(q5));</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    JW[9]=1.0*(cos(q6)*(2.0510343e-10*cos(q1) + 1.2924697e-26*sin(q4)*(3.8685626e25*sin(q1 + q2 + q3) - 3.8685626e25*sin(q2 - 1.0*q1 + q3)) - 2.0510343e-10*cos(q5)*(1.0255171e-10*cos(q1 + q2 + q3 + q4) - 1.0255171e-10*cos(q2 - 1.0*q1 + q3 + q4) + cos(q1)) - 1.2924697e-26*cos(q4)*(3.8685626e25*cos(q1 + q2 + q3) - 3.8685626e25*cos(q2 - 1.0*q1 + q3)) + 2.0510343e-10*sin(q5)*(0.5*sin(q2 - 1.0*q1 + q3 + q4) - 0.5*sin(q1 + q2 + q3 + q4))) - sin(q6)*(sin(q5)*(1.0255171e-10*cos(q1 + q2 + q3 + q4) - 1.0255171e-10*cos(q2 - 1.0*q1 + q3 + q4) + cos(q1)) + 1.2924697e-26*cos(q5)*(3.8685626e25*sin(q2 - 1.0*q1 + q3 + q4) - 3.8685626e25*sin(q1 + q2 + q3 + q4))))*(2.0510343e-10*cos(q5)*cos(q6) - 2.0510343e-10*cos(q6) + sin(q5)*sin(q6)) - 1.0*(cos(q5) + 4.2067416e-20)*(4.2067416e-20*cos(q1) + 2.0510343e-10*sin(q4)*(0.5*sin(q1 + q2 + q3) - 0.5*sin(q2 - 1.0*q1 + q3)) + cos(q5)*(1.0255171e-10*cos(q1 + q2 + q3 + q4) - 1.0255171e-10*cos(q2 - 1.0*q1 + q3 + q4) + cos(q1)) - 2.0510343e-10*cos(q4)*(0.5*cos(q1 + q2 + q3) - 0.5*cos(q2 - 1.0*q1 + q3)) - 1.2924697e-26*sin(q5)*(3.8685626e25*sin(q2 - 1.0*q1 + q3 + q4) - 3.8685626e25*sin(q1 + q2 + q3 + q4))) - 1.0*(1.0*sin(q6)*(2.0510343e-10*cos(q1) + 1.2924697e-26*sin(q4)*(3.8685626e25*sin(q1 + q2 + q3) - 3.8685626e25*sin(q2 - 1.0*q1 + q3)) - 2.0510343e-10*cos(q5)*(1.0255171e-10*cos(q1 + q2 + q3 + q4) - 1.0255171e-10*cos(q2 - 1.0*q1 + q3 + q4) + cos(q1)) - 1.2924697e-26*cos(q4)*(3.8685626e25*cos(q1 + q2 + q3) - 3.8685626e25*cos(q2 - 1.0*q1 + q3)) + 2.0510343e-10*sin(q5)*(0.5*sin(q2 - 1.0*q1 + q3 + q4) - 0.5*sin(q1 + q2 + q3 + q4))) + cos(q6)*(sin(q5)*(1.0255171e-10*cos(q1 + q2 + q3 + q4) - 1.0255171e-10*cos(q2 - 1.0*q1 + q3 + q4) + cos(q1)) + 1.2924697e-26*cos(q5)*(3.8685626e25*sin(q2 - 1.0*q1 + q3 + q4) - 3.8685626e25*sin(q1 + q2 + q3 + q4))))*(2.0510343e-10*sin(q6) - 2.0510343e-10*cos(q5)*sin(q6) + cos(q6)*sin(q5));</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    JW[10]=8.6281713e-30*cos(q1) + 4.2067416e-20*sin(q4)*(0.5*sin(q1 + q2 + q3) - 0.5*sin(q2 - 1.0*q1 + q3)) + 1.0*cos(q6)*(cos(q6)*(2.0510343e-10*cos(q1) + 1.2924697e-26*sin(q4)*(3.8685626e25*sin(q1 + q2 + q3) - 3.8685626e25*sin(q2 - 1.0*q1 + q3)) - 2.0510343e-10*cos(q5)*(1.0255171e-10*cos(q1 + q2 + q3 + q4) - 1.0255171e-10*cos(q2 - 1.0*q1 + q3 + q4) + cos(q1)) - 1.2924697e-26*cos(q4)*(3.8685626e25*cos(q1 + q2 + q3) - 3.8685626e25*cos(q2 - 1.0*q1 + q3)) + 2.0510343e-10*sin(q5)*(0.5*sin(q2 - 1.0*q1 + q3 + q4) - 0.5*sin(q1 + q2 + q3 + q4))) - sin(q6)*(sin(q5)*(1.0255171e-10*cos(q1 + q2 + q3 + q4) - 1.0255171e-10*cos(q2 - 1.0*q1 + q3 + q4) + cos(q1)) + 1.2924697e-26*cos(q5)*(3.8685626e25*sin(q2 - 1.0*q1 + q3 + q4) - 3.8685626e25*sin(q1 + q2 + q3 + q4)))) + 2.0510343e-10*cos(q5)*(1.0255171e-10*cos(q1 + q2 + q3 + q4) - 1.0255171e-10*cos(q2 - 1.0*q1 + q3 + q4) + cos(q1)) - 4.2067416e-20*cos(q4)*(0.5*cos(q1 + q2 + q3) - 0.5*cos(q2 - 1.0*q1 + q3)) - 2.6508997e-36*sin(q5)*(3.8685626e25*sin(q2 - 1.0*q1 + q3 + q4) - 3.8685626e25*sin(q1 + q2 + q3 + q4)) + sin(q6)*(1.0*sin(q6)*(2.0510343e-10*cos(q1) + 1.2924697e-26*sin(q4)*(3.8685626e25*sin(q1 + q2 + q3) - 3.8685626e25*sin(q2 - 1.0*q1 + q3)) - 2.0510343e-10*cos(q5)*(1.0255171e-10*cos(q1 + q2 + q3 + q4) - 1.0255171e-10*cos(q2 - 1.0*q1 + q3 + q4) + cos(q1)) - 1.2924697e-26*cos(q4)*(3.8685626e25*cos(q1 + q2 + q3) - 3.8685626e25*cos(q2 - 1.0*q1 + q3)) + 2.0510343e-10*sin(q5)*(0.5*sin(q2 - 1.0*q1 + q3 + q4) - 0.5*sin(q1 + q2 + q3 + q4))) + cos(q6)*(sin(q5)*(1.0255171e-10*cos(q1 + q2 + q3 + q4) - 1.0255171e-10*cos(q2 - 1.0*q1 + q3 + q4) + cos(q1)) + 1.2924697e-26*cos(q5)*(3.8685626e25*sin(q2 - 1.0*q1 + q3 + q4) - 3.8685626e25*sin(q1 + q2 + q3 + q4))));</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    JW[11]=2.0510343e-10*cos(q4)*(0.5*cos(q1 + q2 + q3) - 0.5*cos(q2 - 1.0*q1 + q3)) - 2.0510343e-10*sin(q4)*(0.5*sin(q1 + q2 + q3) - 0.5*sin(q2 - 1.0*q1 + q3)) - 1.0*cos(q5)*(1.0255171e-10*cos(q1 + q2 + q3 + q4) - 1.0255171e-10*cos(q2 - 1.0*q1 + q3 + q4) + cos(q1)) - 4.2067416e-20*cos(q1) + 1.2924697e-26*sin(q5)*(3.8685626e25*sin(q2 - 1.0*q1 + q3 + q4) - 3.8685626e25*sin(q1 + q2 + q3 + q4));</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    JW[12]=(sin(q2 + q3 + q4)*sin(q5) - 2.0510343e-10*cos(q2 + q3 + q4) + cos(q5)*(2.0510343e-10*cos(q2 + q3 + q4) + 2.0510343e-10) + 8.6281713e-30)*(2.0510343e-10*cos(q5) + cos(q2)*(cos(q3)*(2.0510343e-10*cos(q4)*cos(q5) - 2.0510343e-10*cos(q4) + sin(q4)*sin(q5)) + sin(q3)*(2.0510343e-10*sin(q4) + cos(q4)*sin(q5) - 2.0510343e-10*cos(q5)*sin(q4))) + sin(q2)*(cos(q3)*(2.0510343e-10*sin(q4) + cos(q4)*sin(q5) - 2.0510343e-10*cos(q5)*sin(q4)) - 1.0*sin(q3)*(2.0510343e-10*cos(q4)*cos(q5) - 2.0510343e-10*cos(q4) + sin(q4)*sin(q5))) + 8.6281713e-30) + (1.0*sin(q6)*(sin(q2 + q3 + q4)*cos(q5) - 1.0*sin(q5)*(2.0510343e-10*cos(q2 + q3 + q4) + 2.0510343e-10)) - cos(q6)*(cos(q2 + q3 + q4) + 2.0510343e-10*sin(q2 + q3 + q4)*sin(q5) + cos(q5)*(4.2067416e-20*cos(q2 + q3 + q4) + 4.2067416e-20) - 4.2067416e-20))*(4.2067416e-20*cos(q6) + 1.0*sin(q2)*(cos(q3)*(cos(q4)*(cos(q5)*sin(q6) - 2.0510343e-10*cos(q6)*sin(q5)) + 2.0510343e-10*sin(q4)*(2.0510343e-10*cos(q5)*cos(q6) + sin(q5)*sin(q6)) + cos(q6)*sin(q4)) + sin(q3)*(2.0510343e-10*cos(q4)*(2.0510343e-10*cos(q5)*cos(q6) + sin(q5)*sin(q6)) - 1.0*sin(q4)*(cos(q5)*sin(q6) - 2.0510343e-10*cos(q6)*sin(q5)) + cos(q4)*cos(q6))) + cos(q2)*(1.0*sin(q3)*(cos(q4)*(cos(q5)*sin(q6) - 2.0510343e-10*cos(q6)*sin(q5)) + 2.0510343e-10*sin(q4)*(2.0510343e-10*cos(q5)*cos(q6) + sin(q5)*sin(q6)) + cos(q6)*sin(q4)) - cos(q3)*(2.0510343e-10*cos(q4)*(2.0510343e-10*cos(q5)*cos(q6) + sin(q5)*sin(q6)) - 1.0*sin(q4)*(cos(q5)*sin(q6) - 2.0510343e-10*cos(q6)*sin(q5)) + cos(q4)*cos(q6))) - 4.2067416e-20*cos(q5)*cos(q6) - 2.0510343e-10*sin(q5)*sin(q6)) - 1.0*(cos(q6)*(sin(q2 + q3 + q4)*cos(q5) - 1.0*sin(q5)*(2.0510343e-10*cos(q2 + q3 + q4) + 2.0510343e-10)) + sin(q6)*(cos(q2 + q3 + q4) + 2.0510343e-10*sin(q2 + q3 + q4)*sin(q5) + cos(q5)*(4.2067416e-20*cos(q2 + q3 + q4) + 4.2067416e-20) - 4.2067416e-20))*(4.2067416e-20*sin(q6) + sin(q2)*(cos(q3)*(2.0510343e-10*sin(q4)*(2.0510343e-10*cos(q5)*sin(q6) - 1.0*cos(q6)*sin(q5)) - 1.0*cos(q4)*(cos(q5)*cos(q6) + 2.0510343e-10*sin(q5)*sin(q6)) + sin(q4)*sin(q6)) + sin(q3)*(sin(q4)*(cos(q5)*cos(q6) + 2.0510343e-10*sin(q5)*sin(q6)) + 2.0510343e-10*cos(q4)*(2.0510343e-10*cos(q5)*sin(q6) - 1.0*cos(q6)*sin(q5)) + cos(q4)*sin(q6))) + 1.0*cos(q2)*(1.0*sin(q3)*(2.0510343e-10*sin(q4)*(2.0510343e-10*cos(q5)*sin(q6) - 1.0*cos(q6)*sin(q5)) - 1.0*cos(q4)*(cos(q5)*cos(q6) + 2.0510343e-10*sin(q5)*sin(q6)) + sin(q4)*sin(q6)) - cos(q3)*(sin(q4)*(cos(q5)*cos(q6) + 2.0510343e-10*sin(q5)*sin(q6)) + 2.0510343e-10*cos(q4)*(2.0510343e-10*cos(q5)*sin(q6) - 1.0*cos(q6)*sin(q5)) + cos(q4)*sin(q6))) - 4.2067416e-20*cos(q5)*sin(q6) + 2.0510343e-10*cos(q6)*sin(q5));</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    JW[13]=(cos(q6)*(sin(q2 + q3 + q4)*cos(q5) - 1.0*sin(q5)*(2.0510343e-10*cos(q2 + q3 + q4) + 2.0510343e-10)) + sin(q6)*(cos(q2 + q3 + q4) + 2.0510343e-10*sin(q2 + q3 + q4)*sin(q5) + cos(q5)*(4.2067416e-20*cos(q2 + q3 + q4) + 4.2067416e-20) - 4.2067416e-20))*(2.0510343e-10*sin(q6) - 2.0510343e-10*cos(q5)*sin(q6) + cos(q6)*sin(q5)) - 1.0*(cos(q5) + 4.2067416e-20)*(sin(q2 + q3 + q4)*sin(q5) - 2.0510343e-10*cos(q2 + q3 + q4) + cos(q5)*(2.0510343e-10*cos(q2 + q3 + q4) + 2.0510343e-10) + 8.6281713e-30) + 1.0*(1.0*sin(q6)*(sin(q2 + q3 + q4)*cos(q5) - 1.0*sin(q5)*(2.0510343e-10*cos(q2 + q3 + q4) + 2.0510343e-10)) - cos(q6)*(cos(q2 + q3 + q4) + 2.0510343e-10*sin(q2 + q3 + q4)*sin(q5) + cos(q5)*(4.2067416e-20*cos(q2 + q3 + q4) + 4.2067416e-20) - 4.2067416e-20))*(2.0510343e-10*cos(q5)*cos(q6) - 2.0510343e-10*cos(q6) + sin(q5)*sin(q6));</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    JW[14]=(cos(q6)*(sin(q2 + q3 + q4)*cos(q5) - 1.0*sin(q5)*(2.0510343e-10*cos(q2 + q3 + q4) + 2.0510343e-10)) + sin(q6)*(cos(q2 + q3 + q4) + 2.0510343e-10*sin(q2 + q3 + q4)*sin(q5) + cos(q5)*(4.2067416e-20*cos(q2 + q3 + q4) + 4.2067416e-20) - 4.2067416e-20))*(2.0510343e-10*sin(q6) - 2.0510343e-10*cos(q5)*sin(q6) + cos(q6)*sin(q5)) - 1.0*(cos(q5) + 4.2067416e-20)*(sin(q2 + q3 + q4)*sin(q5) - 2.0510343e-10*cos(q2 + q3 + q4) + cos(q5)*(2.0510343e-10*cos(q2 + q3 + q4) + 2.0510343e-10) + 8.6281713e-30) + 1.0*(1.0*sin(q6)*(sin(q2 + q3 + q4)*cos(q5) - 1.0*sin(q5)*(2.0510343e-10*cos(q2 + q3 + q4) + 2.0510343e-10)) - cos(q6)*(cos(q2 + q3 + q4) + 2.0510343e-10*sin(q2 + q3 + q4)*sin(q5) + cos(q5)*(4.2067416e-20*cos(q2 + q3 + q4) + 4.2067416e-20) - 4.2067416e-20))*(2.0510343e-10*cos(q5)*cos(q6) - 2.0510343e-10*cos(q6) + sin(q5)*sin(q6));</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;    JW[15]=(cos(q6)*(sin(q2 + q3 + q4)*cos(q5) - 1.0*sin(q5)*(2.0510343e-10*cos(q2 + q3 + q4) + 2.0510343e-10)) + sin(q6)*(cos(q2 + q3 + q4) + 2.0510343e-10*sin(q2 + q3 + q4)*sin(q5) + cos(q5)*(4.2067416e-20*cos(q2 + q3 + q4) + 4.2067416e-20) - 4.2067416e-20))*(2.0510343e-10*sin(q6) - 2.0510343e-10*cos(q5)*sin(q6) + cos(q6)*sin(q5)) - 1.0*(cos(q5) + 4.2067416e-20)*(sin(q2 + q3 + q4)*sin(q5) - 2.0510343e-10*cos(q2 + q3 + q4) + cos(q5)*(2.0510343e-10*cos(q2 + q3 + q4) + 2.0510343e-10) + 8.6281713e-30) + 1.0*(1.0*sin(q6)*(sin(q2 + q3 + q4)*cos(q5) - 1.0*sin(q5)*(2.0510343e-10*cos(q2 + q3 + q4) + 2.0510343e-10)) - cos(q6)*(cos(q2 + q3 + q4) + 2.0510343e-10*sin(q2 + q3 + q4)*sin(q5) + cos(q5)*(4.2067416e-20*cos(q2 + q3 + q4) + 4.2067416e-20) - 4.2067416e-20))*(2.0510343e-10*cos(q5)*cos(q6) - 2.0510343e-10*cos(q6) + sin(q5)*sin(q6));</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    JW[16]=1.0*cos(q6)*(1.0*sin(q6)*(sin(q2 + q3 + q4)*cos(q5) - 1.0*sin(q5)*(2.0510343e-10*cos(q2 + q3 + q4) + 2.0510343e-10)) - cos(q6)*(cos(q2 + q3 + q4) + 2.0510343e-10*sin(q2 + q3 + q4)*sin(q5) + cos(q5)*(4.2067416e-20*cos(q2 + q3 + q4) + 4.2067416e-20) - 4.2067416e-20)) - 4.2067416e-20*cos(q2 + q3 + q4) + 2.0510343e-10*sin(q2 + q3 + q4)*sin(q5) + 2.0510343e-10*cos(q5)*(2.0510343e-10*cos(q2 + q3 + q4) + 2.0510343e-10) - 1.0*sin(q6)*(cos(q6)*(sin(q2 + q3 + q4)*cos(q5) - 1.0*sin(q5)*(2.0510343e-10*cos(q2 + q3 + q4) + 2.0510343e-10)) + sin(q6)*(cos(q2 + q3 + q4) + 2.0510343e-10*sin(q2 + q3 + q4)*sin(q5) + cos(q5)*(4.2067416e-20*cos(q2 + q3 + q4) + 4.2067416e-20) - 4.2067416e-20)) + 1.7696675e-39;</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    JW[17]=2.0510343e-10*cos(q2 + q3 + q4) - 1.0*sin(q2 + q3 + q4)*sin(q5) - 1.0*cos(q5)*(2.0510343e-10*cos(q2 + q3 + q4) + 2.0510343e-10) - 8.6281713e-30;</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>=0;<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>&lt;18;<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>++)</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    {</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;        <span class="keywordflow">if</span> (abs(JV[<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>])&lt;0.0000001)</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;            JV[<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>]=0;</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;            JV[<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>]=floor(JV[i]* 10000.000f + 0.5)/ 10000.000f;</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    }</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>=0;<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>&lt;18;<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>++)</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    {</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;        <span class="keywordflow">if</span> (abs(JW[<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>])&lt;0.0000001)</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;            JW[<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>]=0;</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;            JW[<a class="code" href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a>]=floor(JW[i]* 10000.000f + 0.5)/ 10000.000f;</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    }</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    MatrixXd jacobian(6,6);</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    jacobian&lt;&lt;JV[0],JV[1],JV[2],JV[3],JV[4],JV[5],</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;                 JV[6],JV[7],JV[8],JV[9],JV[10],JV[11],</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;                 JV[12],JV[13],JV[14],JV[15],JV[16],JV[17],</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                 JW[0],JW[1],JW[2],JW[3],JW[4],JW[5],</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;                 JW[6],JW[7],JW[8],JW[9],JW[10],JW[11],</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;                 JW[12],JW[13],JW[14],JW[15],JW[16],JW[17];</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <span class="keywordflow">return</span> jacobian;</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;}</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;</div><div class="ttc" id="_p_d_8m_html_ade64d4b891680caa3d6bb56d9d81e272"><div class="ttname"><a href="_p_d_8m.html#ade64d4b891680caa3d6bb56d9d81e272">kp_coef</a></div><div class="ttdeci">kp_coef</div><div class="ttdef"><b>Definition:</b> <a href="_p_d_8m_source.html#l00005">PD.m:5</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a25191327379f1fea4aa2c562924cb813"><div class="ttname"><a href="class_visual_servo_algorithm.html#a25191327379f1fea4aa2c562924cb813">VisualServoAlgorithm::faceLast</a></div><div class="ttdeci">double faceLast[3]</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00134">VisualServoAlgorithm.h:134</a></div></div>
<div class="ttc" id="_visual_servo_algorithm_8h_html"><div class="ttname"><a href="_visual_servo_algorithm_8h.html">VisualServoAlgorithm.h</a></div></div>
<div class="ttc" id="classrobot_joint_html_ae168937a1a467d8dd4ccdf50e19492d8"><div class="ttname"><a href="classrobot_joint.html#ae168937a1a467d8dd4ccdf50e19492d8">robotJoint::joint3</a></div><div class="ttdeci">double joint3</div><div class="ttdef"><b>Definition:</b> <a href="_common_8h_source.html#l00159">Common.h:159</a></div></div>
<div class="ttc" id="class_tool_coordinate_html_a4c88a09aa4c29b89265faa96dc347644"><div class="ttname"><a href="class_tool_coordinate.html#a4c88a09aa4c29b89265faa96dc347644">ToolCoordinate::Rx</a></div><div class="ttdeci">double Rx</div><div class="ttdef"><b>Definition:</b> <a href="_common_8h_source.html#l00118">Common.h:118</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_aeb01eae8ab5674cd6880020d36fe8c42"><div class="ttname"><a href="class_visual_servo_algorithm.html#aeb01eae8ab5674cd6880020d36fe8c42">VisualServoAlgorithm::end_to_base</a></div><div class="ttdeci">double end_to_base[6]</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00090">VisualServoAlgorithm.h:90</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a1da03a0bc2f3d5920d052b911c011e3d"><div class="ttname"><a href="class_visual_servo_algorithm.html#a1da03a0bc2f3d5920d052b911c011e3d">VisualServoAlgorithm::Thead_to_sensor</a></div><div class="ttdeci">Matrix4d Thead_to_sensor</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00141">VisualServoAlgorithm.h:141</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a786982135c49a73880cd69c6f7cfd19d"><div class="ttname"><a href="class_visual_servo_algorithm.html#a786982135c49a73880cd69c6f7cfd19d">VisualServoAlgorithm::Tsensor_to_trans</a></div><div class="ttdeci">Matrix4d Tsensor_to_trans</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00142">VisualServoAlgorithm.h:142</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_aba8ecbac194304303e51ada1a6558245"><div class="ttname"><a href="class_visual_servo_algorithm.html#aba8ecbac194304303e51ada1a6558245">VisualServoAlgorithm::T_head_to_cam</a></div><div class="ttdeci">Eigen::Isometry3d T_head_to_cam</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00088">VisualServoAlgorithm.h:88</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a02d3400151a9bde296b2c6e555a6c42a"><div class="ttname"><a href="class_visual_servo_algorithm.html#a02d3400151a9bde296b2c6e555a6c42a">VisualServoAlgorithm::out_rotation</a></div><div class="ttdeci">Mat out_rotation</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00121">VisualServoAlgorithm.h:121</a></div></div>
<div class="ttc" id="classrobot_joint_html_a540a629edd868250a4a3a1670d289719"><div class="ttname"><a href="classrobot_joint.html#a540a629edd868250a4a3a1670d289719">robotJoint::joint4</a></div><div class="ttdeci">double joint4</div><div class="ttdef"><b>Definition:</b> <a href="_common_8h_source.html#l00160">Common.h:160</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a6e2a0a2b8b64cee72c33ecb81f1bc09a"><div class="ttname"><a href="class_visual_servo_algorithm.html#a6e2a0a2b8b64cee72c33ecb81f1bc09a">VisualServoAlgorithm::getExpData</a></div><div class="ttdeci">void getExpData()</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8cpp_source.html#l00821">VisualServoAlgorithm.cpp:821</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a680fa5600a5f2b56a67773ee06912972"><div class="ttname"><a href="class_visual_servo_algorithm.html#a680fa5600a5f2b56a67773ee06912972">VisualServoAlgorithm::getDecomposeMatrix</a></div><div class="ttdeci">Matrix3d getDecomposeMatrix()</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8cpp_source.html#l01022">VisualServoAlgorithm.cpp:1022</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a9714d69516a47f681f105aefe5abc063"><div class="ttname"><a href="class_visual_servo_algorithm.html#a9714d69516a47f681f105aefe5abc063">VisualServoAlgorithm::coordinate_3DpointInCam</a></div><div class="ttdeci">std::vector&lt; Eigen::Vector3d &gt; coordinate_3DpointInCam</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00087">VisualServoAlgorithm.h:87</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a9b402f1a244e0ad46ce92141f8b7d06a"><div class="ttname"><a href="class_visual_servo_algorithm.html#a9b402f1a244e0ad46ce92141f8b7d06a">VisualServoAlgorithm::kd_visualAdapt</a></div><div class="ttdeci">MatrixXd kd_visualAdapt</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00170">VisualServoAlgorithm.h:170</a></div></div>
<div class="ttc" id="process__1_8m_html_a8c4e28b0ee15a1005df90b45f3b82ea8"><div class="ttname"><a href="process__1_8m.html#a8c4e28b0ee15a1005df90b45f3b82ea8">i</a></div><div class="ttdeci">Speed_z target for i</div><div class="ttdef"><b>Definition:</b> <a href="process__1_8m_source.html#l00081">process_1.m:81</a></div></div>
<div class="ttc" id="ftusb_8cpp_html_a3a69a05a8138547d5c8e10437c359c0f"><div class="ttname"><a href="ftusb_8cpp.html#a3a69a05a8138547d5c8e10437c359c0f">open_sensor</a></div><div class="ttdeci">bool open_sensor()</div><div class="ttdoc">first scan port to determine if there are forceSensor available, if so, open the first forceSensor; i...</div><div class="ttdef"><b>Definition:</b> <a href="ftusb_8cpp_source.html#l00021">ftusb.cpp:21</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a53442ff2fabf272cbef17dabb778116c"><div class="ttname"><a href="class_visual_servo_algorithm.html#a53442ff2fabf272cbef17dabb778116c">VisualServoAlgorithm::out_translation</a></div><div class="ttdeci">Mat out_translation</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00122">VisualServoAlgorithm.h:122</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_ab08adb4c51432bad3e286c3550eb4587"><div class="ttname"><a href="class_visual_servo_algorithm.html#ab08adb4c51432bad3e286c3550eb4587">VisualServoAlgorithm::weight</a></div><div class="ttdeci">double weight</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00195">VisualServoAlgorithm.h:195</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_ad2dd940b6a4afd60a6ebdd71728c4dab"><div class="ttname"><a href="class_visual_servo_algorithm.html#ad2dd940b6a4afd60a6ebdd71728c4dab">VisualServoAlgorithm::force_error</a></div><div class="ttdeci">VectorXd force_error</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00201">VisualServoAlgorithm.h:201</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_ae126470dc9ce5767c9f25b3cfa6e409e"><div class="ttname"><a href="class_visual_servo_algorithm.html#ae126470dc9ce5767c9f25b3cfa6e409e">VisualServoAlgorithm::ifEnterForceMode</a></div><div class="ttdeci">bool ifEnterForceMode</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00247">VisualServoAlgorithm.h:247</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a97cf44120b818f0fa90252de66a8ca82"><div class="ttname"><a href="class_visual_servo_algorithm.html#a97cf44120b818f0fa90252de66a8ca82">VisualServoAlgorithm::forcevalue1</a></div><div class="ttdeci">double * forcevalue1</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00197">VisualServoAlgorithm.h:197</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_aafa4ad63ed9be3b77f44d1a163bbe990"><div class="ttname"><a href="class_visual_servo_algorithm.html#aafa4ad63ed9be3b77f44d1a163bbe990">VisualServoAlgorithm::translation_vec_PnP</a></div><div class="ttdeci">Mat translation_vec_PnP</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00116">VisualServoAlgorithm.h:116</a></div></div>
<div class="ttc" id="class_tool_coordinate_html_a06a0357d91e3c0463f4dc0746c6677a4"><div class="ttname"><a href="class_tool_coordinate.html#a06a0357d91e3c0463f4dc0746c6677a4">ToolCoordinate::y_speed</a></div><div class="ttdeci">double y_speed</div><div class="ttdef"><b>Definition:</b> <a href="_common_8h_source.html#l00123">Common.h:123</a></div></div>
<div class="ttc" id="classrobot_joint_html_a5be708bac63145b315856404f313f81b"><div class="ttname"><a href="classrobot_joint.html#a5be708bac63145b315856404f313f81b">robotJoint::joint5_speed</a></div><div class="ttdeci">double joint5_speed</div><div class="ttdef"><b>Definition:</b> <a href="_common_8h_source.html#l00168">Common.h:168</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a1d6856e222aeb89a555930774aec008b"><div class="ttname"><a href="class_visual_servo_algorithm.html#a1d6856e222aeb89a555930774aec008b">VisualServoAlgorithm::data_EndEffector</a></div><div class="ttdeci">ofstream data_EndEffector</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00149">VisualServoAlgorithm.h:149</a></div></div>
<div class="ttc" id="ftusb_8cpp_html_aebe98d6927c678b5f9aa8a156a75c109"><div class="ttname"><a href="ftusb_8cpp.html#aebe98d6927c678b5f9aa8a156a75c109">close_sensor</a></div><div class="ttdeci">void close_sensor()</div><div class="ttdef"><b>Definition:</b> <a href="ftusb_8cpp_source.html#l00058">ftusb.cpp:58</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_ab6c289115af50da9dbe3e4ad2f24f8e8"><div class="ttname"><a href="class_visual_servo_algorithm.html#ab6c289115af50da9dbe3e4ad2f24f8e8">VisualServoAlgorithm::force_errorOld</a></div><div class="ttdeci">VectorXd force_errorOld</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00202">VisualServoAlgorithm.h:202</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a2265806b9e8bba7a87aed10dd88e63e4"><div class="ttname"><a href="class_visual_servo_algorithm.html#a2265806b9e8bba7a87aed10dd88e63e4">VisualServoAlgorithm::dataServo_visualSpeed</a></div><div class="ttdeci">ofstream dataServo_visualSpeed</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00239">VisualServoAlgorithm.h:239</a></div></div>
<div class="ttc" id="class_tool_coordinate_html_ae28178cf50e8d7a6cfcfe7504bca7c27"><div class="ttname"><a href="class_tool_coordinate.html#ae28178cf50e8d7a6cfcfe7504bca7c27">ToolCoordinate::Rz</a></div><div class="ttdeci">double Rz</div><div class="ttdef"><b>Definition:</b> <a href="_common_8h_source.html#l00120">Common.h:120</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a04ff1215e42e29746aa58372e3773e57"><div class="ttname"><a href="class_visual_servo_algorithm.html#a04ff1215e42e29746aa58372e3773e57">VisualServoAlgorithm::error_positionLast</a></div><div class="ttdeci">VectorXd error_positionLast</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00164">VisualServoAlgorithm.h:164</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a5c58e315b7fd777f3c2662154bca7c15"><div class="ttname"><a href="class_visual_servo_algorithm.html#a5c58e315b7fd777f3c2662154bca7c15">VisualServoAlgorithm::Tarmbase_to_cam</a></div><div class="ttdeci">Eigen::Isometry3d Tarmbase_to_cam</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00083">VisualServoAlgorithm.h:83</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a924ad3787aabf2d9f09fb92e72981fa0"><div class="ttname"><a href="class_visual_servo_algorithm.html#a924ad3787aabf2d9f09fb92e72981fa0">VisualServoAlgorithm::getWeightMatrix</a></div><div class="ttdeci">void getWeightMatrix()</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8cpp_source.html#l00993">VisualServoAlgorithm.cpp:993</a></div></div>
<div class="ttc" id="class_tool_coordinate_html_a9ff4428b606350b2e6278776f10cb484"><div class="ttname"><a href="class_tool_coordinate.html#a9ff4428b606350b2e6278776f10cb484">ToolCoordinate::z_speed</a></div><div class="ttdeci">double z_speed</div><div class="ttdef"><b>Definition:</b> <a href="_common_8h_source.html#l00124">Common.h:124</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a4838d8a68adc7e1a0c14eec2360f9f4c"><div class="ttname"><a href="class_visual_servo_algorithm.html#a4838d8a68adc7e1a0c14eec2360f9f4c">VisualServoAlgorithm::feature_points</a></div><div class="ttdeci">std::vector&lt; cv::Point2f &gt; feature_points</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00080">VisualServoAlgorithm.h:80</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_ad80e68d8a382415e6ad9eb4378f87d52"><div class="ttname"><a href="class_visual_servo_algorithm.html#ad80e68d8a382415e6ad9eb4378f87d52">VisualServoAlgorithm::Tcam_to_trans</a></div><div class="ttdeci">Matrix4d Tcam_to_trans</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00143">VisualServoAlgorithm.h:143</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a87a834a88a092582b206c4327b47a5fa"><div class="ttname"><a href="class_visual_servo_algorithm.html#a87a834a88a092582b206c4327b47a5fa">VisualServoAlgorithm::ifReachTarget</a></div><div class="ttdeci">bool ifReachTarget</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00160">VisualServoAlgorithm.h:160</a></div></div>
<div class="ttc" id="class_tool_coordinate_html_a5b077a16817aed4e303ba381bbd41d81"><div class="ttname"><a href="class_tool_coordinate.html#a5b077a16817aed4e303ba381bbd41d81">ToolCoordinate::y</a></div><div class="ttdeci">double y</div><div class="ttdef"><b>Definition:</b> <a href="_common_8h_source.html#l00116">Common.h:116</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a7d87d385fdfd09eb07037c94258e55ef"><div class="ttname"><a href="class_visual_servo_algorithm.html#a7d87d385fdfd09eb07037c94258e55ef">VisualServoAlgorithm::pose_mat</a></div><div class="ttdeci">Mat pose_mat</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00119">VisualServoAlgorithm.h:119</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a29a3b060141338eb8c2d95c69f5253ff"><div class="ttname"><a href="class_visual_servo_algorithm.html#a29a3b060141338eb8c2d95c69f5253ff">VisualServoAlgorithm::Thead_to_cam_RQ</a></div><div class="ttdeci">Matrix4d Thead_to_cam_RQ</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00129">VisualServoAlgorithm.h:129</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a9bb0ea8e64bfcc556c8398dae2029bce"><div class="ttname"><a href="class_visual_servo_algorithm.html#a9bb0ea8e64bfcc556c8398dae2029bce">VisualServoAlgorithm::sPnP</a></div><div class="ttdeci">void sPnP()</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8cpp_source.html#l00433">VisualServoAlgorithm.cpp:433</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a342b5b8a7064c166f2939c19bac88433"><div class="ttname"><a href="class_visual_servo_algorithm.html#a342b5b8a7064c166f2939c19bac88433">VisualServoAlgorithm::tempHeadPose</a></div><div class="ttdeci">double tempHeadPose[3]</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00130">VisualServoAlgorithm.h:130</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a85d52fa336f1eaf4c76df45699bb66bf"><div class="ttname"><a href="class_visual_servo_algorithm.html#a85d52fa336f1eaf4c76df45699bb66bf">VisualServoAlgorithm::lastCommand</a></div><div class="ttdeci">double lastCommand[3]</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00245">VisualServoAlgorithm.h:245</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a4c7041ad81664e5e30077cb092507ee7"><div class="ttname"><a href="class_visual_servo_algorithm.html#a4c7041ad81664e5e30077cb092507ee7">VisualServoAlgorithm::ifUseForce</a></div><div class="ttdeci">bool ifUseForce</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00192">VisualServoAlgorithm.h:192</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_af8d4649ec4b6843dc50b07d0839d9e35"><div class="ttname"><a href="class_visual_servo_algorithm.html#af8d4649ec4b6843dc50b07d0839d9e35">VisualServoAlgorithm::kp_visual_1</a></div><div class="ttdeci">double kp_visual_1</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00172">VisualServoAlgorithm.h:172</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a8c91908370ed865721fa61b7ac90fbd7"><div class="ttname"><a href="class_visual_servo_algorithm.html#a8c91908370ed865721fa61b7ac90fbd7">VisualServoAlgorithm::VisualServoAlgorithm</a></div><div class="ttdeci">VisualServoAlgorithm(QObject *parent=nullptr)</div><div class="ttdoc">constructor, first set all control flag to false, and init all control members. </div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8cpp_source.html#l00011">VisualServoAlgorithm.cpp:11</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_ae27970fe21617c6f3a6b44a11c93e697"><div class="ttname"><a href="class_visual_servo_algorithm.html#ae27970fe21617c6f3a6b44a11c93e697">VisualServoAlgorithm::reprojectdst</a></div><div class="ttdeci">vector&lt; cv::Point2d &gt; reprojectdst</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00118">VisualServoAlgorithm.h:118</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_af890adbfb3b33b42941cb835c7fadba8"><div class="ttname"><a href="class_visual_servo_algorithm.html#af890adbfb3b33b42941cb835c7fadba8">VisualServoAlgorithm::ifUseSpeed</a></div><div class="ttdeci">bool ifUseSpeed</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00158">VisualServoAlgorithm.h:158</a></div></div>
<div class="ttc" id="class_robot_proxy_html_af4736f390ab857ccdfebbd3514ba8daf"><div class="ttname"><a href="class_robot_proxy.html#af4736f390ab857ccdfebbd3514ba8daf">RobotProxy::movelpos</a></div><div class="ttdeci">static void movelpos(double x, double y, double z, double Rx, double Ry, double Rz, double a=0.1, double v=0.05)</div><div class="ttdoc">move robot to corrosponding pos </div><div class="ttdef"><b>Definition:</b> <a href="_robot_proxy_8cpp_source.html#l00098">RobotProxy.cpp:98</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_ab7b80eab269c73c1f2e604b695deb963"><div class="ttname"><a href="class_visual_servo_algorithm.html#ab7b80eab269c73c1f2e604b695deb963">VisualServoAlgorithm::ifVisualServo</a></div><div class="ttdeci">bool ifVisualServo</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00159">VisualServoAlgorithm.h:159</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_ac8d192693788b49498c48dd4b5df1e5a"><div class="ttname"><a href="class_visual_servo_algorithm.html#ac8d192693788b49498c48dd4b5df1e5a">VisualServoAlgorithm::ifExperiment</a></div><div class="ttdeci">bool ifExperiment</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00140">VisualServoAlgorithm.h:140</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a30023353986c42d8f665d6df66991eb5"><div class="ttname"><a href="class_visual_servo_algorithm.html#a30023353986c42d8f665d6df66991eb5">VisualServoAlgorithm::ifChangeLastCommand</a></div><div class="ttdeci">bool ifChangeLastCommand</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00246">VisualServoAlgorithm.h:246</a></div></div>
<div class="ttc" id="classrobot_joint_html_a6b21b2b5e0600510525ae1e2c1962fa8"><div class="ttname"><a href="classrobot_joint.html#a6b21b2b5e0600510525ae1e2c1962fa8">robotJoint::joint1_speed</a></div><div class="ttdeci">double joint1_speed</div><div class="ttdef"><b>Definition:</b> <a href="_common_8h_source.html#l00164">Common.h:164</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a187aa41151a05730320fbc3ad23fc19d"><div class="ttname"><a href="class_visual_servo_algorithm.html#a187aa41151a05730320fbc3ad23fc19d">VisualServoAlgorithm::Rcam_to_head_PnP</a></div><div class="ttdeci">Matrix3d Rcam_to_head_PnP</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00125">VisualServoAlgorithm.h:125</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a940d3f27e05c517340b50fc86ba47e09"><div class="ttname"><a href="class_visual_servo_algorithm.html#a940d3f27e05c517340b50fc86ba47e09">VisualServoAlgorithm::trackHead</a></div><div class="ttdeci">bool trackHead</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00096">VisualServoAlgorithm.h:96</a></div></div>
<div class="ttc" id="class_tool_coordinate_html_aacc797803bc4b9f441ca5d6c6b351cba"><div class="ttname"><a href="class_tool_coordinate.html#aacc797803bc4b9f441ca5d6c6b351cba">ToolCoordinate::x_speed</a></div><div class="ttdeci">double x_speed</div><div class="ttdef"><b>Definition:</b> <a href="_common_8h_source.html#l00122">Common.h:122</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_af37e074356d29f28f05ede2fe6c3c23b"><div class="ttname"><a href="class_visual_servo_algorithm.html#af37e074356d29f28f05ede2fe6c3c23b">VisualServoAlgorithm::getInitialPose</a></div><div class="ttdeci">void getInitialPose()</div><div class="ttdoc">get the initial pose of visual servo and robot </div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8cpp_source.html#l00125">VisualServoAlgorithm.cpp:125</a></div></div>
<div class="ttc" id="class_robot_proxy_html_a64c0a6703c48f7fc34ffe86f8cde5eb0"><div class="ttname"><a href="class_robot_proxy.html#a64c0a6703c48f7fc34ffe86f8cde5eb0">RobotProxy::speedlpos</a></div><div class="ttdeci">static void speedlpos(double x, double y, double z, double Rx, double Ry, double Rz, double a=0.1, double v=0.05)</div><div class="ttdoc">seems control robot in speed mode.. </div><div class="ttdef"><b>Definition:</b> <a href="_robot_proxy_8cpp_source.html#l00118">RobotProxy.cpp:118</a></div></div>
<div class="ttc" id="class_tool_coordinate_html_a9bc86c1da135c6394dd143da968f463b"><div class="ttname"><a href="class_tool_coordinate.html#a9bc86c1da135c6394dd143da968f463b">ToolCoordinate::Rz_speed</a></div><div class="ttdeci">double Rz_speed</div><div class="ttdef"><b>Definition:</b> <a href="_common_8h_source.html#l00127">Common.h:127</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a5f958ef24e662bd434538b887e844105"><div class="ttname"><a href="class_visual_servo_algorithm.html#a5f958ef24e662bd434538b887e844105">VisualServoAlgorithm::kp_visualAdapt</a></div><div class="ttdeci">MatrixXd kp_visualAdapt</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00169">VisualServoAlgorithm.h:169</a></div></div>
<div class="ttc" id="_visual_servo_algorithm_8cpp_html_a8e371173b7daec7c4f7f2e6422903af7"><div class="ttname"><a href="_visual_servo_algorithm_8cpp.html#a8e371173b7daec7c4f7f2e6422903af7">K</a></div><div class="ttdeci">double K[9]</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8cpp_source.html#l00004">VisualServoAlgorithm.cpp:4</a></div></div>
<div class="ttc" id="_p_d_8m_html_a6e8ece5f28c087abd2dc870fd74db230"><div class="ttname"><a href="_p_d_8m.html#a6e8ece5f28c087abd2dc870fd74db230">kd_coef</a></div><div class="ttdeci">kd_coef</div><div class="ttdef"><b>Definition:</b> <a href="_p_d_8m_source.html#l00006">PD.m:6</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a754b275c099792838405c663b9a2a848"><div class="ttname"><a href="class_visual_servo_algorithm.html#a754b275c099792838405c663b9a2a848">VisualServoAlgorithm::error_position</a></div><div class="ttdeci">VectorXd error_position</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00162">VisualServoAlgorithm.h:162</a></div></div>
<div class="ttc" id="classrobot_joint_html_a955842dfcb1857c418e7f821195b333a"><div class="ttname"><a href="classrobot_joint.html#a955842dfcb1857c418e7f821195b333a">robotJoint::joint3_speed</a></div><div class="ttdeci">double joint3_speed</div><div class="ttdef"><b>Definition:</b> <a href="_common_8h_source.html#l00166">Common.h:166</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_ad4657bd3ae72e16514b592cffd54f311"><div class="ttname"><a href="class_visual_servo_algorithm.html#ad4657bd3ae72e16514b592cffd54f311">VisualServoAlgorithm::matrixKqInverse</a></div><div class="ttdeci">MatrixXd matrixKqInverse</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00206">VisualServoAlgorithm.h:206</a></div></div>
<div class="ttc" id="_visual_servo_algorithm_8cpp_html_a5034861c92021af41db3a46bc814a34b"><div class="ttname"><a href="_visual_servo_algorithm_8cpp.html#a5034861c92021af41db3a46bc814a34b">D</a></div><div class="ttdeci">double D[5]</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8cpp_source.html#l00005">VisualServoAlgorithm.cpp:5</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a14d76fabefd3cbade421870c34e46f6a"><div class="ttname"><a href="class_visual_servo_algorithm.html#a14d76fabefd3cbade421870c34e46f6a">VisualServoAlgorithm::signalTrackHeadMode</a></div><div class="ttdeci">void signalTrackHeadMode()</div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a7fe41859151a95e178b5de0e4ac8b68a"><div class="ttname"><a href="class_visual_servo_algorithm.html#a7fe41859151a95e178b5de0e4ac8b68a">VisualServoAlgorithm::euler_angle</a></div><div class="ttdeci">Mat euler_angle</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00123">VisualServoAlgorithm.h:123</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a60dbcc2f9388e147aa08b7484071c34e"><div class="ttname"><a href="class_visual_servo_algorithm.html#a60dbcc2f9388e147aa08b7484071c34e">VisualServoAlgorithm::signalMagneticTransMatrix</a></div><div class="ttdeci">void signalMagneticTransMatrix()</div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a889258e1d9da8ab15a999f38aaf2d1ad"><div class="ttname"><a href="class_visual_servo_algorithm.html#a889258e1d9da8ab15a999f38aaf2d1ad">VisualServoAlgorithm::signalForceAdjustMode</a></div><div class="ttdeci">void signalForceAdjustMode()</div></div>
<div class="ttc" id="classrobot_joint_html_a7b6cc11fe6e66f24e740caf4e2931a24"><div class="ttname"><a href="classrobot_joint.html#a7b6cc11fe6e66f24e740caf4e2931a24">robotJoint::joint2</a></div><div class="ttdeci">double joint2</div><div class="ttdef"><b>Definition:</b> <a href="_common_8h_source.html#l00158">Common.h:158</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_afb6be5a138c15350b70aff537c6c8456"><div class="ttname"><a href="class_visual_servo_algorithm.html#afb6be5a138c15350b70aff537c6c8456">VisualServoAlgorithm::forceControlOne</a></div><div class="ttdeci">void forceControlOne()</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8cpp_source.html#l00909">VisualServoAlgorithm.cpp:909</a></div></div>
<div class="ttc" id="classrobot_joint_html_a3864ea38b5643c1081fd72cf6de78eff"><div class="ttname"><a href="classrobot_joint.html#a3864ea38b5643c1081fd72cf6de78eff">robotJoint::joint5</a></div><div class="ttdeci">double joint5</div><div class="ttdef"><b>Definition:</b> <a href="_common_8h_source.html#l00161">Common.h:161</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a44024ae8c9e6963c21c1b575c46a814b"><div class="ttname"><a href="class_visual_servo_algorithm.html#a44024ae8c9e6963c21c1b575c46a814b">VisualServoAlgorithm::targetCommand</a></div><div class="ttdeci">double targetCommand[6]</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00092">VisualServoAlgorithm.h:92</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_af83e0336208702c2a753d609661b4660"><div class="ttname"><a href="class_visual_servo_algorithm.html#af83e0336208702c2a753d609661b4660">VisualServoAlgorithm::data_realTimeTarget</a></div><div class="ttdeci">ofstream data_realTimeTarget</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00151">VisualServoAlgorithm.h:151</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a2dd50b1de16d067abd986c5fcf07477a"><div class="ttname"><a href="class_visual_servo_algorithm.html#a2dd50b1de16d067abd986c5fcf07477a">VisualServoAlgorithm::data_EndEffectorClick</a></div><div class="ttdeci">ofstream data_EndEffectorClick</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00154">VisualServoAlgorithm.h:154</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a9f49448bb766719cb7fd91a70dcde88f"><div class="ttname"><a href="class_visual_servo_algorithm.html#a9f49448bb766719cb7fd91a70dcde88f">VisualServoAlgorithm::reprojectsrc</a></div><div class="ttdeci">vector&lt; cv::Point3d &gt; reprojectsrc</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00117">VisualServoAlgorithm.h:117</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_ac304753f8fa8435b1ab684ee324c8861"><div class="ttname"><a href="class_visual_servo_algorithm.html#ac304753f8fa8435b1ab684ee324c8861">VisualServoAlgorithm::detect_cycle</a></div><div class="ttdeci">void detect_cycle()</div><div class="ttdoc">detect face. </div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8cpp_source.html#l00460">VisualServoAlgorithm.cpp:460</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a87284b077f40d9fe18e96d1e4773b78a"><div class="ttname"><a href="class_visual_servo_algorithm.html#a87284b077f40d9fe18e96d1e4773b78a">VisualServoAlgorithm::kp_force</a></div><div class="ttdeci">MatrixXd kp_force</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00207">VisualServoAlgorithm.h:207</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a64f707a8fa1a248ce5e835024ae4b44a"><div class="ttname"><a href="class_visual_servo_algorithm.html#a64f707a8fa1a248ce5e835024ae4b44a">VisualServoAlgorithm::trackAngle</a></div><div class="ttdeci">bool trackAngle</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00107">VisualServoAlgorithm.h:107</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a41f75d82693701c90081649f3dc38f6e"><div class="ttname"><a href="class_visual_servo_algorithm.html#a41f75d82693701c90081649f3dc38f6e">VisualServoAlgorithm::force_measureVec</a></div><div class="ttdeci">VectorXd force_measureVec</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00200">VisualServoAlgorithm.h:200</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a4056c904a094a5473551dc89e8066880"><div class="ttname"><a href="class_visual_servo_algorithm.html#a4056c904a094a5473551dc89e8066880">VisualServoAlgorithm::out_intrinsics</a></div><div class="ttdeci">Mat out_intrinsics</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00120">VisualServoAlgorithm.h:120</a></div></div>
<div class="ttc" id="classrobot_joint_html_ab29be7c25af451e47c3ca3a712f601e2"><div class="ttname"><a href="classrobot_joint.html#ab29be7c25af451e47c3ca3a712f601e2">robotJoint::joint6</a></div><div class="ttdeci">double joint6</div><div class="ttdef"><b>Definition:</b> <a href="_common_8h_source.html#l00162">Common.h:162</a></div></div>
<div class="ttc" id="classrobot_joint_html_a87d8af20858b67656309ed09d8bd72ea"><div class="ttname"><a href="classrobot_joint.html#a87d8af20858b67656309ed09d8bd72ea">robotJoint::joint4_speed</a></div><div class="ttdeci">double joint4_speed</div><div class="ttdef"><b>Definition:</b> <a href="_common_8h_source.html#l00167">Common.h:167</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_aee7160ceecb6a13e3d624eb7a89a1946"><div class="ttname"><a href="class_visual_servo_algorithm.html#aee7160ceecb6a13e3d624eb7a89a1946">VisualServoAlgorithm::feature_3Dpoints</a></div><div class="ttdeci">std::vector&lt; cv::Point3f &gt; feature_3Dpoints</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00081">VisualServoAlgorithm.h:81</a></div></div>
<div class="ttc" id="class_tool_coordinate_html_ad353fcabaa6cd32ee5a3b6a49b0caa54"><div class="ttname"><a href="class_tool_coordinate.html#ad353fcabaa6cd32ee5a3b6a49b0caa54">ToolCoordinate::x</a></div><div class="ttdeci">double x</div><div class="ttdef"><b>Definition:</b> <a href="_common_8h_source.html#l00115">Common.h:115</a></div></div>
<div class="ttc" id="ftusb_8cpp_html_a7b8ff57e555872b432b085a4a9e6d201"><div class="ttname"><a href="ftusb_8cpp.html#a7b8ff57e555872b432b085a4a9e6d201">force_measure</a></div><div class="ttdeci">double * force_measure()</div><div class="ttdoc">read data from forceSensor </div><div class="ttdef"><b>Definition:</b> <a href="ftusb_8cpp_source.html#l00043">ftusb.cpp:43</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a2a3fe76520035cd0f5488224733142c8"><div class="ttname"><a href="class_visual_servo_algorithm.html#a2a3fe76520035cd0f5488224733142c8">VisualServoAlgorithm::targetSetByHand</a></div><div class="ttdeci">bool targetSetByHand</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00095">VisualServoAlgorithm.h:95</a></div></div>
<div class="ttc" id="classrobot_joint_html_a121309aaef0817db7d5b82d6e334eb7a"><div class="ttname"><a href="classrobot_joint.html#a121309aaef0817db7d5b82d6e334eb7a">robotJoint::joint2_speed</a></div><div class="ttdeci">double joint2_speed</div><div class="ttdef"><b>Definition:</b> <a href="_common_8h_source.html#l00165">Common.h:165</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_af42339c1422fc5cc281f3bc7945da65c"><div class="ttname"><a href="class_visual_servo_algorithm.html#af42339c1422fc5cc281f3bc7945da65c">VisualServoAlgorithm::head_X_inCam</a></div><div class="ttdeci">Eigen::Vector3d head_X_inCam</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00086">VisualServoAlgorithm.h:86</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a7b7bd4e592be89322e45422018a1fa70"><div class="ttname"><a href="class_visual_servo_algorithm.html#a7b7bd4e592be89322e45422018a1fa70">VisualServoAlgorithm::ifDecomposeForce</a></div><div class="ttdeci">bool ifDecomposeForce</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00193">VisualServoAlgorithm.h:193</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a3df8ca5454e4ba269f19bff13ab56672"><div class="ttname"><a href="class_visual_servo_algorithm.html#a3df8ca5454e4ba269f19bff13ab56672">VisualServoAlgorithm::objectPoints_PnP</a></div><div class="ttdeci">vector&lt; cv::Point3f &gt; objectPoints_PnP</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00112">VisualServoAlgorithm.h:112</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a015a8e65e2cd015fdba54eacd906b7f0"><div class="ttname"><a href="class_visual_servo_algorithm.html#a015a8e65e2cd015fdba54eacd906b7f0">VisualServoAlgorithm::slotOpenForceSensor</a></div><div class="ttdeci">void slotOpenForceSensor()</div><div class="ttdoc">slot of RobotManagement::signalOpenForceSensor, which was emited when open forceSensor button clicked...</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8cpp_source.html#l00837">VisualServoAlgorithm.cpp:837</a></div></div>
<div class="ttc" id="classrobot_joint_html_a0fabef95fa1891899b67db907f8c9969"><div class="ttname"><a href="classrobot_joint.html#a0fabef95fa1891899b67db907f8c9969">robotJoint::joint1</a></div><div class="ttdeci">double joint1</div><div class="ttdef"><b>Definition:</b> <a href="_common_8h_source.html#l00157">Common.h:157</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a3d50c65a387362104891c0b6ad54617a"><div class="ttname"><a href="class_visual_servo_algorithm.html#a3d50c65a387362104891c0b6ad54617a">VisualServoAlgorithm::dataServo_end</a></div><div class="ttdeci">ofstream dataServo_end</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00232">VisualServoAlgorithm.h:232</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a90b8412ec228ef0dbb92a2fa87864919"><div class="ttname"><a href="class_visual_servo_algorithm.html#a90b8412ec228ef0dbb92a2fa87864919">VisualServoAlgorithm::error_positionDerivative</a></div><div class="ttdeci">VectorXd error_positionDerivative</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00163">VisualServoAlgorithm.h:163</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a345ceba7a652a102a6257971be90fc00"><div class="ttname"><a href="class_visual_servo_algorithm.html#a345ceba7a652a102a6257971be90fc00">VisualServoAlgorithm::getHeadCordinate</a></div><div class="ttdeci">void getHeadCordinate()</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8cpp_source.html#l00376">VisualServoAlgorithm.cpp:376</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a31eed52f484b157debe64dec1bd6298d"><div class="ttname"><a href="class_visual_servo_algorithm.html#a31eed52f484b157debe64dec1bd6298d">VisualServoAlgorithm::end_to_headVec2</a></div><div class="ttdeci">Eigen::Vector4d end_to_headVec2</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00099">VisualServoAlgorithm.h:99</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a1250dd2cd8c97710f3fd8af8396ab070"><div class="ttname"><a href="class_visual_servo_algorithm.html#a1250dd2cd8c97710f3fd8af8396ab070">VisualServoAlgorithm::trackAngleInitial</a></div><div class="ttdeci">void trackAngleInitial()</div><div class="ttdoc">init some position menbers. </div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8cpp_source.html#l00081">VisualServoAlgorithm.cpp:81</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_af0d56f94908f1a87dfc39370e55d7482"><div class="ttname"><a href="class_visual_servo_algorithm.html#af0d56f94908f1a87dfc39370e55d7482">VisualServoAlgorithm::dataServo_jointSpeed</a></div><div class="ttdeci">ofstream dataServo_jointSpeed</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00236">VisualServoAlgorithm.h:236</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_aaba3808e67b47180208c47ee681bb513"><div class="ttname"><a href="class_visual_servo_algorithm.html#aaba3808e67b47180208c47ee681bb513">VisualServoAlgorithm::head_Z_inCam</a></div><div class="ttdeci">Eigen::Vector3d head_Z_inCam</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00086">VisualServoAlgorithm.h:86</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a5e7c9ac495c000a03eb02b55fa03259d"><div class="ttname"><a href="class_visual_servo_algorithm.html#a5e7c9ac495c000a03eb02b55fa03259d">VisualServoAlgorithm::dataServo_forceSpeed</a></div><div class="ttdeci">ofstream dataServo_forceSpeed</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00240">VisualServoAlgorithm.h:240</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_ad30eb4d4269fe50a287cda7df0763b49"><div class="ttname"><a href="class_visual_servo_algorithm.html#ad30eb4d4269fe50a287cda7df0763b49">VisualServoAlgorithm::ifOnlyTrackAngle</a></div><div class="ttdeci">bool ifOnlyTrackAngle</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00108">VisualServoAlgorithm.h:108</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_ab9715d36c9601773d84da2284414cb1b"><div class="ttname"><a href="class_visual_servo_algorithm.html#ab9715d36c9601773d84da2284414cb1b">VisualServoAlgorithm::velocity_final</a></div><div class="ttdeci">VectorXd velocity_final</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00211">VisualServoAlgorithm.h:211</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a8323640cd530b33140efbcd0acd76def"><div class="ttname"><a href="class_visual_servo_algorithm.html#a8323640cd530b33140efbcd0acd76def">VisualServoAlgorithm::dist_coeffs</a></div><div class="ttdeci">Mat dist_coeffs</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00104">VisualServoAlgorithm.h:104</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_aaa16534a23caee98d7e0fa504d4f8150"><div class="ttname"><a href="class_visual_servo_algorithm.html#aaa16534a23caee98d7e0fa504d4f8150">VisualServoAlgorithm::dataServo_forceError</a></div><div class="ttdeci">ofstream dataServo_forceError</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00243">VisualServoAlgorithm.h:243</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_acfb710db4a4d59cf2f8aa369c126a825"><div class="ttname"><a href="class_visual_servo_algorithm.html#acfb710db4a4d59cf2f8aa369c126a825">VisualServoAlgorithm::Thead_to_cam_PnP</a></div><div class="ttdeci">Isometry3d Thead_to_cam_PnP</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00124">VisualServoAlgorithm.h:124</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_adb164a1ebbc53f45a9e6d263755891cd"><div class="ttname"><a href="class_visual_servo_algorithm.html#adb164a1ebbc53f45a9e6d263755891cd">VisualServoAlgorithm::forceControlOne_initial</a></div><div class="ttdeci">void forceControlOne_initial()</div><div class="ttdoc">init function, set force_errorOld=0, kp_force=diag(0.06), kd_force=diag(0.04), martixKqInverse=diag(0...</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8cpp_source.html#l00964">VisualServoAlgorithm.cpp:964</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_abee3eb6c8256f98fe78b377dc9fb66a9"><div class="ttname"><a href="class_visual_servo_algorithm.html#abee3eb6c8256f98fe78b377dc9fb66a9">VisualServoAlgorithm::have_detect_face</a></div><div class="ttdeci">bool have_detect_face</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00094">VisualServoAlgorithm.h:94</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_aaaab33ad7fa584237747adef5618b0cf"><div class="ttname"><a href="class_visual_servo_algorithm.html#aaaab33ad7fa584237747adef5618b0cf">VisualServoAlgorithm::Tcam_to_armbase</a></div><div class="ttdeci">Eigen::Matrix4d Tcam_to_armbase</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00082">VisualServoAlgorithm.h:82</a></div></div>
<div class="ttc" id="classrobot_joint_html_ad573113298735a17810790a1a0b9f578"><div class="ttname"><a href="classrobot_joint.html#ad573113298735a17810790a1a0b9f578">robotJoint::joint6_speed</a></div><div class="ttdeci">double joint6_speed</div><div class="ttdef"><b>Definition:</b> <a href="_common_8h_source.html#l00169">Common.h:169</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a49e21809f2067d76925d2d5a249ac648"><div class="ttname"><a href="class_visual_servo_algorithm.html#a49e21809f2067d76925d2d5a249ac648">VisualServoAlgorithm::Tend_to_head</a></div><div class="ttdeci">Matrix4d Tend_to_head</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00126">VisualServoAlgorithm.h:126</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a9d90802392f05247103b1e572d1e67e7"><div class="ttname"><a href="class_visual_servo_algorithm.html#a9d90802392f05247103b1e572d1e67e7">VisualServoAlgorithm::getIllPoint</a></div><div class="ttdeci">void getIllPoint()</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8cpp_source.html#l00259">VisualServoAlgorithm.cpp:259</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a8784388831a5c13feb80adae63a3b432"><div class="ttname"><a href="class_visual_servo_algorithm.html#a8784388831a5c13feb80adae63a3b432">VisualServoAlgorithm::head_ori</a></div><div class="ttdeci">Eigen::Vector3d head_ori</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00086">VisualServoAlgorithm.h:86</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_ac0d47d67d156b781a625812b8e1350a8"><div class="ttname"><a href="class_visual_servo_algorithm.html#ac0d47d67d156b781a625812b8e1350a8">VisualServoAlgorithm::dataServo_finalSpeed</a></div><div class="ttdeci">ofstream dataServo_finalSpeed</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00238">VisualServoAlgorithm.h:238</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a14b3367ffa0a3993dd9f76ddc740ab6a"><div class="ttname"><a href="class_visual_servo_algorithm.html#a14b3367ffa0a3993dd9f76ddc740ab6a">VisualServoAlgorithm::thresholdDistance</a></div><div class="ttdeci">double thresholdDistance</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00212">VisualServoAlgorithm.h:212</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a205d74c95cc860ae55e31250f7dd636d"><div class="ttname"><a href="class_visual_servo_algorithm.html#a205d74c95cc860ae55e31250f7dd636d">VisualServoAlgorithm::slotCloseForceSensor</a></div><div class="ttdeci">void slotCloseForceSensor()</div><div class="ttdoc">slot of close forceSensor,call close_sensor() </div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8cpp_source.html#l00876">VisualServoAlgorithm.cpp:876</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a127c5c3b121d220790aa5e7277c707a4"><div class="ttname"><a href="class_visual_servo_algorithm.html#a127c5c3b121d220790aa5e7277c707a4">VisualServoAlgorithm::kd_visual_2</a></div><div class="ttdeci">double kd_visual_2</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00175">VisualServoAlgorithm.h:175</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a4041a8fc6cb6ca1cf0f5e6ab64753750"><div class="ttname"><a href="class_visual_servo_algorithm.html#a4041a8fc6cb6ca1cf0f5e6ab64753750">VisualServoAlgorithm::mCurrentRobotAngles</a></div><div class="ttdeci">robotJoint mCurrentRobotAngles</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00079">VisualServoAlgorithm.h:79</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_abeb0fd3250e1b41800497eed5e30fbe5"><div class="ttname"><a href="class_visual_servo_algorithm.html#abeb0fd3250e1b41800497eed5e30fbe5">VisualServoAlgorithm::velocity_visual</a></div><div class="ttdeci">VectorXd velocity_visual</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00166">VisualServoAlgorithm.h:166</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_af14a9c41cba03e0a224acac1a69dd109"><div class="ttname"><a href="class_visual_servo_algorithm.html#af14a9c41cba03e0a224acac1a69dd109">VisualServoAlgorithm::selfAdapt</a></div><div class="ttdeci">void selfAdapt()</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8cpp_source.html#l00690">VisualServoAlgorithm.cpp:690</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a985203c23f6ef2daece9bc6de4b46941"><div class="ttname"><a href="class_visual_servo_algorithm.html#a985203c23f6ef2daece9bc6de4b46941">VisualServoAlgorithm::dataServo_target</a></div><div class="ttdeci">ofstream dataServo_target</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00231">VisualServoAlgorithm.h:231</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a94509ddcec8a2fdfed8fd0b5848fb6a2"><div class="ttname"><a href="class_visual_servo_algorithm.html#a94509ddcec8a2fdfed8fd0b5848fb6a2">VisualServoAlgorithm::kp_visual</a></div><div class="ttdeci">MatrixXd kp_visual</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00167">VisualServoAlgorithm.h:167</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_ababfa5ab26f7a34b1a7132a496dfd544"><div class="ttname"><a href="class_visual_servo_algorithm.html#ababfa5ab26f7a34b1a7132a496dfd544">VisualServoAlgorithm::end_to_headVec1</a></div><div class="ttdeci">Eigen::Vector4d end_to_headVec1</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00099">VisualServoAlgorithm.h:99</a></div></div>
<div class="ttc" id="class_tool_coordinate_html_aa17ebe6f933ad8f2c065754bfddb4bd2"><div class="ttname"><a href="class_tool_coordinate.html#aa17ebe6f933ad8f2c065754bfddb4bd2">ToolCoordinate::Rx_speed</a></div><div class="ttdeci">double Rx_speed</div><div class="ttdef"><b>Definition:</b> <a href="_common_8h_source.html#l00125">Common.h:125</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_acecff666c098d905c23e5b185daacde0"><div class="ttname"><a href="class_visual_servo_algorithm.html#acecff666c098d905c23e5b185daacde0">VisualServoAlgorithm::rotation_mat_PnP</a></div><div class="ttdeci">Mat rotation_mat_PnP</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00115">VisualServoAlgorithm.h:115</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a3d4eb2b7d36c364e83976616f8f9307d"><div class="ttname"><a href="class_visual_servo_algorithm.html#a3d4eb2b7d36c364e83976616f8f9307d">VisualServoAlgorithm::mCurrentToolCoordinate</a></div><div class="ttdeci">ToolCoordinate mCurrentToolCoordinate</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00078">VisualServoAlgorithm.h:78</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a531b98477389ae04321e8579dd07528c"><div class="ttname"><a href="class_visual_servo_algorithm.html#a531b98477389ae04321e8579dd07528c">VisualServoAlgorithm::kd_visual_1</a></div><div class="ttdeci">double kd_visual_1</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00174">VisualServoAlgorithm.h:174</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_af0fea33b6a33df48d2d97d1f72fe397d"><div class="ttname"><a href="class_visual_servo_algorithm.html#af0fea33b6a33df48d2d97d1f72fe397d">VisualServoAlgorithm::track_head</a></div><div class="ttdeci">void track_head()</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8cpp_source.html#l00705">VisualServoAlgorithm.cpp:705</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_aacf7aec1bfc84ab45635cca4623bd136"><div class="ttname"><a href="class_visual_servo_algorithm.html#aacf7aec1bfc84ab45635cca4623bd136">VisualServoAlgorithm::theoryData_sensor2trans</a></div><div class="ttdeci">ofstream theoryData_sensor2trans</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00147">VisualServoAlgorithm.h:147</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a755cec308b85962c1c86377900284d52"><div class="ttname"><a href="class_visual_servo_algorithm.html#a755cec308b85962c1c86377900284d52">VisualServoAlgorithm::forceControlType</a></div><div class="ttdeci">int forceControlType</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00196">VisualServoAlgorithm.h:196</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_ae41f86bc1f247c83ce34834d99839928"><div class="ttname"><a href="class_visual_servo_algorithm.html#ae41f86bc1f247c83ce34834d99839928">VisualServoAlgorithm::getJacobianMatrix</a></div><div class="ttdeci">MatrixXd getJacobianMatrix(double *q)</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8cpp_source.html#l01036">VisualServoAlgorithm.cpp:1036</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a372265169be6c94899228258042e15cc"><div class="ttname"><a href="class_visual_servo_algorithm.html#a372265169be6c94899228258042e15cc">VisualServoAlgorithm::force_initialForceV</a></div><div class="ttdeci">VectorXd force_initialForceV</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00199">VisualServoAlgorithm.h:199</a></div></div>
<div class="ttc" id="_visual_servo_algorithm_8cpp_html_a4c45cdff103e6644a620ba5061509f22"><div class="ttname"><a href="_visual_servo_algorithm_8cpp.html#a4c45cdff103e6644a620ba5061509f22">frequency</a></div><div class="ttdeci">double frequency</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8cpp_source.html#l00006">VisualServoAlgorithm.cpp:6</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_aac1535f9e5028c92e8369c1a732a2f16"><div class="ttname"><a href="class_visual_servo_algorithm.html#aac1535f9e5028c92e8369c1a732a2f16">VisualServoAlgorithm::target_last</a></div><div class="ttdeci">double target_last[6]</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00091">VisualServoAlgorithm.h:91</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a82571c86f896f6e73d65b5652be373cd"><div class="ttname"><a href="class_visual_servo_algorithm.html#a82571c86f896f6e73d65b5652be373cd">VisualServoAlgorithm::kd_force</a></div><div class="ttdeci">MatrixXd kd_force</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00208">VisualServoAlgorithm.h:208</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a6f623e949a3cb5d6cff4a94fd4ebf0a2"><div class="ttname"><a href="class_visual_servo_algorithm.html#a6f623e949a3cb5d6cff4a94fd4ebf0a2">VisualServoAlgorithm::rotation_vec_PnP</a></div><div class="ttdeci">Mat rotation_vec_PnP</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00114">VisualServoAlgorithm.h:114</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_abf35a3b77e8748c6e8051bf02daffab6"><div class="ttname"><a href="class_visual_servo_algorithm.html#abf35a3b77e8748c6e8051bf02daffab6">VisualServoAlgorithm::compensateValue</a></div><div class="ttdeci">double compensateValue</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00190">VisualServoAlgorithm.h:190</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a621aded9c78914579772e4b1a8536965"><div class="ttname"><a href="class_visual_servo_algorithm.html#a621aded9c78914579772e4b1a8536965">VisualServoAlgorithm::Ttrans_to_cam</a></div><div class="ttdeci">Matrix4d Ttrans_to_cam</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00144">VisualServoAlgorithm.h:144</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a24297f33904fb2bd505b908ab9164720"><div class="ttname"><a href="class_visual_servo_algorithm.html#a24297f33904fb2bd505b908ab9164720">VisualServoAlgorithm::dataServo_positionError</a></div><div class="ttdeci">ofstream dataServo_positionError</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00242">VisualServoAlgorithm.h:242</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_aa6c3194cde43ea089008acbfea3abede"><div class="ttname"><a href="class_visual_servo_algorithm.html#aa6c3194cde43ea089008acbfea3abede">VisualServoAlgorithm::velocity_force</a></div><div class="ttdeci">VectorXd velocity_force</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00203">VisualServoAlgorithm.h:203</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_aa6542e4980dd93b6b0d933c7d2607615"><div class="ttname"><a href="class_visual_servo_algorithm.html#aa6542e4980dd93b6b0d933c7d2607615">VisualServoAlgorithm::getPose_Head_to_cam</a></div><div class="ttdeci">Isometry3d getPose_Head_to_cam()</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8cpp_source.html#l00418">VisualServoAlgorithm.cpp:418</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a9085ecdc7ee9292a37c5235c99c7a03e"><div class="ttname"><a href="class_visual_servo_algorithm.html#a9085ecdc7ee9292a37c5235c99c7a03e">VisualServoAlgorithm::head_Y_inCam</a></div><div class="ttdeci">Eigen::Vector3d head_Y_inCam</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00086">VisualServoAlgorithm.h:86</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a8b757fbd59236596eca9be326873367b"><div class="ttname"><a href="class_visual_servo_algorithm.html#a8b757fbd59236596eca9be326873367b">VisualServoAlgorithm::kd_visual</a></div><div class="ttdeci">MatrixXd kd_visual</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00168">VisualServoAlgorithm.h:168</a></div></div>
<div class="ttc" id="class_tool_coordinate_html_ad4582a7bf33bf2cc9d7d2e67c43f6f50"><div class="ttname"><a href="class_tool_coordinate.html#ad4582a7bf33bf2cc9d7d2e67c43f6f50">ToolCoordinate::Ry</a></div><div class="ttdeci">double Ry</div><div class="ttdef"><b>Definition:</b> <a href="_common_8h_source.html#l00119">Common.h:119</a></div></div>
<div class="ttc" id="class_tool_coordinate_html_ae39948911d9073039718c7a64a1cb447"><div class="ttname"><a href="class_tool_coordinate.html#ae39948911d9073039718c7a64a1cb447">ToolCoordinate::z</a></div><div class="ttdeci">double z</div><div class="ttdef"><b>Definition:</b> <a href="_common_8h_source.html#l00117">Common.h:117</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_af1ab554e59077ab1adc907684faac879"><div class="ttname"><a href="class_visual_servo_algorithm.html#af1ab554e59077ab1adc907684faac879">VisualServoAlgorithm::visualServoPD</a></div><div class="ttdeci">void visualServoPD()</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8cpp_source.html#l00656">VisualServoAlgorithm.cpp:656</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a5ab834a9163334da4d781eec82857cfa"><div class="ttname"><a href="class_visual_servo_algorithm.html#a5ab834a9163334da4d781eec82857cfa">VisualServoAlgorithm::cam_matrix</a></div><div class="ttdeci">Mat cam_matrix</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00103">VisualServoAlgorithm.h:103</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_af4d0e3f25d10123d6c28b22865168a66"><div class="ttname"><a href="class_visual_servo_algorithm.html#af4d0e3f25d10123d6c28b22865168a66">VisualServoAlgorithm::data_featurePoints</a></div><div class="ttdeci">ofstream data_featurePoints</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00150">VisualServoAlgorithm.h:150</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a032e8a1498c52fd8f5ccb65ba16605e6"><div class="ttname"><a href="class_visual_servo_algorithm.html#a032e8a1498c52fd8f5ccb65ba16605e6">VisualServoAlgorithm::dataServo_endSpeed</a></div><div class="ttdeci">ofstream dataServo_endSpeed</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00235">VisualServoAlgorithm.h:235</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a6b8e2cae91beb690e325f909e7ee879e"><div class="ttname"><a href="class_visual_servo_algorithm.html#a6b8e2cae91beb690e325f909e7ee879e">VisualServoAlgorithm::kp_visual_2</a></div><div class="ttdeci">double kp_visual_2</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00173">VisualServoAlgorithm.h:173</a></div></div>
<div class="ttc" id="class_tool_coordinate_html_a2a1969610c9ab46b922d5580be04d40c"><div class="ttname"><a href="class_tool_coordinate.html#a2a1969610c9ab46b922d5580be04d40c">ToolCoordinate::Ry_speed</a></div><div class="ttdeci">double Ry_speed</div><div class="ttdef"><b>Definition:</b> <a href="_common_8h_source.html#l00126">Common.h:126</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_ad9241ccfddf9fa4c80f1709f6520e447"><div class="ttname"><a href="class_visual_servo_algorithm.html#ad9241ccfddf9fa4c80f1709f6520e447">VisualServoAlgorithm::complianceControl</a></div><div class="ttdeci">VectorXd complianceControl(double *angle, VectorXd force6D)</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8cpp_source.html#l00945">VisualServoAlgorithm.cpp:945</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a6785e841b9cd0cb7adabe158936cc29c"><div class="ttname"><a href="class_visual_servo_algorithm.html#a6785e841b9cd0cb7adabe158936cc29c">VisualServoAlgorithm::data_sensor2transPointClick</a></div><div class="ttdeci">ofstream data_sensor2transPointClick</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00153">VisualServoAlgorithm.h:153</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a6152f3b7da3a366071bacfbe4f8dc639"><div class="ttname"><a href="class_visual_servo_algorithm.html#a6152f3b7da3a366071bacfbe4f8dc639">VisualServoAlgorithm::transformMats</a></div><div class="ttdeci">ofstream transformMats</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00148">VisualServoAlgorithm.h:148</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a659be41d2db5ad190538446546a720bc"><div class="ttname"><a href="class_visual_servo_algorithm.html#a659be41d2db5ad190538446546a720bc">VisualServoAlgorithm::toolTarget</a></div><div class="ttdeci">ToolCoordinate toolTarget</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00093">VisualServoAlgorithm.h:93</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a5de5a6cbf65c0ccbe98527911d9e304a"><div class="ttname"><a href="class_visual_servo_algorithm.html#a5de5a6cbf65c0ccbe98527911d9e304a">VisualServoAlgorithm::forceControlTwo</a></div><div class="ttdeci">void forceControlTwo()</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8cpp_source.html#l00916">VisualServoAlgorithm.cpp:916</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a408155cf6ae9175197a2e37366a4e4b9"><div class="ttname"><a href="class_visual_servo_algorithm.html#a408155cf6ae9175197a2e37366a4e4b9">VisualServoAlgorithm::image_Points_PnP</a></div><div class="ttdeci">vector&lt; cv::Point2f &gt; image_Points_PnP</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00113">VisualServoAlgorithm.h:113</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_aba0e468ba78c40e5f3ff5346cd252f5c"><div class="ttname"><a href="class_visual_servo_algorithm.html#aba0e468ba78c40e5f3ff5346cd252f5c">VisualServoAlgorithm::forceDimension</a></div><div class="ttdeci">int forceDimension</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00214">VisualServoAlgorithm.h:214</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_ac67b124eb3a917d72d25fb3fe1c66878"><div class="ttname"><a href="class_visual_servo_algorithm.html#ac67b124eb3a917d72d25fb3fe1c66878">VisualServoAlgorithm::data_speed</a></div><div class="ttdeci">ofstream data_speed</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8h_source.html#l00152">VisualServoAlgorithm.h:152</a></div></div>
<div class="ttc" id="class_visual_servo_algorithm_html_a581feacfae37663fee336ab09d42c8e1"><div class="ttname"><a href="class_visual_servo_algorithm.html#a581feacfae37663fee336ab09d42c8e1">VisualServoAlgorithm::getForceError</a></div><div class="ttdeci">void getForceError()</div><div class="ttdef"><b>Definition:</b> <a href="_visual_servo_algorithm_8cpp_source.html#l00882">VisualServoAlgorithm.cpp:882</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
